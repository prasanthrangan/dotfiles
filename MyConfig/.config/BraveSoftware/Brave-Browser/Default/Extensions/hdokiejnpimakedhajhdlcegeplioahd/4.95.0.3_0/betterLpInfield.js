"use strict";var reduxStore;function sendRequest(e){if(null!=e)if(e.cmd&&"popupfillinputget"!=e.cmd&&"popupfilliconnumber"!=e.cmd&&L("IF -> BG : cmd="+e.cmd),g_ischrome)try{chrome_runtime_sendMessage(e,function(){})}catch(e){}else g_iscasper?"function"==typeof t_sendmsg&&t_sendmsg(e):bg.LPPlatform.postLegacyMessage({name:"message",message:e})}var g_reference_url="",InfieldMenuTimer=function(){var e;function t(){e=setTimeout(function(){$(".menuTriggered").removeClass("menuTriggered"),$(".dropdown").hide()},300)}function n(){null!=e&&clearTimeout(e)}return{startTimer:t,clearTimer:n}}(),InfieldIcons={pw:"fa-lock",sn:"fa-sticky-note",address:"fa-address-book",ccDefault:"fa-credit-card-alt",ccAmex:"fa-cc-amex",ccMastercard:"fa-cc-mastercard",ccDiscover:"fa-cc-discover",ccVisa:"fa-cc-visa",ccDiners:"fa-cc-diners-club",ccJcb:"fa-cc-jcb",ba:"fa-bank",dl:"fa-car",pp:"fa-globe",ssn:"fa-balance-scale",insurance:"fa-umbrella",member:"fa-barcode",wifi:"fa-wifi",db:"fa-database",server:"fa-server",ssh:"fa-user-secret",software:"fa-laptop",custom:"fa-puzzle-piece"},advancedOptionsViewed=!1,debounceWait=500,InfieldCommands=function(){function i(e){csTop.LPInfieldFrame.close(e)}function e(e){bg.InfieldCommands.editSite(e,!0)}function t(e){if(bg.get("LPContentScriptFeatures").web_client_fill){var t=reduxStore.getState();reduxStore.dispatch(reduxInfield.fillActions.manualFill(t.page,e,"Infield V2",t.sectionId))}else sendRequest({cmd:"infieldfillpw",aid:e,from_iframe:!0,no_manualfill_on_saveall:!0,fromiframe:1,source:"formv2"});i("action")}function n(e){bg.InfieldCommands.copyUrl(e,!0),i("action")}function o(e){bg.InfieldCommands.copyUserName(e,!0),i("action")}function r(e){bg.InfieldCommands.copyPassword(e,!0,"formv2"),i("action")}function a(e,t,n){bg.InfieldCommands.copyProp(e,t,!0,n),i("action")}function s(e,t){bg.InfieldCommands.setGeneratePasswordPrefs({prefstr:e,genpwstr:t})}function c(e){bg.InfieldCommands.editFormFill(e,!0,"formv2"),i("action")}function l(e){if(bg.get("LPContentScriptFeatures").web_client_fill){var t=reduxStore.getState();reduxStore.dispatch(reduxInfield.fillActions.manualFill(t.page,e,"Infield V2",t.sectionId))}else bg.InfieldCommands.fillForm(e,!0,"formv2");i("action")}function d(e,t){bg.LPPlatform.copyToClipboard(e),g("copypass",{action:t,source:"formv2"})}function p(e){bg.InfieldCommands.getGeneratePasswordPrefs(e)}function u(e,t){if(bg.get("LPContentScriptFeatures").web_client_fill){var n=reduxStore.getState();reduxStore.dispatch(reduxInfield.fillActions.fillGeneratedPassword(n.page,e,"Infield V2",n.pageLanguage,n.sectionId))}else bg.InfieldCommands.fillGeneratedPassword(e,t,!0);i("action")}function f(e,t,n){bg.InfieldCommands.searchVaultAll(e,t,n)}function m(e){bg.InfieldCommands.getPopupFillData(e)}function g(e,t){bg.sendLpImprove(e,t)}return{closePopup:i,copyToClipboard:d,editSite:e,fillUsernamePass:t,copyUrl:n,copyUserName:o,copyPassword:r,copyProp:a,editFormFill:c,fillForm:l,getGeneratePrefs:p,writeAllPrefs:s,fillGeneratedPassword:u,searchVault:f,getInitialData:m,sendLPImprove:g}}();!function(r){var e=function(e,t,n){var i=this;i._onResizeCallback=n,e&&(e instanceof jQuery?i._triggerElement=e:i._triggerElement=r("#"+e),t?(i._triggerElement.click(function(e){i.show(),i._setPosition(e)}),i._triggerElement.keypress(function(e){i.show(),r(i._menuElement[0]).children().children()[0].focus(),i._setPosition(e)})):(i._triggerElement.children().click(function(e){i.show()}),i._triggerElement.children().keypress(function(e){i.show(),r(i._menuElement[0]).children().children()[0].focus()})))};e.prototype._setPosition=function(e){var t=r(e.currentTarget).offset();t.top+=20,t.left+=20,this._menuElement.offset(t)},e.prototype.show=function(){r(".dropdown").hide(),r(".menuTriggered").removeClass("menuTriggered");var e=this,t;e._triggerElement.closest(".tile").addClass("menuTriggered"),e._triggerElement.addClass("menuTriggered"),this._menuElement&&this._menuElement.show(0,function(){e._onResizeCallback&&e._onResizeCallback(e._menuElement.height(),90)})},e.prototype.hide=function(e){var t=this,n;t._triggerElement.closest(".tile").removeClass("menuTriggered"),t._triggerElement.removeClass("menuTriggered"),t._triggerElement.blur(),this._menuElement&&(this._menuElement.hide(e),t._onResizeCallback(),t._triggerElement.trigger("reset"))},e.prototype.createMenu=function(e,t,n){var i=this;return i._menuElement=r("<div></div>").attr("id",e+"Menu").addClass("dropdown").addClass(t).hide().hover(function(){var e=i._triggerElement.closest(".tile");InfieldMenuTimer.clearTimer()},function(){InfieldMenuTimer.startTimer()}).append(i._createMenuItems(n)),i._menuElement},e.prototype._createMenuItems=function(e){var t=this;t._menuItems=e;for(var n=r("<ul></ul>").addClass("menuList"),i=0;i<t._menuItems.length;i++){var o=r("<li></li>").attr("data-viewId",t._menuItems[i].id).attr("tabindex","1").click(function(e){t._triggerElement.trigger("reset",["action"]),t.hide(),t.select(e.currentTarget.getAttribute("data-viewId"),!0)}).keypress(function(e){t._triggerElement.trigger("reset",["action"]),t.hide(),t.select(e.currentTarget.getAttribute("data-viewId"),!0)}).append(r("<p></p>").text(t._menuItems[i].text));n.append(o)}return n},e.prototype._findMenu=function(t){var e=r.grep(this._menuItems,function(e){return e.id===t});return e&&0<e.length?e[0]:null},e.prototype.select=function(e,t){var n=this._findMenu(e);n&&this._triggerElement&&this._triggerElement.find("p").text(n.selectedText),!0===t&&n&&n.action&&n.action()},window.InfieldMenu=e}(jQuery);var InfieldView=function(t){var n=[];function e(e){Array.isArray(e)&&0<e.length&&(n=e,o())}function i(e){-1!=n.indexOf(e)&&("generatePassView"!==e&&"paywallView"!==e?(o(),t(".views").show()):(o(),t("#"+e).show()))}function o(){t(".views").hide(),t("#generatePassView").hide(),t("#paywallView").hide()}return{init:e,show:i}}(jQuery),InfieldGeneratePassword=function(a){function e(t,e){a("#moreOptions").click(function(){l(),e&&e()}),a(".iconMoreInfo").hover(function(){a(this).children().fadeIn(200)},function(){a(this).children().fadeOut(100)}),a("#showHistory").click(function(){u(),e&&e()}),a("#lengthInput").on("input",function(){InfieldSearch.debounce(r(a("#lengthInput").val()),debounceWait)}),a("#length").on("input",function(){InfieldSearch.debounce(r(a("#length").val()),debounceWait)}),g_isedge&&a("#length").on("mouseup",function(){i()}),a(".pwgen").change(i),a("#generateBtn").click(i),a("#pronounceable").click(function(){a("#pronounceable").prop("checked")?(a("#digits").prop("checked",!1),a("#digits").prop("disabled",!0),a("#special").prop("checked",!1),a("#special").prop("disabled",!0),a("#ambig").prop("checked",!1),a("#all").prop("checked",!1),a("#upper").prop("checked",!0),a("#lower").prop("checked",!0)):(a("#digits").prop("checked",!0),a("#digits").prop("disabled",!1),a("#special").prop("checked",!0),a("#special").prop("disabled",!1))}),a("#ambig").click(function(){a("#ambig").prop("checked")&&(a("#pronounceable").prop("checked",!1),a("#all").prop("checked",!1),a("#digits").prop("disabled",!1),a("#special").prop("disabled",!1))}),a("#all").click(function(){a("#all").prop("checked")&&(a("#pronounceable").prop("checked",!1),a("#ambig").prop("checked",!1),a("#digits").prop("checked",!0),a("#special").prop("checked",!0),a("#upper").prop("checked",!0),a("#lower").prop("checked",!0),a("#digits").prop("disabled",!1),a("#special").prop("disabled",!1))}),a("#password").on("copy",function(){bg.LPTabState.setCopiedGeneratedPassword(this.value)}).LP_addGeneratePasswordMeter(!0),a("#btnCopy").click(function(){var e=a("#password").val();t.copyToClipboard(e,"generatepassword"),f(),bg.LPTabState.setCopiedGeneratedPassword(e),a(this).children().fadeIn(1,function(){a(this).fadeOut(1200)})}),a("#clearHistory").bind("click",function(){m()});var n=function(){var e=a("#password").val();t.fillGeneratedPassword(e,{pronounceable:a("#pronounceable").prop("checked"),length:a("#password").val().length,expand:advancedOptionsViewed,uppercase:a("#upper").prop("checked"),lowercase:a("#lower").prop("checked"),numeric:a("#digits").prop("checked"),special:a("#special").prop("checked"),avoidAmbiguous:a("#ambig").prop("checked"),passwordType:c(),source:"formv2",variation:"new",generatedPasswordCount:a("#generatedPasswordCount").val()}),t.writeAllPrefs(JSON.stringify({generate_allcombos:a("#all").prop("checked")?1:0,generate_pronounceable:a("#pronounceable").prop("checked")?1:0,generate_length:a("#length").val(),generate_upper:a("#upper").prop("checked")?1:0,generate_lower:a("#lower").prop("checked")?1:0,generate_digits:a("#digits").prop("checked")?1:0,generate_special:a("#special").prop("checked")?1:0,generate_ambig:a("#ambig").prop("checked")?1:0,generate_mindigits:2,generate_reqevery:0})),bg.GenPassHistory.add(e)};a("#fillPasswordBtn").click(n),a("#generateAndFillBtn").click(n),a("#generateAndFillBtn").keypress(n),h(),a("#password").on("change paste keyup",function(e){h()}),a("#advancedView").hide(),a("#generateBtnContainer").hide(),a("#history").hide(),a("#clearHistory").hide()}function i(){g(),a("#generatedPasswordCount").val(function(){return parseInt(a("#generatedPasswordCount").val())+1});var e=lpCreatePass(a("#length").val(),a("#upper").prop("checked"),a("#lower").prop("checked"),a("#digits").prop("checked"),a("#special").prop("checked"),2,a("#ambig").prop("checked"),a("#all").prop("checked"),a("#pronounceable").prop("checked"));a("#password").val(e).change()}function n(){var o=bg.get("g_prefoverrides").sitepwlen;o&&(o=JSON.parse(o),bg.get_selected_tab_data_no_extension(null,function(e){var t=bg.lp_gettld_url(e.url);if(o[t]){var n=o[t],i=Math.max(a("#length").val(),n);a("#length").attr({min:n}),r(i)}}))}function t(e){n();var t=JSON.parse(e.prefstr);a("#length").val(parseInt(t.generate_length)),a("#upper").prop("checked",!!parseInt(t.generate_upper)),a("#lower").prop("checked",!!parseInt(t.generate_lower)),a("#digits").prop("checked",!!parseInt(t.generate_digits)),a("#special").prop("checked",!!parseInt(t.generate_special)),a("#ambig").prop("checked",!!parseInt(t.generate_ambig)),a("#all").prop("checked",!!parseInt(t.generate_allcombos)),a("#advancedView").hide(),a("#generateAndFillView").show(),parseInt(t.generate_pronounceable)?o():a("#pronounceable").prop("pronounceable",!1),a("#ambig").prop("checked")||a("#pronounceable").prop("checked")||s(),parseInt(parseInt(t.generate_length))?r(parseInt(t.generate_length)):r(10),bg.GenPassHistory.getWithReadableDate(f.bind(this)),a("#password").val(lpCreatePass(a("#length").val(),a("#upper").prop("checked"),a("#lower").prop("checked"),a("#digits").prop("checked"),a("#special").prop("checked"),2,a("#ambig").prop("checked"),a("#all").prop("checked"),a("#pronounceable").prop("checked"))).change()}function r(e){99<e&&(e=99),a("#length").val(e);var t=a("#length"),n=t.val(),i=t.attr("min"),o,r=(n-i)/(t.attr("max")-i)*100;a("#sliderFill").width(r+"%"),a("#lengthInput").val(e)}function o(){a("#pronounceable").prop("checked")||a("#pronounceable").prop("checked",!0),a("#digits").prop("checked",!1),a("#digits").prop("disabled",!0),a("#special").prop("checked",!1),a("#special").prop("disabled",!0),a("#upper").prop("checked",!0),a("#lower").prop("checked",!0)}function s(){a("#all").prop("checked")||a("#all").prop("checked",!0),a("#digits").prop("disabled",!1),a("#special").prop("disabled",!1),a("#upper").prop("checked",!0),a("#lower").prop("checked",!0)}function c(){return a("#ambig").prop("checked")?"ambig":a("#pronounceable").prop("checked")?"pronounceable":"all"}function l(){advancedOptionsViewed=!0,a("#advancedView").toggle(),a("#generateBtnContainer").toggle(),a("#moreOptions").html(a("#moreOptions").text()==Strings.translateString("Show Options")?Strings.translateString("Hide Options"):Strings.translateString("Show Options"))}function d(){a("#moreOptions").show(),a("#fillPasswordBtn").show(),a("#generateBtnContainer").hide(),setTimeout(function(){a("#fillPasswordBtn").focus()},100)}function p(){a("#moreOptions").hide(),a("#fillPasswordBtn").hide(),a("#generateBtnContainer").hide()}function u(){"Show History"==a("#showHistory").text()?(a("#showHistory").html("Hide History"),a("#advanced-features").hide(),a("#history").show(),a("#clearHistory").show(),InfieldCommands.sendLPImprove("historyviewed",{source:"formv2"})):(a("#showHistory").html("Show History"),a("#advanced-features").show(),a("#history").hide(),a("#clearHistory").hide())}function f(e){var t=a("#historyTable"),n=a("#historyBody"),i=a("#historyEmptyState");e&&0!==e.length?(n.empty(),e.forEach(function(e){var t=LPTools.createElement("tr");t.appendChild(LPTools.createElement("td","",e.password)),t.appendChild(LPTools.createElement("td","",Strings.translateString(e.date))),n.append(t)}),t.show(),i.hide()):(t.hide(),i.show())}function m(){bg.GenPassHistory.clear(),a("#historyBody").empty(),a("#historyTable").hide(),a("#historyEmptyState").show(),InfieldCommands.sendLPImprove("historycleared",{source:"formv2"})}function g(){var e=a("#password").val();e&&0<e.length&&(bg.GenPassHistory.add(e),bg.GenPassHistory.getWithReadableDate(f.bind(this)))}function h(){0<a("#password").val().length?a("#fillPasswordBtn").removeAttr("disabled"):a("#fillPasswordBtn").attr("disabled","disabled")}return{init:e,setup:t,show:d,hide:p}}(jQuery),InfieldTiles=function(C,k,P,_){var S="hovered",T=_.translateString("Copy..."),x=_.translateString("Edit"),E=_.translateString("Fill"),F="<div></div>",B;function e(e,o,t,r,n,i){B=n;var a=[];if(C("#"+e).empty().append(C('<p class="italic"></p>').text(i)),t){var s=[],c=C.map(t,function(e,t){return e&&e.language&&1<e.language.length&&-1===s.indexOf(e.language.substr(0,2))&&s.push(e.language.substr(0,2)),e});bg.get("LPContentScriptFeatures").web_client_fill||c.sort(function(e,t){if(void 0!==e.name)return e.name.localeCompare(t.name);var n=e.noteType,i=e.decprofilename;return void 0===n&&(n="undefined"),void 0===i&&(i="undefined"),L("BAD_NAME FOUND - ABORT TILE SORT - userId:"+(e.aid||e.ffid)+" noteType:"+n+" decprofname:"+i),0}),C.each(c,function(e,t){var n=!1;e+1===c.length&&(n=!0);var i=d(o,{id:t.aid||t.ffid,name:"sites"===o?t.name:t.decprofilename,description:"sites"===o?t.unencryptedUsername||t.useusername:null!==t.description?t.description:null,icons:l(r,o,t),noteType:t.notetype,moreText:"sites"===o?_.translateString("More"):x,language:1<s.length?t.language.substr(0,2):null,moreHandler:"sites"===o?null:function(){k.editFormFill(t.aid||t.ffid)},clickHandler:"sites"===o?function(){csTop.Topics.publish(Topics.INFIELD_NOTIFICATION_FILLED),k.fillUsernamePass(t.aid)}:function(){k.fillForm(t.aid||t.ffid)},lastTile:n});i&&a.push(i)}),0<a.length?C("#"+e).empty().append(a):"sites"==o&&C("#"+e).empty().append(C('<p class="italic"></p>').text(i))}return a.length}function l(e,t,n){var i="",o="",r;if("formfills"===t)if(0==n.profiletype)i=InfieldIcons.profile;else switch(n.notetype){case"Credit Card":i=a(n.ccType);break;case"Bank Account":i=InfieldIcons.ba;break;case"Social Security":i=InfieldIcons.ssn;break;case"Address":i=InfieldIcons.address;break;default:if(n.notetype.includes("Custom_")){i=InfieldIcons.custom;break}i=InfieldIcons.pw}else o="icon-site",i=e&&n.aid&&e[n.aid]?e[n.aid]:InfieldIcons.pw;return{normalEl:r=0!=n.profiletype&&"formfills"===t?C("<span/>").addClass("omarImgIcon fa fa-fw fa-2x "+i).attr("aria-hidden","true"):i==InfieldIcons.pw?C("<span/>").addClass("omarImgIcon fa fa-fw fa-2x "+i).attr("aria-hidden","true"):C("<img/>").attr("src",i).addClass("icon-default omarImgIcon "+o)}}function a(e){if(!e||!e.length)return InfieldIcons.ccDefault;switch(e){case"AMEX":return InfieldIcons.ccAmex;case"MC":return InfieldIcons.ccMastercard;case"DISC":return InfieldIcons.ccDiscover;case"VISA":return InfieldIcons.ccVisa;case"DINERS":return InfieldIcons.ccDiners;case"JCB":return InfieldIcons.ccJcb;case"GENERIC":default:return InfieldIcons.ccDefault}}function A(e){return C(F).addClass("col-2 cardIcon no-left-gutter no-right-gutter").append(C(F).addClass("icon").append(e))}function d(t,n){if(!n)return null;var i=null,o=null,r=null,a=C(F).addClass("col-10 cardBody").attr("tabindex","1"),s=C(F).addClass("cardInside"),e=C(F).addClass("fa-lg fa-stack"),c=C("<i></i>").addClass("fa fa-clone").attr("aria-hidden","true"),l=C(F).addClass("fa fa-caret-down fa-stack-1x fontAwesomeIcon").attr("aria-hidden","true"),d=C(F).addClass("fa fa-circle fa-stack-1x circle");d.append(l),e.append(c),e.append(d);var p=C("<i></i>").addClass("fa fa-pencil fa-lg").attr("aria-hidden","true"),u=C(F).attr("id",n.id+"copyBtn").attr("tabindex","1").addClass("copyAction").append(e),f=C(F).attr("id",n.id+"editBtn").attr("tabindex","1").addClass("editAction").append(p);r=C(F).addClass("cardMainAction").text(E),a.hover(function(){r.addClass(S),s.addClass(S)},function(){r.removeClass(S),s.removeClass(S)}),a.keypress(function(e){32!==e.keyCode&&32!==e.which||a.click()}),s.append(C(F).addClass("cardPrimary").text(n.name+(n.language?" ("+n.language+")":""))),s.append(C(F).addClass("cardSecondary").text(n.description||String.fromCharCode(160))),a.append(r),a.append(s);var m=C(F).addClass("cardActions no-right-gutter no-left-gutter").append(u,f);i=new P(u,!0,B),m.hover(function(){InfieldMenuTimer.clearTimer()},function(){InfieldMenuTimer.startTimer()});var g=[];bg.InfieldCommands.canCopy(function(e){e?"sites"===t?(g.push({id:"copyPassword",text:_.translateString("Copy password"),action:function(){k.copyPassword(n.id)}}),g.push({id:"copyUsername",text:_.translateString("Copy username"),action:function(){k.copyUserName(n.id)}}),g.push({id:"copyURL",text:_.translateString("Copy URL"),action:function(){k.copyUrl(n.id)}})):"Credit Card"===n.noteType?(g.push({id:"copyCardNum",text:_.translateString("Copy card number"),action:function(){k.copyProp(n.id,"Number")}}),g.push({id:"copySecurityCode",text:_.translateString("Copy security code"),action:function(){k.copyProp(n.id,"Security Code")}})):"Bank Account"===n.noteType?(g.push({id:"copyAccountNum",text:_.translateString("Copy account number"),action:function(){k.copyProp(n.id,"Account Number")}}),g.push({id:"copyRoutingNum",text:_.translateString("Copy routing number"),action:function(){k.copyProp(n.id,"Routing Number")}})):"Social Security"===n.noteType?g.push({id:"copySSN",text:_.translateString("Copy SSN"),action:function(){k.copyProp(n.id,"Number")}}):"Address"===n.noteType&&(g.push({id:"copyFirstName",text:_.translateString("Copy first name"),action:function(){k.copyProp(n.id,"First Name")}}),g.push({id:"copyLastName",text:_.translateString("Copy last name"),action:function(){k.copyProp(n.id,"Last Name")}}),g.push({id:"copyAddressFirst",text:_.translateString("Copy address 1"),action:function(){k.copyProp(n.id,"Address 1")}}),g.push({id:"copyCity",text:_.translateString("Copy city/town"),action:function(){k.copyProp(n.id,"City / Town")}}),g.push({id:"copyZip",text:_.translateString("Copy zip/postal code"),action:function(){k.copyProp(n.id,"Zip / Postal Code")}}),g.push({id:"copyEmail",text:_.translateString("Copy email address"),action:function(){k.copyProp(n.id,"Email Address")}}),g.push({id:"copyPhone",text:_.translateString("Copy phone number"),action:function(){k.copyProp(n.id,"Phone","num")}})):C("#btnCopy").hide(),g.length?((o=i.createMenu("copy","tileDropdown",g)).hover(function(){InfieldMenuTimer.clearTimer()},function(){InfieldMenuTimer.startTimer()}).focusin(function(){InfieldMenuTimer.clearTimer()}).focusout(function(){InfieldMenuTimer.startTimer()}),C("#menuContainer").append(o),u.click(function(e){e.stopPropagation(),i.show()}),u.bind("reset",function(e,t){I.removeClass("triggered"),!t&&a.hasClass(S)||(c.removeClass(S),d.removeClass(S)),r&&(r.text(E),s.hasClass(S)||r.removeClass(S))}),u.hover(function(){o&&o.is(":visible")||(c.addClass(S),d.addClass(S),r&&(r.text(T),r.addClass(S)))},function(){o&&o.is(":visible")||u.hasClass("menuTriggered")||(c.removeClass(S),d.removeClass(S),r&&(r.text(E),a.hasClass(S)||r.removeClass(S)))})):u.hide()});var h=function(e){e.stopPropagation(),"sites"===t?k.editSite(n.id):"formfills"===t&&k.editFormFill(n.id)},w;f.click(h).keypress(function(e){32!==e.keyCode&&32!==e.which||h(e)}),f.hover(function(e){o&&o.is(":visible")||(p.addClass(S),r&&(r.text(x),r.addClass(S)))},function(){o&&o.is(":visible")||(p.removeClass(S),r&&(r.text(E),r.removeClass(S)))}),new MutationObserver(function(e){e.forEach(function(e){var t;"class"==e.attributeName&&(e.target.classList.contains("menuTriggered")||e.target.children[0].firstChild.classList.contains("hovered")&&(c.removeClass(S),d.removeClass(S)))})}).observe(u[0],{attributes:!0,childList:!0});var v=function(){m.addClass(S),a.addClass(S)},y=function(){u.hasClass("menuTriggered")||(I.removeClass("triggered"),m.removeClass(S),a.removeClass(S),s.removeClass(S),r&&r.removeClass(S))},b=A([n.icons.normalEl]),I=C(F).addClass("cardContainer col-12").attr("id",n.id).append(C(F).addClass("omarCard").append(b,a,m)).hover(v,y).focus(v).blur(y);return I.click(n.clickHandler),n.lastTile&&I.addClass("lastTile"),C(".copyAction",".editAction").focus(function(){I.addClass("triggered")}).blur(function(){I.removeClass("triggered")}).click(function(){I.addClass("menuTriggered"),I.removeClass("triggered")}),I}return C("#menuContainer").empty(),{setup:e}}(jQuery,InfieldCommands,InfieldMenu,Strings),InfieldSearch=function(n){var i,o,r,a,s,e=250;function t(t){if(o=n("#searchContainer"),r=n("#inlineSearch"),a=n("#searchCloseBtn"),s=n("#searchBtn"),i=n("#headerMain"),p(),n("#searchBtn").click(function(){n(this).hasClass("search")&&l()}).keypress(function(){n(this).hasClass("search")&&l()}),n("#searchCloseBtn").click(function(){d(),t("")}).keypress(function(){d(),t("")}),t){var e=c(function(e){t(n(e.currentTarget).val())},debounceWait);r.keyup(e)}n("#inlineSearch").focus(function(){n(".searchBar").addClass("hoverOver").fadeIn(100)}),n("#inlineSearch").focusout(function(){n(".searchBar").removeClass("hoverOver")})}function c(n,i){var o;return function(){var e=this,t=arguments;clearTimeout(o),o=setTimeout(function(){o=null,n.apply(e,t)},i)}}function l(){o.show(),i.hide(),o.animate({},e,function(){a.show(),r.fadeIn().focus()}),s.addClass("searchBtnActive")}function d(){o.hide(),i.show(),o.animate({},e,function(){a.hide(),r.fadeOut()}),r.val(""),s.removeClass("searchBtnActive")}function p(){o.hide(),s.removeClass("searchBtnActive")}function u(){o.show()}function f(){r.hide(),a.hide(),o.hide()}function m(e){e&&!0===e?u():f()}return{init:t,debounce:c,showIcon:u,hideIcon:f,display:m}}(jQuery),lpInfield=function(o,r,e,a,s,c,l,t,n){var d,p,u=n.translateString("No passwords found for this site."),f=n.translateString("No passwords found for this site."),m=n.translateString("Nothing in your vault to fill on this site."),g=n.translateString("Nothing in your vault to fill on this site."),h=10,w=360;function v(){var e=Date.now();document.addEventListener("DOMContentLoaded",function(){C(function(){var e;n.translate(document.body),g_language&&o("html").attr("lang",g_language),y(),I(),a.init(["sitesView","formFillView","generatePassView","paywallView"]),c.init(_),l.init(r,T),new MutationObserver(function(){T()}).observe(o(".infield-dialog")[0],{subtree:!0,childList:!0}),bg.get("g_is_restricted")?L():r.getInitialData(B)})})}function y(){p=new t({$parentEl:o(".infield-dialog")}),b({position:w})}function b(e){p&&(e&&e.position&&o.isNumeric(e.position)&&e.position>h&&e.position<w?p.show("top",e.position):p.show(!1,!1))}function I(){o("#btnClose").click(function(){r.closePopup("close")}),o("#btnClose").keypress(function(){r.closePopup("close")}),o(".infield-dialog").keydown(function(e){if(27===e.keyCode||27===e.which)r.closePopup("close");else if(9===e.keyCode||9===e.which)if(k()&&!e.shiftKey)o("#searchBtn, #searchBtn2").focus(),e.preventDefault();else if(P()&&e.shiftKey){var t=o(".lastTile").length?"#fillPasswordBtn, .lastTile .cardBody":"#fillPasswordBtn, #searchCloseBtn";o(t).focus(),e.preventDefault()}})}function C(i){var t=null;document.body.style.setProperty("display","none","important");var e=document.createElement("iframe");e.setAttribute("class","backgroundFrame"),e.src="backgroundFrame.html?lplanguage="+encodeURIComponent(g_language),e.style.display="none",e.addEventListener("load",function(){e.contentWindow.LPPlatform.getBackgroundInterface({mainRequestFramework:!1,interfaceDefinition:Interfaces.InfieldPopupInterface,getData:!0,context:"infieldPopup",callback:function(e){window.bg=e,t&&t()}}),e.contentWindow.Topics.get(e.contentWindow.Topics.REQUEST_FRAMEWORK_INITIALIZED).subscribe(function(e,n){t=function(){if(bg.get("LPContentScriptFeatures").web_client_fill)reduxInfield.createStore(function(n){window.csTop={Topics:{publish:function(){}},LPInfieldFrame:{resizeFrame:function(e,t){n.dispatch(reduxInfield.fillActions.resizeLegacyInfieldContainer(t,e))},positionFrame:function(){},show:function(){},close:function(){n.dispatch(reduxInfield.fillActions.closeLegacyInfield())}}},reduxStore=n,document.body.style.removeProperty("display"),i()});else{var t=parseInt(e.topFrameID);window.csTop=Interfaces.createInstance(Interfaces.ContentScriptInterface,{direct:!1,context:"infieldPopup",requestFunction:function(e){n.sendRequest({type:"contentScriptRequest",data:e,frameID:t})}}),window.csTop.LPFrame.initializeRequestFramework(LPTools.getURLParams().dialogID,function(e){e&&(document.body.style.removeProperty("display"),i&&i())})}},"undefined"!=typeof bg&&t()})}),document.body.appendChild(e)}function k(){return o(document.activeElement)[0].classList.contains("editAction")&&o(document.activeElement).closest(".cardContainer").length&&o(document.activeElement).closest(".cardContainer")[0].classList.contains("lastTile")||"fillPasswordBtn"===document.activeElement.id}function P(){return"searchBtn"===document.activeElement.id||"searchBtn2"===document.activeElement.id}function _(e){r.searchVault(e,d.type,S)}function S(e){var t=d.type;if(e){var n=JSON.parse(e);n&&(s.setup("sitesView","sites",n.sites,n.bigicons,T,f),s.setup("formFillView","formfills",n.formfills,null,T,g))}}function T(e,t){var n=o(".infield-dialog").outerHeight()+20,i=o(".infield-dialog").outerWidth()+10;e&&o.isNumeric(e)&&(n+=e),t&&o.isNumeric(t)&&(i+=t),csTop.LPInfieldFrame.resizeFrame(n,i)}function x(e){o("#fillSelector").show();var t=JSON.parse(e.fillData.sites),n=e.fillData.bigIcons?JSON.parse(e.fillData.bigIcons):null;s.setup("sitesView","sites",t,n,T,u);var i=e.fillData.formFills?JSON.parse(e.fillData.formFills):{};return s.setup("formFillView","formfills",i,null,T,m),a.show("formFillView"),l.hide(),Object.keys(t).length+Object.keys(i).length}function E(){o("#fillSelector").hide(),a.show("generatePassView"),r.getGeneratePrefs(l.setup),l.show()}function F(){csTop.LPInfieldFrame.positionFrame(function(e){csTop.Topics.publish(Topics.INFIELD_NOTIFICATION_OPENED,e)}),csTop.LPInfieldFrame.show(),o(".infield-dialog").show()}function L(){o("#fillSelector").hide(),o(".header").hide(),a.show("paywallView"),l.hide();var e=Number(bg.get("g_primary_device_switches_left")||0),t=bg.get("g_infield_multidevice_paywall_tracking");o("#gotItButton").click(function(){r.closePopup("close"),t&&bg.sendLpImprove("mdpw_paywall_clicked",{Action:"Dismiss",CurrentDevice:"Desktop",Source:"Infield Dropdown",SwitchesLeft:e})}),o("#goPremiumButton").click(function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?bg.openvault(!1,"showfamilyexpiredpurchase"):(window.open("https://www.lastpass.com/premium/payment","_blank"),r.closePopup("close"),t&&bg.sendLpImprove("mdpw_paywall_clicked",{Action:"Go Premium",CurrentDevice:"Desktop",Source:"Infield Dropdown",SwitchesLeft:e}))}),o("#paywallFooter button").hide(),0<e?(o("#gotItButton").show(),o("#paywallContent").html(n.translateString("%sClick the LastPass%s icon on the browser toolbar to activate your computer.","<b>","</b>"))):(o("#goPremiumButton").show(),o("#paywallContent").html(n.translateString("%sGo Premium%s for unlimited access on both mobile devices and computers.","<b>","</b>")),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()&&(o("#paywallContent").html(n.translateString("%sUpgrade to Families or Premium%s for unlimited access on all mobile devices and computers.","<b>","</b>")),o("#goPremiumButton").html(n.translateString("Upgrade Now")))),F(),T(0,0),t&&bg.sendLpImprove("mdpw_user_viewed",{CurrentDevice:"Desktop",Source:"Infield Dropdown",SwitchesLeft:e})}function B(t){if(t){if((d=t).type)switch(t.type){case"generate":E(),c.display(!1);break;case"formfills":o(".lblSites").insertAfter("#formFillView"),o("#sitesView").insertAfter(".lblSites");default:var e=x(t)}if("generate"!=t.type&&t.condensedDropdown&&!0===t.condensedDropdown){var n={init:function(){o(".viewLabel").hide(),o("#fillSelector").show();var e=n.getData();n.createDropdown(e),n.selectDropdownOption()},getData:function(){var e=0,t=[];return o(".views").children("div").each(function(){var e={id:null,text:null};e.id=o(this).attr("id"),"sitesView"===e.id&&(e.text="Log in as",t.push(e)),"formFillView"===e.id&&(e.text="Fill form with",t.push(e))}),t},createDropdown:function(e){for(o("#fillSelector").html(""),o("<div/>",{id:"dropdownButton",class:"dropdownButton"}).appendTo("#fillSelector"),o("<span/>",{id:"dropdownButtonText",class:"dropdownButtonText",text:""}).appendTo("#dropdownButton"),o("<i/>",{id:"dropdownButtonIcon",class:"fa fa-caret-down dropdownButtonIcon",ariaHidden:!0}).appendTo("#dropdownButton"),o("<ul/>",{id:"dropdown",class:"dropdown"}).appendTo("#fillSelector"),i=0;i<e.length;i++)o("<li/>",{id:"option"+i,class:"option"+i,"data-viewed":e[i].id}).appendTo("#dropdown"),o("<i/>",{class:"fa fa-check","aria-hidden":!0}).appendTo("#option"+i),o("<span />",{text:e[i].text}).appendTo("#option"+i);o("#dropdown").hover(function(){InfieldMenuTimer.clearTimer()},function(){InfieldMenuTimer.startTimer()})},selectDropdownOption:function(e){void 0===e?e={id:"option0",text:o("#option0 > span").text(),action:o("#option0").attr("data-viewed")}:InfieldCommands.sendLPImprove("infield_dropdown_toggled",{toggle:e.action,domain:t.url}),o("#dropdownButtonText").text(e.text),o("#views").children().hide(),o('div[id*="'+e.action+'"]').show(),o("#dropdown > li > i").hide(),o("#dropdown > #"+e.id+" > i").show(),o("#dropdown").hide()}};n.init(),o("#dropdownButton").click(function(){o("#dropdown").show(),T(o("#dropdown").height())}),o("#dropdown > li").click(function(){var e={id:o(this).attr("id"),text:o(this).text(),action:o(this).attr("data-viewed")};n.selectDropdownOption(e)})}else t.noHeaders&&!0===t.noHeaders&&(o(".lblSites").hide(),o(".lblForms").hide());o("#searchBtn").click(function(){x(t),T()}).keypress(function(){x(t),T()}),o("#generatePassInfieldIconInfield").click(function(){E()}).keypress(function(){E()}),F()}else r.closePopup("close")}return{init:v,setArrowPosition:b}}(jQuery,InfieldCommands,InfieldMenu,InfieldView,InfieldTiles,InfieldSearch,InfieldGeneratePassword,lpArrow,Strings);lpInfield&&lpInfield.init();