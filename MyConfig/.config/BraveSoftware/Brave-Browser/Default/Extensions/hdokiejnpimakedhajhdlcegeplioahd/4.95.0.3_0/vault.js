var reduxApp;LPVault={};var initialize=function(r,d,o){var i=Strings.translateString("Folder (a-z)"),n=Strings.translateString("Folder (z-a)"),a=Strings.translateString("Name (a-z)"),s=Strings.translateString("Name (z-a)"),l=Strings.translateString("Most Recent"),c=Strings.translateString("Sender (a-z)"),u=Strings.translateString("Sender (z-a)"),p=Strings.translateString("Recipient (a-z)"),g=Strings.translateString("Recipient (z-a)"),e=[i,n,a,s,l],t=[a,s],m=[a,s,p,g,l],f=[a,s,c,u,l],y=[a,s],h=[a,s];document.documentElement.lang=getHtmlLanguageCode(bg.get("g_language")),d.handleSubscriptionChange=function(){var t=300,i=0,n=Strings.translateString("Subscription updated. Thanks for choosing LastPass!"),o=getCookie("subscription_updated");o&&(deleteCookie("subscription_updated"),Notifications.displaySuccessMessage(n));var r=setInterval(function(){if((o=getCookie("subscription_updated"))&&(deleteCookie("subscription_updated"),localStorage.setItem(bg.get("g_username_hash")+"LPNotificationSuccessMessage",n),clearInterval(r),LPFeatures.secondaryOnboardingEnabled()&&void 0!==reduxApp&&"function"==typeof reduxApp.setSecondaryOnboardingClaimedView))var e=setInterval(function(){i===t&&clearInterval(e),"visible"===document.visibilityState&&(reduxApp.setSecondaryOnboardingClaimedView(),setTimeout(function(){parent.location.reload()},5e3)),i++},1e3)},500)},d.handleShowingNotificationsFromRedux=function(){var i=function(e,t){e&&t&&("string"==typeof t?Notifications.displayAlertMessage(t):Notifications.displayAlertMessage(t.id))},n=function(e,t){e&&t&&("string"==typeof t?Notifications.displaySuccessMessage(t):Notifications.displaySuccessMessage(t.id))};if(void 0!==reduxApp&&"function"==typeof reduxApp.subscribeForState){var e=reduxApp.getState().settings.alertMessagetext,t=reduxApp.getState().settings.successMessagetext;i(e,e),n(t,t),reduxApp.subscribeForState({handler:function(e,t){i(e,t)},selector:"settings.alertMessagetext"}),reduxApp.subscribeForState({handler:function(e,t){n(e,t),Notifications.closeAlertMessage()},selector:"settings.successMessagetext"})}};var P=function(e){this.options=e};P.prototype.getAddElement=function(){return void 0===this.addElement&&(this.addElement=LPTools.createElement("div","addMenuItem"),this.build(this.addElement,this.options.icon?this.options.icon:"images/vault_4.0/Add.png",18)),this.addElement},P.prototype.build=function(e,t,i){var n=this.options.autoId||"";e.appendChild(LPTools.createElement("span",null,Strings.Vault[this.options.text])).setAttribute("automation-id",n);var o=LPTools.createElement("div"),r=LPTools.createElement("div",{tabindex:i,class:"focusable-add-menu-item space-clickable"}),a=LPTools.createElement("img",{src:t});e.appendChild(o),o.appendChild(r),r.appendChild(a),$(r).bind("focus",nt),$(r).bind("blur",rt),$(e).bind("click",this.options.func)},P.prototype.getMenuElement=function(e){return void 0===this.menuElement&&(this.menuElement=LPTools.createElement("li","addMenuItem"),this.build(this.menuElement,this.options.additionalIcon,e)),this.menuElement};var b={Site:new P({text:"ADD_SITE",autoId:"vaultAddSiteButton",icon:"images/vault_4.0/Sites_Active.png",func:function(){d.openSiteDialog({saveOptions:{source:"vault"}})}}),Note:new P({text:"ADD_NOTE",autoId:"vaultAddNoteButton",icon:"images/vault_4.0/Notes_Active.png",additionalIcon:"images/vault_4.0/Add_Secure_Note.png",func:function(){d.openNoteDialog({saveOptions:{source:"vault"}})}}),FormFill:new P({text:"ADD_FORM_FILL",autoId:"vaultAddFormFillButton",icon:"images/vault_4.0/Form_Fills_Active.png",func:function(){d.openFormFillDialog({saveOptions:{source:"vault"}})}}),SharedFolder:new P({text:"ADD_SHARED_FOLDER",autoId:"vaultAddSharedFolderButton",func:function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Add Shared Folder"):d.openCreateSharedFolderDialog()}}),Identity:new P({text:"ADD_IDENTITY",autoId:"vaultAddIdentityButton",func:function(){d.openIdentityDialog()}}),EmergencyAccess:new P({text:"GIVE_EMER_ACCESS",autoId:"vaultGiveEmerAccessButton",func:function(){LPFeatures.isVaultPremiumPopupsEnabled()&&LPProxy.isFreeUser()||LPProxy.isExpiredUser()?(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),d.showVaultUpgradeToPremiumDialog("emergency_access")):dialogs.addEmergencyAccess.open()}}),CreditMonitoring:new P({text:"ADD_CREDIT_MON",autoId:"vaultAddCreditButton",func:function(){d.openCreateCreditMonitoringDialog()}}),Folder:new P({text:"ADD_FOLDER",autoId:"vaultAddNewFolderButton",additionalIcon:"images/vault_4.0/Add_Folder.png",func:function(){d.openFolderDialog()}}),ShareItems:new P({text:"SHARE_ITEMS",autoId:"vaultAddShareItemsButton",additionalIcon:"images/vault_4.0/Add_Share.png",func:function(){d.openShareDialog()}})},v=Strings.translateString("search my vault"),S=null,L=$("#advacedOptionsOverlay"),E=$("#inProgressOverlay"),_=$("#header"),x=$("#leftMenu"),T=$("#vaultContent"),I=$("#tools"),F=$("#helpTools"),w=$("#options"),C=$("#mainScroll"),A=$("#addMenu"),D=$("#addMenuItems"),M=$("#addMenuButton"),k=$("#addMenuButtonCustom"),B=$("#gridButton"),O=$("#listButton"),R=$("#collapseAllToggle"),U=$("#sizeToggle"),V=$("#orderOption"),N=$("#sortOrderMenu"),G=$("#sortOrderOption"),z=$("#userMenuItems"),H=$("#leftMenuMinimizeButton"),W=$("#moreActions"),Y=r.getElementById("contextMenu").parentElement,q=$(r.body),j=$("#advancedMenuItem"),K=$("#helpMenuItem"),X=r.getElementById("sortOrderMenu").children[0],J=$("#vaultSearch"),Z=$("#userMenuContainer"),Q=$("#pageTitle"),ee=$("#cloudAppsMenuItem"),te=$(".securityMenuItem"),ie=$(".securityDashboardMenuItem"),ne=$("#emergencyAccessMenuItem"),oe=$("#familyAdminConsoleMenuItem"),re=$(".emptyVaultWrapper"),ae=$("#sharedFoldersMenuItem"),se=$("#addMenuButtonDefault"),le=["leftMenu","header","vaultContent","addMenuButtonDefault"],ce=["sharedFolders","sentShares","receivedShares"],ue=["emergencyTrusted","emergencyTrusting"],de=null,pe=null,ge=!0,me=null,fe=null,ye=null,he=function(e,t){ye.getContainer()===t&&(ye.removeBodyState(),ye.addBodyState())},Pe=function(e){var n;e=e||{},this.state=e.bodyState,this.menuElement=e.menuElement||null,this.emptyState=this.state+"Empty",this.container=null,this.sortOptions=e.sortOptions||null,this.persistent=LPTools.getOption(e,"persistent",!0),this.searchPlaceholder=LPTools.getOption(e,"searchPlaceholder",v),this.title=e.title||"",this.addMenu=e.addMenu,this.additionalOptionButtons=e.additionalOptionButtons,this.scrollParent=e.scrollParent,this.notificationCount=e.notificationCount,n=this,Topics.get(Topics.CLEAR_DATA).subscribe(function(){n.clear()}),e.menuElement&&e.menuElement.unbind("click.menu").bind("click.menu",function(){var e=void 0,t=null;try{void 0!==(t=LPProxy.getConfigViewObject(n.getElement().id)).segmentEvent&&bg.sendLpImprove(t.segmentEvent),e=t.url}catch(e){}if(bg.get("g_is_restricted")){var i=t?t.id:null;if(["passwords","notes","addresses","payment-cards","bank-accounts"].includes(i))return void d.openVaultDeviceLimitDialog()}void 0!==e?bg.openOnNewTab(e):n.parent?n.parent.show(n):n.show()})};Pe.prototype.getElement=function(){return this.menuElement.get(0)},Pe.prototype.applyContainerFunction=function(e){var t=this.getContainer();if(null!==t)switch(typeof e){case"string":var i=[];if(1<arguments.length)for(var n=1,o=arguments.length;n<o;++n)i.push(arguments[n]);return t[e].apply(t,i);case"function":return e(t)}},Pe.prototype.updateNotificationCount=function(e){var t=0,i=this.menuElement.find(".tabNotification");return void 0!==e?(t=parseInt(i.text()),At(i,t-e),this.parent&&this.parent.updateNotificationCount(e)):this.notificationCount&&(t=this.notificationCount(),At(i,t)),t},Pe.prototype.getSortOptions=function(){return this.sortOptions},Pe.prototype.getContainer=function(){return this.container},Pe.prototype.setContainer=function(e,t){(this.container=e)&&(e._buildOptions.stateChangeCallback=he,LPTools.getOption(t,"checkForStateChange",!0)&&ye===this&&he(e.isEmpty(),e),ye===this&&""!==J.val()&&d.search(J.val()))},Pe.prototype.openAll=function(){this.applyContainerFunction("openAll")},Pe.prototype.collapseAll=function(){this.applyContainerFunction("collapseAll")},Pe.prototype.createSelectionContextMenu=function(){return this.applyContainerFunction("createSelectionContextMenu")},Pe.prototype.isEmpty=function(){return this.applyContainerFunction("isEmpty")},Pe.prototype.search=function(e){var t=this.applyContainerFunction("applySearch",e);e&&null===t&&!this.isEmpty()?q.addClass("searchEmpty"):q.removeClass("searchEmpty")},Pe.prototype.clearSelected=function(){this.applyContainerFunction("clearSelected")},Pe.prototype.getSelectedItems=function(){return this.applyContainerFunction("getSelectedItems")},Pe.prototype.getSortOrder=function(){if(void 0===this.sortOrder){var e=this.sortOptions?this.sortOptions[0]:null;this.sortOrder=localStorage.getItem(this.state+"SortOrder")||e}return this.sortOrder},Pe.prototype.setSortOrder=function(e){this.sortOrder=e,localStorage.setItem(this.state+"SortOrder",e)},Pe.prototype.addBodyState=function(){q.addClass(this.getState());var e=this.getContainer();null!==e&&e.isEmpty()?q.addClass("empty"):q.removeClass("empty"),setTimeout(function(){Topics.get(Topics.EMPTY_VAULT_STATE_CHANGE).publish()},400)},Pe.prototype.removeBodyState=function(){q.removeClass(this.emptyState),q.removeClass(this.state)},Pe.prototype.hide=function(){if(null!==this.menuElement&&this.menuElement.removeClass("selected"),this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.removeClass("selected"),this.removeBodyState(),this.additionalOptionButtons)for(var e=0,t=this.additionalOptionButtons.length;e<t;++e)this.additionalOptionButtons[e].detach();this.persistent?this.applyContainerFunction("hide"):this.clear()},Pe.prototype.getAddMenuItems=function(){var e=[];if(this.addMenu&&0<this.addMenu.length)for(var t=0,i=this.addMenu.length;t<i;++t){var n=this.addMenu[t];n===b.ShareItems&&!LPFeatures.allowIndividualSharing()||n===b.Note&&!LPFeatures.allowNotes()||e.push(n)}return e},Pe.prototype.show=function(){if($("#vault").focus(),ye!==this){null!==ye&&(je(),ye.hide()),J.attr("placeholder",this.searchPlaceholder),J.next().attr("tabindex",3),null!==this.menuElement&&this.menuElement.addClass("selected"),this.parent&&null!==this.parent.menuElement&&this.parent.menuElement.addClass("selected"),-1!==ce.indexOf(this.state)?Q.text("Sharing Center"):-1!==ue.indexOf(this.state)?Q.text("Emergency Access"):Q.text(this.title);var e=bg.get("g_is_restricted"),i=parseInt(bg.get("g_primary_device_switches_left")),t=new Date(2021,4,6,23,59,59,0).getTime()>(new Date).getTime(),n=function(){var e=bg.get("g_username_hash")+"LPNotificationSuccessMessage",t;1<i&&(t=Strings.translateString("You switched to computer: %s switches left",i-1)),1===i&&(t=Strings.translateString("You made the final switch to computer"));try{t&&localStorage.setItem(e,t)}catch(e){}};if(LPProxy.isExpiredFamilyUser()&&reduxApp.getState().settings.features.expired_families_purchase_flow&&!bg.localStorage_getItem(bg.get("g_uid")+"_firstExpiredFamilyNotification")&&reduxApp.getState().settings.primaryDeviceIsWeb)reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"First vault opening"),bg.localStorage_setItem(bg.get("g_uid")+"_firstExpiredFamilyNotification",JSON.stringify(new Date)),this.addBodyState();else if(e){var o=function(e){e&&location.reload()};reduxApp&&"function"==typeof reduxApp.subscribeForState&&reduxApp.subscribeForState({handler:o,selector:"settings.isRestricted"}),Kt?dt():ut(),$("#restrictedVaultItems").empty(),$("#options").css({"background-color":"white"});for(var r=0;r<8;r++)$("#restrictedVaultItems").append("<div class='restricted-vault-item'><div class='restricted-vault-item-header'><div class='restricted-vault-item-logo'></div></div><div class='restricted-vault-item-footer'><div class='restricted-vault-item-small-bar'></div><div class='restricted-vault-item-large-bar'></div></div></div>");switch(i){case 0:$("#restrictedVaultTitle").text(Strings.translateString("Everything is safe in your vault.")),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?($("#restrictedVaultMessage").text(Strings.translateString("To use LastPass on computer, upgrade to Families or Premium. Otherwise, log in on a mobile device.")),$("#restrictedVaultPrimaryButton").text(Strings.translateString("Upgrade for unlimited access")),$("#restrictedVaultLearnMoreLink").text(Strings.translateString("Which plan is right for you?"))):($("#restrictedVaultMessage").text(Strings.translateString("To use LastPass on computer, go Premium. Otherwise, log in on a mobile device.")),$("#restrictedVaultPrimaryButton").text(Strings.translateString(t?"Go Premium for only $2.25/month":"Go Premium for only $3/month")),$("#restrictedVaultLearnMoreLink").text(Strings.translateString("What is LastPass Premium?"))),$("#restrictedVaultLearnMoreLink").attr("href","https://www.lastpass.com/pricing/lastpass-premium-vs-free");break;case 1:reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?$("#restrictedVaultMessage").text(Strings.translateString("This is your last opportunity to switch. Upgrade to Families or Premium for unlimited access.")):$("#restrictedVaultMessage").text(Strings.translateString("This is your last opportunity to switch. Go Premium for unlimited access."));break;case 2:reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?$("#restrictedVaultMessage").text(Strings.translateString("You can switch your device type 2 more times to find the right option for you. Upgrade to Families or Premium for unlimited access.")):$("#restrictedVaultMessage").text(Strings.translateString("You can switch your device type 2 more times to find the right option for you. Go Premium for unlimited access."));break;case 3:$("#restrictedVaultMessage").text(Strings.translateString("You can only use LastPass for free on one device type. Switch up to 3 times to find the right option for you."));break;default:$("#restrictedVaultMessage").text(Strings.translateString("You can only use LastPass for free on one device type. Switch up to %s times to find the right option for you.",i))}$("#restrictedVaultPrimaryButton").off("click"),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()&&0===i?$("#restrictedVaultPrimaryButton").click(function(){reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Multi Device Paywall")}):1<i?$("#restrictedVaultPrimaryButton").click(function(){bg.setPrimaryDevice(function(){var e=LPProxy.refreshSites();e?e.then(function(){n(),location.reload()}).catch(function(){Notifications.displayErrorMessage("Something went wrong. We couldn’t switch your device type. Please try again.")}):(n(),location.reload())},function(){Notifications.displayErrorMessage("Something went wrong. We couldn’t switch your device type. Please try again.")})}):1===i?$("#restrictedVaultPrimaryButton").click(function(){d.openVaultDeviceLimitDialog()}):$("#restrictedVaultPrimaryButton").click(function(){t?window.open("https://lastpass.com/buy-premium?cp=LPP2021-DT-25Sw","_blank"):window.open("https://lastpass.com/premium/payment","_blank")}),$("#passwords, #notes, #addresses, #payment-cards, #bank-accounts").css({color:"#5D6B73"}),$("#toolsImport, #manageIdentitiesMenuItem, #openTourMenuItem, #toolsOpenFavorites, #historyMenuItem, #deletedMenuItem").css({color:"#B9C0C9"}),Kt||$("#creditMonitoringMenuItem").css({color:"#B9C0C9"}),$(".securityDashboardMenuItem .leftMenuItem").css({color:"#5D6B73"}),$(".securityDashboardMenuItem .menuIcon").css({opacity:"0.5"}).empty(),$(".sharingMenuItem .leftMenuItem").css({color:"#5D6B73"}),$(".sharingMenuItem .menuIcon").css({opacity:"0.5"}),$("#emergencyAccessMenuItem .leftMenuItem").css({color:"#5D6B73"}),$("#emergencyAccessMenuItem .menuIcon").css({opacity:"0.5"})}else this.addBodyState();this.scrollParent.scrollTop(0);var a=this.getSortOptions();null!==ye&&ye.getSortOptions()===a||Xe(a);var s=(ye=this).getSortOrder();s&&d.sort(s),this.additionalOptionButtons&&w.append(this.additionalOptionButtons),D.children().detach(),k.children().detach();var l=this.getAddMenuItems();if(0<l.length){var c=l[0];k.append(c.getAddElement());for(var r=l.length-1;0<r;--r)D.append(l[r].getMenuElement(19));M.show()}else M.hide();LPProxy.getPreference("leftMenuMaximize")?d.maximizeLeftMenu():d.minimizeLeftMenu()}},Pe.prototype.getState=function(){return this.isEmpty()?this.emptyState:this.state},Pe.prototype.clear=function(){this.container&&(this.container.destruct(),this.container=null)};var be=function(e){var n;e.bodyState=e.bodyState||e.contentID,Pe.call(this,e),this.contentElement=r.getElementById(e.contentID),this.containerType=e.containerType,this.dataSource=e.dataFunction,this.buildOptions=e.buildOptions,this.filter=e.filter,n=this,Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){n.refresh(e)}),n.initializeCallback=function(e,t){var i=new n.containerType(e,n.buildOptions);i.initialize(n.contentElement,n.scrollParent),n.filter&&i.applyFilter(n.filter,{checkForStateChange:!1}),n.setContainer(i,{checkForStateChange:LPTools.getOption(t,"checkForStateChange",!1)}),Topics.get(Topics.DIALOG_LOADED).publish()}};((be.prototype=Object.create(Pe.prototype)).constructor=be).prototype.makeDataRequest=function(e,t){t.error=function(){Topics.get(Topics.DIALOG_LOADED).publish()},LPRequest.makeDataRequest(e,t)},be.prototype.initialize=function(e,t){var i,n;null===this.container&&null!==this.containerType&&null!==this.dataSource&&(i=this,e=(n=e)?function(e,t){i.initializeCallback(e,t),n()}:i.initializeCallback,Topics.get(Topics.DIALOG_LOADING).publish(),this.dataSource.call(this,e,t))},be.prototype.show=function(e){var t;null===this.container?(t=this).initialize(function(){e&&e(),Pe.prototype.show.apply(t)}):(Pe.prototype.show.apply(this),e&&e())},be.prototype.refresh=function(e){null!==this.container&&(this.container.destruct(),this.container=null,this.initialize(null,{identity:e,checkForStateChange:!0}))};var ve=function(e){Pe.call(this,e),this.setContainer(e.container||null),this.filter=e.filter};((ve.prototype=Object.create(Pe.prototype)).constructor=ve).prototype.show=function(){this.container.applyFilter(this.filter,{checkForStateChange:!1}),Pe.prototype.show.apply(this,arguments)};var Se=function(n){var i=null,e;if(n.views&&0<n.views.length){for(var t=0,o=n.views.length;t<o;++t)n.views[t].parent=this;this.show=function(e,t){e?(e.show(t),i=e):(null===i&&(i=n.defaultView()),i.show(t))},this.clear=function(){i=null},this.menuElement=n.menuElement;var r=n.menuElement.find(".notificationBubble");this.updateNotificationCount=function(e){for(var t=0,i=r.length;t<i;++t){var n=$(r[t]);At(n,parseInt(n.text())-e)}};var a=function(){for(var e=0,t=0,i=n.views.length;t<i;++t)e+=n.views[t].updateNotificationCount();At(r,e)};Topics.get(Topics.LOGIN).subscribe(a),Topics.get(Topics.REFRESH_DATA).subscribe(a),e=this,Topics.get(Topics.CLEAR_DATA).subscribe(function(){e.clear()})}},Le=new be({containerType:IdentityContainer,dataFunction:function(e){for(var t=[],i=0,n=S._identities.length;i<n;++i)t.push(S._identities[i].newDisplayObject());e(t)},sortOptions:h,contentID:"identityContent",bodyState:"identity",scrollParent:C,searchPlaceholder:Strings.translateString("search my identities"),buildOptions:{multiSelect:!1},title:Strings.translateString("Identities"),addMenu:[b.Identity]}),Ee=new be({containerType:CreditMonitoringContainer,dataFunction:(_e=function(e,t,i){for(var n=!0,o=[],r=0,a=t.length;r<a;++r){var s=t[r];"1"!==s.premium&&(n=!1),o.push(new CreditMonitoringProfile(s))}var l=$("#creditMonitoring .viewExplanation");n?(l.hide(),Ee.title=Strings.translateString("Premium Credit Monitoring")):(l.show(),Ee.title=Strings.translateString("Credit Monitoring")),e(o,i)},function(t,i){this.makeDataRequest(LPProxy.getCreditMonitoringData,{success:function(e){_e(t,e,i)}})}),persistent:!1,contentID:"creditMonitoring",scrollParent:C,title:Strings.translateString("Credit Monitoring"),addMenu:[b.CreditMonitoring]}),_e,xe=new be({containerType:GridListContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getDeletedItems,{success:e})},filter:{showEmptyGroups:!1},sortOptions:e,contentID:"deletedItems",scrollParent:C,persistent:!1,searchPlaceholder:Strings.translateString("search my deleted items"),buildOptions:{allowDrag:!1,stickyFolders:!0,stickyFolderParent:r.getElementById("main")},title:Strings.translateString("Deleted Items"),additionalOptionButtons:[(Te=LPTools.createElement("div",{class:"optionButton optionButtons",id:"purgeAllButton"},Strings.Vault.PURGE_ALL),LPPlatform.addEventListener(Te,"click",function(){var e=xe.getContainer();if(e){var t=e.getItemModelChildren();0<t.length&&t[0].purge({itemsForAction:t})}}),$(Te))]}),Te;xe.refresh=function(){};var Ie=new be({containerType:EmergencyAccessRecipientContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getEmergencyAccessRecipientInfo,{success:e})},filter:{showEmptyGroups:!1},sortOptions:e,menuElement:$("#emergencyTrustedMenuItem"),contentID:"emergencyTrustedContainer",bodyState:"emergencyTrusted",scrollParent:C,persistent:!1,searchPlaceholder:Strings.translateString("search people I trust"),buildOptions:{allowDrag:!1},title:Strings.translateString("People I Trust"),addMenu:[b.EmergencyAccess]}),Fe=new be({containerType:EmergencyAccessSharerContainer,dataFunction:function(e,t){this.makeDataRequest(LPProxy.getEmergencyAccessSharerInfo,{success:e})},filter:{showEmptyGroups:!1},notificationCount:function(){var e=0,t=bg.get("g_emer_sharers");if(t)for(var i=0,n=t.length;i<n;++i)"0"===t[i].accepted&&++e;return e},sortOptions:e,menuElement:$("#emergencyTrustingMenuItem"),contentID:"emergencyTrusting",bodyState:"emergencyTrusting",scrollParent:C,persistent:!1,searchPlaceholder:Strings.translateString("search people who trust me"),buildOptions:{allowDrag:!1},title:Strings.translateString("People Who Trust Me")}),we=new Se({menuElement:$("#emergencyAccessMenuItem"),defaultView:function(){return 0<Fe.notificationCount()?Fe:Ie},views:[Ie,Fe]}),Ce=new Pe({bodyState:"reactMainView",menuElement:$(".securityDashboardMenuItem"),persistent:!1,contentID:"securityDashboard",scrollParent:C,filter:{multiSelect:!1,showEmptyGroups:!1},buildOptions:{allowDrag:!1,multiSelect:!1,stickyFolders:!1},title:Strings.translateString("Security Dashboard")});Ce.show=function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():(Pe.prototype.show.call(this),reduxApp.navigate("/vault/security"))},Ce.hide=function(){Pe.prototype.hide.call(this),reduxApp.navigate("/vault")};var Ae=new Pe({bodyState:"reactMainView",scrollParent:C});Ae.show=function(){Pe.prototype.show.call(this),reduxApp.navigate("/vault/import-passwords")},Ae.hide=function(){Pe.prototype.hide.call(this),reduxApp.navigate("/vault")};var De=new be({containerType:IndividualShareContainer,sortOptions:f,menuElement:$("#receivedSharesMenuItem"),contentID:"receivedSharesContent",bodyState:"receivedShares",scrollParent:C,persistent:!1,notificationCount:function(){return bg.get("g_pendings").length},searchPlaceholder:Strings.translateString("search my received shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},title:Strings.translateString("Shared with Me"),addMenu:[b.ShareItems],dataFunction:(Me=function(e){for(var t=LPProxy.getAllModelItems(),i=[],n=0,o=t.length;n<o;++n){var r=t[n],a=e[r.getID()];a&&"1"===a.state&&r instanceof AccountBase&&i.push(new AcceptedReceivedSharedItem(r,a))}return i},ke=function(e){for(var t=LPProxy.getPendingRecievedShares(),i=!1,n=0,o=t.length;n<o;++n){var r=t[n],a=e[r._model.getID()];a?r._model._shareData=a:i=!0}return i&&LPProxy.refreshSites(),t},Be=function(e,t,i){var n=Me(e),o=ke(e);t(n.concat(o))},function(t,i){this.makeDataRequest(LPProxy.getReceivedShareData,{params:{url:document.location.href},success:function(e){Be(e,t,i)}})})}),Me,ke,Be,Oe=new be({containerType:IndividualShareContainer,sortOptions:m,menuElement:$("#sentSharesMenuItem"),contentID:"sentSharesContent",bodyState:"sentShares",scrollParent:C,persistent:!1,searchPlaceholder:Strings.translateString("search my sent shares"),buildOptions:{multiSelect:!1},filter:{showEmptyGroups:!1,multiSelect:!1},title:Strings.translateString("Shared with Others"),addMenu:[b.ShareItems],dataFunction:($e=function(e,t,i){for(var n=LPProxy.getAllModelItems(),o=[],r=0,a=n.length;r<a;++r){var s=n[r];o=o.concat(LPTools.buildSentShareItems(s,e[s.getID()]))}t(o,i)},function(t,i){this.makeDataRequest(LPProxy.getSentShareData,{params:{},success:function(e){$e(e,t,i)}})})}),$e,Re=new be({containerType:SharedFolderContainer,dataFunction:(Ve=function(e,t,i){for(var n=LPProxy.getAllSharedGroupModelsByID(),o=[],r=0,a=e.length;r<a;++r){var s=e[r];if(s.sharedata){var l=n[s.shareid];o.push(new SharedFolderItem(l,s))}}t(o)},function(t,i){this.makeDataRequest(LPProxy.getSharedFolderData,{params:{},success:function(e){Ve(e,t,i)}})}),notificationCount:function(){return bg.get("g_pending_shares").length},sortOptions:y,menuElement:$("#sharedFoldersMenuItem"),contentID:"sharedFoldersContent",bodyState:"sharedFolders",scrollParent:C,searchPlaceholder:Strings.translateString("search my shared folders"),buildOptions:{multiSelect:!1},title:Strings.translateString("Shared Folders"),addMenu:[b.SharedFolder],additionalOptionButtons:[(Ue=$(LPTools.buildCheckbox(null,{text:Strings.translateString("View Deleted Shared Folders")})),Ue.attr("id","showDeletedSharedFoldersButton"),Ue.addClass("optionButtons"),Ue.bind("click",function(){qt()}),Ue)]}),Ue,Ve;Re.initialize=function(e,t){var i,n;i=this,e=(n=e)?function(){Yt({checkForStateChange:!1}),n()}:function(){Yt({checkForStateChange:!1})},be.prototype.initialize.call(this,e,t)};var Ne=new Se({menuElement:$(".sharingMenuItem"),defaultView:function(){return 0<De.notificationCount()?De:LPProxy.getAccountClass()===Constants.USER_FREE||LPProxy.getAccountClass()===Constants.USER_PREMIUM&&LPProxy.isPremiumAsAPerk()&&!LPProxy.isLegacyPremium()?Oe:LPFeatures.allowSharedFolders()&&0!==bg.get_show_expired_subscription_messaging().daysLeft?Re:De},views:[Re,Oe,De]}),Ge=new Pe({menuElement:$("#newSettingsMenuItem"),bodyState:"newSettings",title:Strings.translateString("Settings"),addMenu:null,scrollParent:$(document.body)}),ze=function(){LPTools.hideContextMenu(fe),fe=null},He=function(e){e.preventDefault(),e.stopPropagation()},We=function(){J.val("")},Ye=function(){ze(),Gt(),Ze(),Qe(),ot()},qe=function(){ye&&ye.clearSelected()},je=function(){We(),qe()},Ke=function(t){return function(e){ze(),ye.setSortOrder(t),d.sort(t),He(e)}},Xe=function(e){if(null!==e){LPTools.removeDOMChildren(X);for(var t=0,i=e.length;t<i;++t){var n=r.createElement("li"),o=e[t];n.textContent=o,LPPlatform.addEventListener(n,"click",Ke(o)),X.appendChild(n)}V.show()}else V.hide()},Je=function(e){if(0<e){var t=Strings.translateString("%d items selected",e);$("#selectedItemCounter").text(t)}},Ze=function(){j.removeClass("selected"),I.hide("fast"),L.hide()},Qe=function(){K.removeClass("selected"),F.hide("fast"),L.hide()},et=function(){j.addClass("selected"),I.show("fast"),L.show()},tt=function(){K.addClass("selected"),F.show("fast"),L.show()},it=function(){A.addClass("open")},nt=function(e){if(!A.hasClass("open")&&0<k.length){A.addClass("open");var t=k[0].querySelectorAll(".focusable-add-menu-item");0<t.length&&t[0].focus()}},ot=function(){A.removeClass("open")},rt=function(e){$(e.relatedTarget).hasClass("focusable-add-menu-item")||ot()},at=function(e,t){var i=LPProxy.getAllItems({identity:e});!bg.Preferences.get("hide_aurora")&&LPFeatures.isPromotionVaultSearchEnabled()&&i.push(st());var n=new GridListContainer(i,{separateItems:!0,separateFavorites:!0,stickyFolders:!0,ignoreFilterOnSearch:!0,keyboardNavigation:!0,stickyFolderParent:r.getElementById("main"),folderStateChange:Ft});for(var o in It(n),Rt(n,ri.all.getSortOrder()),n.initialize(r.getElementById("vaultContent"),C),n.applyFilter(t),ai(n),ri)ri[o].setContainer(n);return n},st=function(){var e=new AuroraGroup({group:"Suggested for You",url:"http://group"}),t=lt(),i=new AuroraGroupDisplay(e,t);return i.collapse(),i},lt=function(){for(var e=[AuroraAccount.prototype.createGoToAssistData.call(),AuroraAccount.prototype.createGoToWebinarData.call()],t=[],i=0;i<e.length;i++)bg.Preferences.get("hide_aurora_"+e[i].auroraId)||t.push(new AuroraAccountDisplay(new AuroraAccount(e[i])));return t},ct=function(){bg.LPServer.jsonRequest({type:"GET",url:"lmiapi/dark-web-monitoring/alert",success:function(e){d.setSecurityDashboardBadgeVisibility(e&&e.length)},error:function(e){d.setSecurityDashboardBadgeVisibility(!1),e&&e.message&&(e.message="Error while querying security dashboard alerts from vault. "+e.message),LPPlatform.logException(e)}})},ut=function(){$("#restrictedVaultContent").is(":hidden")&&($("#restrictedVaultContent").show(),$("#addMenu").hide())},dt=function(){$("#restrictedVaultContent").is(":visible")&&($("#restrictedVaultContent").hide(),$("#addMenu").show())};d.openVaultDeviceLimitDialog=function(){ut(),"block"!==$("#vaultDeviceLimitDialog").css("display")&&(dialogs.vaultDeviceLimitDialog.open(),bg.sendLpImprove("mdpw_user_viewed",{CurrentDevice:"Desktop",Source:"Vault Pop Up",SwitchesLeft:Number(bg.get("g_primary_device_switches_left"))}))},d.openRetrialDialog=function(){"block"!==$("#reTrialDialog").css("display")&&dialogs.reTrialDialog.open()},d.setSecurityDashboardBadgeVisibility=function(e){var t;$(".securityDashboardMenuItem .notificationBubble").toggle(!!e)};var pt=function(){var e=864e5,t=14*e,i=28*e,n=bg.get("g_device_limit_releaseTS");if(bg.get("g_show_device_limit_notification")&&LPProxy.isExpiredFamilyUser()&&reduxApp.getState().settings.features.expired_families_purchase_flow){var o=bg.get("g_uid")+"_deviceLimitNotificationData",r=new Date,a=r,s;try{a=(s=JSON.parse(bg.localStorage_getItem(o))).lastShown}catch(e){console.error("Cannot parse deviceLimitNotification json",bg.localStorage_getItem(o))}n<=r?bg.setDeviceLimitNotification(!1):r!==a?(a<n-i&&r<n-i||n-i<=a&&a<n-t&&n-i<=r&&r<n-t||n-t<=a&&a<n-e&&n-t<=r&&r<n-e||n-e<=a&&a<n&&n-e<=r&&r<n)&&bg.setDeviceLimitNotification(!1):bg.setDeviceLimitNotification(!0)}},gt=void 0===bg.get_method?"undefined":bg.get_method();d.initializeWelcomeDialogs=function(){var o=LPTools.getURLParams(),e=LPProxy.getAccountClass();if(bg.get("g_is_restricted"))d.openVaultDeviceLimitDialog();else{if(bg.get("g_display_premium_retrial_offer")){var t=0,i;!!$("#successMessage .message").text()&&(t=3e3),setTimeout(function(){"undefined"===gt?d.openRetrialDialog():reduxApp&&reduxApp.getState().settings.features.retrialEnabled&&d.openRetrialDialog()},t)}LPFeatures.isDeviceLimitNotificationEnabled()&&LPProxy.isExpiredFamilyUser()&&(bg.setDeviceLimitNotification(!0),pt()),bg.MigrationBackground.getShouldStartMigration(function(e){var t=bg.get_show_expired_subscription_messaging();if(bg.get("g_show_device_limit_notification")&&LPProxy.isExpiredFamilyUser()&&reduxApp.getState().settings.features.expired_families_purchase_flow)dialogs.vaultDeviceLimitNotificationDialog.open();else if(e)bg.MigrationBackground.setShouldStartMigration(!1),yt();else if(bg.get("g_show_billing_address_notification"))dialogs.vaultBillingAddressDialog.open(),bg.sendLpImprove("billing_address_callout_shown",{source:"webvault"});else if(void 0!==t.daysLeft){re.addClass("info-banner-open");var i=Strings.translateString("Renew to retain access to shared folders"),n=Strings.translateString("Renew within %d days to retain access to shared folders and other LastPass Enterprise features.",t.daysLeft);1===t.daysLeft&&(n=Strings.translateString("Renew today to retain access to shared folders and other LastPass Enterprise features.")),0===t.daysLeft&&(i=Strings.translateString("Renew now to access shared folders"),n=Strings.translateString("To leverage the full power of LastPass Enterprise, including shared folders, renew now."),ae.LP_hide()),dialogs.vaultInfoBanner.open({title:i,contentText1:n,dialogClass:"migrationBanner expirationBanner",hideXCloseBtn:!0,buttons:[{style:"btn-gray",sizeStyle:"col-2 btn-container-lg pull-right",autoId:"openEnterprisePaymentPage",text:Strings.translateString("Renew"),action:function(){bg&&bg.openEnterprisePaymentPage&&bg.openEnterprisePaymentPage()}}]})}else if(bg.MigrationBackground.shouldShowMigrationNotification())d.openVaultTakeOverUpdateNotification();else if(LPFeatures.safari_legacy_messaging())dialogs.vaultInfoBanner.open({title:Strings.translateString("Safari extension update required"),contentText1:Strings.translateString("Due to new Apple requirements, you need to download the new LastPass app to continue using LastPass in your Safari browser."),contentText2:Strings.translateString("After download, simply login to your account again and use LastPass in Safari as you always have."),buttons:[{style:"btn-blue",sizeStyle:"col-2 btn-container-lg",autoId:"updateBtn",text:Strings.translateString("Update"),closeOnClick:!0,action:function(){bg&&bg.openURL&&bg.openURL("https://lastpass.com/safariAppExtension.php?source=vault")}},{style:"btn-link",sizeStyle:"col-1 btn-container-sm",autoId:"closeBtn",text:Strings.translateString("Close"),closeOnClick:!0}]});else if("undefined"===gt&&!d.isExtensionDownloaded()&&LPFeatures.allowLicenseExpiration()&&(VaultLicenseExpiration.premiumTrialStatusChecker()||VaultLicenseExpiration.companyLicenseStatusChecker())&&VaultLicenseExpiration.showExpirationMessage());else if("undefined"!==gt||d.isExtensionDownloaded()||!LPFeatures.isDownloadExtensionWebPromptEnabled()||bg.get("g_hasplugin")){if(o&&"openInContextOnboarding"===o.cmd)return;LPPlatform.showIntroTutorial()}else dialogs.vaultInfoBanner.open({title:Strings.translateString("The easy life awaits! Install the LastPass browser extension for the best possible experience."),dialogClass:"migrationBanner",titleSize:"col-8",hideXCloseBtn:!0,segmentEvents:{show:{name:"download_extension_prompt_shown"},download:{name:"download_extension_prompt_clicked",properties:{action:"download"}},learn:{name:"download_extension_prompt_clicked",properties:{action:"learn"}},close:{name:"download_extension_prompt_clicked",properties:{action:"close"}}},buttons:[{style:"btn-link",sizeStyle:"col-2 btn-container-sm pull-right",text:Strings.translateString("Learn More"),action:function(){bg.openURL("https://support.logmeininc.com/lastpass/help/what-is-the-difference-between-my-local-online-and-offline-vaults-lp010104")},segment:"learn"},{style:"btn-gray",sizeStyle:"col-2 btn-container-lg pull-right",autoId:"downloadNowBtn",text:Strings.translateString("Install Now"),action:function(){"object"==typeof top.LP_ExtInstall&&"function"==typeof top.LP_ExtInstall.run?top.LP_ExtInstall.run():bg&&bg.openURL&&bg.openURL("https://lastpass.com/misc_download2.php")},segment:"download"}]}),$("#dialogLoadingOverlay").remove(),$("#dialogLoadingOverlay").removeClass("overlay").addClass("loaded")})}},d.showFormFillMigrationMessage=function(){var e="Please finish the latest update to access your Form Fills information";dialogs.vaultInfoBanner.open({title:Strings.translateString(e),dialogClass:"migrationBanner",segmentEvents:{show:{name:"migration_formfill_notification_shown",properties:{version:"vault",vault_version:"omar"}},update:{name:"migration_formfill_notification_clicked",properties:{action:"update_now",version:"vault",vault_version:"omar"}}},buttons:[{style:"btn-link",sizeStyle:"col-1 btn-container-sm",text:Strings.translateString("Learn More"),action:function(){bg.openURL("https://link.lastpass.com/help-new-form-fills")},segment:"learn"},{style:"btn-gray",sizeStyle:"col-2 btn-container-lg",text:Strings.translateString("Finish the Update"),action:function(){d.startFormFillMigration(gt)},segment:"update"}],hideXCloseBtn:!0})},d.initializeCategoryBackground=function(){if(bg.MigrationBackground.shouldShowMigrationNotification()){document.getElementsByTagName("body")[0].classList.add("vaultCategoryTakeoverOverride");for(var e=[document.getElementById("addressesButton"),document.getElementById("paymentCardsButton"),document.getElementById("bankAccountsButton")],t=["vault_addresses","vault_payment_cards","vault_bank_accounts"],i=0;i<e.length;i++){var n=t[i];e[i].addEventListener("click",function(){bg.sendLpImprove("migration_formfill_notification_clicked",{action:"migrate",version:"vault_takeover",vault_version:"omar",source:n}),d.startFormFillMigration(gt)})}for(var o=[document.getElementById("addresses"),document.getElementById("payment-cards"),document.getElementById("bank-accounts")],r=0;r<o.length;r++){var a=t[r];o[r].addEventListener("click",function(){bg.sendLpImprove("migration_formfill_notification_shown",{version:"vault_takeover",vault_version:"omar",source:a})})}document.getElementById("emptyAddressesWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapper").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyAddressesWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapperMigration").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("addMenuArrow").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("mainScroll").style.height="720px"}else document.getElementById("emptyAddressesWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapper").classList.remove("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyAddressesWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyBankAccountsWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("emptyPaymentCardsWrapperMigration").classList.add("vaultCategoryTakeoverContainerHidden"),document.getElementById("addMenuArrow").classList.remove("vaultCategoryTakeoverContainerHidden")},d.showWelcomeUpdateDialog=function(e){var t="Update to the new LastPass experience. It should only take a minute. You'll be logged out here and taken to LastPass.com to finish. Sorry for the inconvenience, but it only happens once - and it's worth it! Promise.";"cr"!==e&&"ff"!==e&&"undefined"!==e&&"edgecr"!==e||(t="Update to the new LastPass experience. It should only take a minute."),d.showFormFillMigrationMessage()},d.isExtensionDownloaded=function(){return null!==top.ext};var mt=function(){var e=void 0!==top.getLocalOTP?top.getLocalOTP():null;e&&e.otpData&&e.localOtpKey&&LPProxy.setOtpOnWeb(e.localOtpKey,e.otpData)};d.initialize=function(e){try{if(d.handleSubscriptionChange(),/otp\.php/.test(top.location.pathname)||mt(),d.handleShowingNotificationsFromRedux(),bg.sendLpImprove("user_vault_opened"),r.body.removeAttribute("class"),Topics.get(Topics.REFRESH_DATA).publish(),$(".leftMenuItem").removeClass("selected"),LPProxy.getPreference("gridView")||d.displayAsList(),LPProxy.getPreference("compactView")&&d.displayCompact(),H.attr("title","Maximize Menu"),LPFeatures.allowGift()){var t=$("#specialOfferMenu");t.show(),t.bind("click",function(){bg.sendLpImprove("lpgift_ad_clicked"),bg.openURL(LPProxy.getBaseURL()+"gift.php")})}if(VaultLicenseExpiration.initialize(),vt(),ft(),ht(),Pt(),LPFeatures.allowTryFamilies()&&$("#lp-try-families").show(),"undefined"!=typeof bg){var i=LPProxy.getAccountClass();LPFeatures.isVaultPremiumFeatureIndicatorEnabled()||i!==Constants.USER_FREE&&i!==Constants.USER_PREMIUM_TRIAL||bt(),LPFeatures.isFamiliesAsABenefitEnabled()?($("#linkAccountMenuItem").LP_hide(),$("#verifyLinkedAccountMenuItem").LP_hide(),$("#accountBenefitsMenuItem").LP_show(),$("#accountBenefitsMenuItem").unbind("click"),$("#accountBenefitsMenuItem").click(function(){var e=reduxApp.getState().familiesAsABenefit.drawerOpen;reduxApp.toggleFamiliesAsABenefitDrawer(),e?$(this).removeClass("selected"):$(this).addClass("selected")})):$("#accountBenefitsMenuItem").LP_hide()}if(LPFeatures.allowSecurityDashboard()&&!LPProxy.isFreeUser()&&ct(),!LPFeatures.isVaultPremiumFeatureIndicatorEnabled()||LPProxy.getAccountClass()!==Constants.USER_PREMIUM_TRIAL&&LPProxy.getAccountClass()!==Constants.USER_FREE&&LPProxy.getAccountClass()!==Constants.USER_FAMILY_ADMIN||d.initializePremiumFeatureIndicator(),LPFeatures.importWelcomeMessageInVaultEnabled()){q.addClass("vault-import");var n=bg.get("g_username").replace(new RegExp(/(@\w+.*)/),"");$("#emptyVaultWelcomeUsername").text(Strings.translateString("Welcome to LastPass, %s",n)),$("#openImport").click(function(){LPFeatures.importPasswordsInVaultEnabled()?d.openImportPasswords():LPProxy.import("welcome_screen")}),$("#openAddDialog").click(function(){dialogs.addItem.open(),bg.sendLpImprove("import_welcome_screen_click",bg.get("g_prompts").improve?1:0,{option:"add_item_dialog"})})}}catch(e){LPPlatform.logException(e)}finally{var o=$("#vaultLoadingOverlay");LPTools.getOption(e,"fadeIn",!1)?(o.addClass("fadeIn"),setTimeout(function(){o.addClass("loaded")},500)):o.addClass("loaded"),q.addClass("loaded")}};var ft=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(e){e?($("#logoPartner").attr("src",e.logoWhiteUrl).addClass(e.classWhite),$("#logoPartnerContainer").addClass("show")):$("#logoPartnerContainer").removeClass("show")})},yt=function(e){$("#inProgressMigration").show(),bg&&bg.clear_badge&&bg.clear_badge();var i=$("#inProgressMigration").find(".progress-bar");Migrator.executeMigrations(function(e,t){i.css("width",Math.floor(e/t*100)+"%")},!!e)},ht=function(){$("#vaultFooter").addClass("disabled")},Pt=function(){_.attr("aria-label",Strings.translateString("Main header")),x.attr("aria-label",Strings.translateString("Main navigation")),w.attr("aria-label",Strings.translateString("Vault options")),T.attr("aria-label",Strings.translateString("Main content")),D.attr("aria-label",Strings.translateString("New item"))},bt=function(){$("#upgradeButton").addClass("headerButtonActive").click(function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Vault Upgrade Button"):(bg.sendLpImprove("upgrade_button_vault_click"),LPPlatform.purchasePremium())})},vt=(St=function(t){d.openReceivedShareCenter(function(){var e=LPProxy.getPendingRecievedShare(t);e&&d.openAcceptShareDialog(e)})},Lt=function(t){d.openReceivedShareCenter(function(){var e=LPProxy.getPendingRecievedShare(t);e&&e.reject()})},Et=function(e){LPProxy.getSiteModel(e)?d.openSiteDialog({vaultItem:e}):LPProxy.getNoteModel(e)?d.openNoteDialog({vaultItem:e}):LPProxy.getFormFillModel(e)&&d.openFormFillDialog({vaultItem:e})},_t=function(e){switch(e){case"emergencyAccess":Ie.show();break;case"emergencyAccessOthers":Fe.show();break;default:ri.all.show()}},xt=function(){d.openManageIdentities(),d.openIdentityDialog()},Tt=function(e){for(var t=[],i=0,n=(e=e.split(",")).length;i<n;++i){var o=e[i],r=LPProxy.getSiteModel(o);(r=r||LPProxy.getNoteModel(o))&&t.push(r)}0<t.length&&d.openShareDialog(t)},function(){var e=LPTools.getURLParams();for(var t in LPPlatform.setIntroTutorialDisable(!1),e){var i=e[t];switch("cmd"===t&&(t=i),0!==t.indexOf("openweakpws:")&&0!==t.indexOf("openduppws:")||d.openSecurityDashboard(),t){case"opengoogleauth":case"opensettings":Topics.get(Topics.EDIT_SETTINGS).publish();break;case"openhistory":LPProxy.openHistory();break;case"openbookmarklets":LPProxy.openBookmarklets();break;case"linkpersonal":d.openLinkAccountDialog();break;case"unlinkpersonal":d.unlinkAccount();break;case"sharedfolder":case"sf":d.openSharingCenter();break;case"sfadd":d.openSharingCenter(),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Direct Link"):d.openCreateSharedFolderDialog();break;case"sfadduser":if(d.openSharingCenter(),!e.shareid)break;var n=LPProxy.getAllSharedGroupModelsByID()[e.shareid];n&&Topics.get(Topics.EDIT_SHARED_FOLDER).publish(n);break;case"sfaddsite":if(d.openSharingCenter(),!e.shareid)break;(n=LPProxy.getAllSharedGroupModelsByID()[e.shareid])&&n._shareInfo.name&&d.openSiteDialog({saveOptions:{source:"vault"},defaultData:{group:"Shared-"+n._shareInfo.name}});break;case"addidentity":xt();break;case"showdeleted":d.openDeletedItems();break;case"viewcreditmon":d.openCreditMonitoring();break;case"share":Tt(i);break;case"ffid":case"edit":Et(i);break;case"acceptshare":St(i);break;case"rejectshare":Lt(i);break;case"omsstart":LPPlatform.setIntroTutorialDisable(!0);break;case"openadvancedoptions":et();break;case"opendashboard":d.openSecurityDashboard();break;case"openInContextOnboarding":var o=LPProxy.getPreference("ShowIntroTutorialLater");if(o&&Date.now()<new Date(o))return;dialogs.inContextTutorialWelcome.open();break;case"openemergencyaccess":d.openEmergencyAccess();break;case"showretrialoffer":LPProxy.isFreeUser()&&!bg.get("g_display_premium_retrial_offer")&&bg.getRetrialOfferDeepLinkEnabled(d.openRetrialDialog);break;case"showfamilyexpiredpurchase":reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()&&reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Direct Link");break;case"import":reduxApp&&LPFeatures.importPasswordsInVaultEnabled()?d.openImportPasswords():LPProxy.import("advanced_options")}}null===ye&&_t(e.view)}),St,Lt,Et,_t,xt,Tt,It=function(e){var t=LPPlatform.getOpenGroups();if(null!==t){for(var i=!0,n=e.getAllSubGroupsIncludingFavorites(!0),o=0,r=n.length;o<r;++o){var a=n[o];t[a._model.getName()]?(a.expand(),i=!1):a.collapse()}i&&Topics.get(Topics.ALL_COLLAPSED).publish()}},Ft=function(e){if(e){for(var t=e.getAllSubGroupsIncludingFavorites(!0),i=[],n=0,o=t.length;n<o;++n){var r=t[n];r.isExpanded()&&i.push(r._model.getName())}LPPlatform.setOpenGroups(i)}},wt=function(e,t,i){var n=r.getElementById("sharedFoldersMenuItem").parentElement;e===Constants.USER_FREE?($("#emptySharedFoldersIcon .tourText").append(LPTools.createElement("a",{class:"nbtn rbtn dynamicWidth",href:LPProxy.getBaseURL()+"go-premium",target:"_blank"},Strings.translateString("Upgrade to Premium"))),n.parentElement.appendChild(n)):e===Constants.USER_PREMIUM&&t&&!i&&$("#sharedFoldersMenuItem").remove(),$(n.parentElement).children().last().addClass("last")},Ct=function(e){var t=$(".securityScore");t.text(null!==e?Math.round(e)+"%":""),void 0!==e?t.parents(".menuIcon").addClass("score"):t.parents(".menuIcon").removeClass("score")};d.toggleInProgressOverlay=function(){E.toggle()};var At=function(e,t){0<t?(e.text(t),e.show()):e.hide()},Dt=(Mt=!1,function(){if(!Mt)for(var e=LPProxy.getEmergencyAccessRecipientModels(),t=0,i=e.length;t<i;++t){var n=e[t];if(n.allowedAccess()||n.hasRequestedAccess()){dialogs.denyEmergencyAccess.open({sharee:n}),Mt=!0;break}}}),Mt;d.openVault=function(){ri.all.show()},d.openNotes=function(){ri.notes.show()},d.openPaymentCards=function(){ri["payment-cards"].show()},d.openAddresses=function(){ri.addresses.show()},d.openFormFills=function(){ri.formFill.show()},d.toggleAdvancedMenu=function(e){K.is(":visible")&&Qe(),I.is(":visible")?Ze():(d.closeFaaB(e),et()),He(e)},d.toggleHelpMenu=function(e){j.is(":visible")&&Ze(),F.is(":visible")?Qe():(d.closeFaaB(e),tt()),He(e)},d.clear=function(){S&&(S.destruct(),S=null),$(r.body).addClass("loggedout"),LPPlatform.shouldShowVaultLoginButton()&&$(r.body).addClass(LPPlatform.canBackgroundOpenPopover()?"canopenpopover":"cannotopenpopover"),$("#vaultLoadingOverlay").removeClass("loaded fadeIn"),je(),fe=me=pe=de=ye=null},d.maximizeLeftMenu=function(){q.addClass("maximized"),H.addClass("opened"),H.attr("title",Strings.translateString("Minimize")),setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)},d.minimizeLeftMenu=function(){q.removeClass("maximized"),H.removeClass("opened"),H.attr("title",Strings.translateString("Maximize")),setTimeout(Topics.get(Topics.VAULT_LEFT_MENU_TOGGLE).publish,400)},d.toggleLeftMenu=function(){var e=!q.hasClass("maximized");LPProxy.setPreferences("leftMenuMaximize",e),e?d.maximizeLeftMenu():d.minimizeLeftMenu()},d.addSource=function(e){return e?e.saveOptions&&e.saveOptions.source||(e.saveOptions={source:"vault"}):e={saveOptions:{source:"vault"}},e},d.openSiteDialog=function(e){dialogs.site.open(d.addSource(e));var i=function(){""==$("#siteDialogTotp").val()?($("#siteDialogDeleteTotpSecret").hide(),$("#siteDialogAddTotpSecret").show()):($("#siteDialogDeleteTotpSecret").show(),$("#siteDialogAddTotpSecret").hide())},t;function n(e,t){setTimeout(i,e)}[0,500,1e3].forEach(n)},d.openNoteDialog=function(e){dialogs.note.open(d.addSource(e))},d.openAddItemDialog=function(){dialogs.addItem.open()},d.openFormFillDialog=function(e){dialogs.formFill.open(d.addSource(e))},d.openFolderDialog=function(e,t){dialogs.folder.open({vaultItem:e,defaultData:{groupParent:t?t.getName():""},groups:me.getAllSubGroups()})},d.openTryFamiliesDialog=function(e,t){e=e||!1;var i=t?{origin:t}:{};bg.sendLpImprove("try_families_lightbox_shown",i),dialogs.tryFamilies.open({forceAccepted:e})},d.openUpgradeFamiliesForFolderSharingDialog=function(e){var t={forceAccepted:e||!1};bg.sendLpImprove("shared_folder_families_lightbox_shown"),dialogs.upgradeFamiliesForFolderSharing.open(t)},d.openFamiliesInvitationDialog=function(t){LPProxy.getFamiliesInvitations({params:{},success:function(e){0<e.length?(e.sort(function(e,t){return new Date(t.date)-new Date(e.date)}),dialogs.familiesInvitation.open({invitations:e,callback:t})):t(!1)},error:function(){t(!1)}})};var kt=function(){var e=LPProxy.getAccountClass();return e===Constants.USER_FREE||e===Constants.USER_PREMIUM_TRIAL||e===Constants.USER_PREMIUM},Bt=function(){var e=bg.localStorage_getItem("lp_families_dialog_snooze_timestamp"),t=bg.localStorage_getItem("lp_families_dialog_snooze_count"),i,n;return e&&parseInt(e)>Date.now()&&(t&&"1"===t)},Ot=function(){var e=bg.localStorage_getItem("lp_try_families_dialog_declined"),t=bg.localStorage_getItem("lp_families_dialog_snooze_count"),i=t&&1<parseInt(t);return e||i},$t;d.openCreateSharedFolderDialog=function(e,t){!LPProxy.isLegacyPremium()&&kt()&&LPFeatures.allowTryFamilies()&&!LPProxy.isFamiliesTrialStarted()&&LPFeatures.isVaultPremiumPopupsEnabled()?d.showVaultUpgradeToPremiumDialog("sharing"):!LPProxy.isLegacyPremium()&&kt()&&LPFeatures.allowTryFamilies()&&!LPProxy.isFamiliesTrialStarted()?d.openUpgradeFamiliesForFolderSharingDialog(!1):LPProxy.isFamilyUser()&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({group:e,children:t}):LPFeatures.isVaultPremiumPopupsEnabled()&&LPProxy.getAccountClass()===Constants.USER_FREE?d.showVaultUpgradeToPremiumDialog("sharing"):LPProxy.getAccountClass()===Constants.USER_FREE?(bg.sendLpImprove("upgrade_to_premium_lightbox_shown"),dialogs.upgradePremium.open({upgradeText:[LPTools.createElement("h1","upgradeDialogHeader",Strings.translateString("Need to share passwords with family or friends?")),LPTools.createElement("p","dialogText",Strings.translateString("Go Premium now to create a Shared Folder, invite family or friends, and fill the folder with passwords and notes. Give up to 5 people access to the Shared Folder. Changes are synced automatically, and you can assign read-only access. Go Premium now to create a Shared Folder!"))]})):dialogs.createSharedFolder.open({group:e,children:t})},d.openSettingsDialog=function(){null===de&&(AccountSettingsService.call(function(e){de=e,d.openSettingsDialog()},function(){Notifications.displayErrorMessage("Could not retrieve account settings!")}),Topics.get(Topics.DIALOG_LOADING).publish()),dialogs.settings.open(de)},d.openLinkAccountDialog=function(){LPProxy.callAcctsIFrameCommand("linkpersonal")},d.openVerifyLinkedAccountDialog=function(){LPProxy.callAcctsIFrameCommand("verifypersonal")},d.unlinkAccount=function(){var e=LPProxy.getLinkedAccount();e&&LPProxy.reprompt(function(){e.unlink()})},d.toggleCollapseAll=($t=!1,Topics.get(Topics.ALL_COLLAPSED).subscribe(function(){$t=!0,R.addClass("selected"),R.attr("title",Strings.Vault.EXPAND_ALL)}),Topics.get(Topics.ALL_EXPANDED).subscribe(function(){$t=!1,R.removeClass("selected"),R.attr("title",Strings.Vault.COLLAPSE_ALL)}),function(){$t?(Topics.get(Topics.EXPAND_ALL).publish(),Topics.get(Topics.ALL_EXPANDED).publish()):(Topics.get(Topics.COLLAPSE_ALL).publish(),Topics.get(Topics.ALL_COLLAPSED).publish())}),d.toggleSize=(d.displayLarge=function(){Topics.get(Topics.DISPLAY_LARGE).publish(),U.removeClass("selected"),U.attr("title",Strings.Vault.COMPACT_VIEW)},d.displayCompact=function(){Topics.get(Topics.DISPLAY_COMPACT).publish(),U.addClass("selected"),U.attr("title",Strings.Vault.LARGE_VIEW)},function(){LPProxy.getPreference("compactView")?(d.displayCompact(),bg.lpevent(ge?"v_grd_cmp":"v_lst_cmp")):(d.displayLarge(),bg.lpevent(ge?"v_grd_lrg":"v_lst_lrg"))}),d.displayAsGrid=function(){Topics.get(Topics.DISPLAY_GRID).publish(),B.addClass("selected"),O.removeClass("selected"),ge=!0},d.displayAsList=function(){Topics.get(Topics.DISPLAY_LIST).publish(),O.addClass("selected"),B.removeClass("selected"),ge=!1},d.search=function(e){ye&&ye.search(e)};var Rt=function(e,t){switch(t){case a:e.sortByName(!0);break;case s:e.sortByName(!1);break;case i:e.sortByFolder(!0);break;case n:e.sortByFolder(!1);break;case l:e.sortItemsByMostRecent();break;case c:case p:e.sortByEmail(!0);break;case u:case g:e.sortByEmail(!1)}};d.sort=function(e){G.text(e),Rt(ye.getContainer(),e)};var Ut=function(e){N.toggle("fast"),fe=N,LPTools.addKeyBoardNavigation(X.children),He(e)},Vt=function(e){if(null===fe||fe.get(0).parentElement!==Y){var t=ye.createSelectionContextMenu();Y.appendChild(t),t.removeAttribute("style"),(fe=$(t)).show("fast")}else ze();He(e)};d.showMoreOptionsMenu=function(){W.show("fast")},d.hideMoreOptionsMenu=function(){W.hide("fast")};var Nt=function(e){Z.toggleClass("selected"),z.toggle("fast"),He(e),d.closeFaaB(e)},Gt=function(){z.hide("fast"),Z.removeClass("selected")};d.openEmergencyAccess=function(){we.show()},d.openEmergencyAccessTrusted=function(){we.show(Ie)},d.openEmergencyAccessTrusting=function(){we.show(Fe)},d.openRestrictedEmergencyAccess=function(){dialogs.restrictedEmergencyAccess.open()},d.openVaultTakeOverUpdateNotification=function(){dialogs.vaultTakeoverUpdateNotification.open()},d.startFormFillMigration=function(e){"cr"===e||"ff"===e||"undefined"===e||"edgecr"===e?(bg.MigrationBackground.setShouldStartMigration(!1),yt()):(bg.openURL("https://lastpass.com/experience-update"),bg.lpevent("m_lo"),bg.loggedOut(!1,"menu"))},d.openSecurityDashboard=function(){Ce.show()},d.openSharingCenter=function(e){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():Ne.show()},d.openReceivedShareCenter=function(e){Ne.show(De,e)},d.openSentShareCenter=function(e){Ne.show(Oe,e)};var zt=!(d.openSharedFolderCenter=function(e){Ne.show(Re,e)}),Ht=function(e){Re.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(e){return!e._model.isDeleted()}},e),zt=!1},Wt=function(e){Re.getContainer().applyFilter({showEmptyGroups:!1,multiSelect:!1,func:function(e){return!0}},e),zt=!0},Yt=function(e){zt?Wt(e):Ht(e)},qt=function(){zt?Ht():Wt()};function jt(t){if(t){var e=le.findIndex(function(e){return e===t.id});-1<e&&$("#"+le[e]).blur(),-1<e&&e<le.length-1?$("#"+le[e+1]).focus():$("#"+le[0]).focus()}else $("#"+le[0]).focus()}d.openAcceptShareDialog=function(e){dialogs.acceptShare.open({vaultItem:e,groups:me.getAllSubGroups()})},d.openShareDialog=function(e){LPTools.openShareDialog(e)},d.openSharedFolderDialog=function(e,t){LPProxy.isFamilyUser()&&e._shareInfo.cid!==Constants.UNAFFILIATED_COMPANY_ID&&bg.get("LPContentScriptFeatures").family_shared_folders_enabled?dialogs.familiesSharedFolder.open({folder:e,members:t}):dialogs.sharedFolder.open(e,t)},d.openSharedFolderAccessDialog=function(e){dialogs.sharedfolderAccess.open(e)},d.openAddTotpDialog=function(){dialogs.addTotpDialog.open()},d.openRestrictedSharingDialog=function(){dialogs.restrictedSharing.open()},d.closeShareDialog=function(){dialogs.share.close(!0)},d.openManageIdentities=function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():Le.show()},d.openIdentityDialog=function(e){dialogs.identity.open(e)},d.enableIdentity=function(e){null!==pe&&pe!==e&&(pe.disable(),LPProxy.enableIdentity(e)),pe=e;var t=me?me._filter:null;null!==me&&(Ft(me),me.destruct()),me=at(pe,t)},d.openCreditMonitoring=function(e){(LPProxy.isFreeUser()||LPProxy.isExpiredUser()||-1!=navigator.userAgent.indexOf(" Edge/"))&&!Kt||Ee.show()},d.openCreateCreditMonitoringDialog=function(){dialogs.createCreditMonitoring.open()},d.openDeletedItems=function(e){xe.show()},d.openImportPasswords=function(){Ae.show(),bg.sendLpImprove("import_welcome_screen_click",bg.get("g_prompts").improve?1:0,{option:"import"})},d.showAdPane=function(){var e;if(void 0!==bg.is_edge?bg.is_edge():-1!==navigator.userAgent.indexOf(" Edge/"))return!1;var t=bg.get("g_prompts").improve?1:0,i=r.getElementById("ad"),n=r.createElement("iframe");n.setAttribute("src",o.getPartnerURL(LPProxy.getBaseURL()+"ads.php?nobr=1&noga=1&rand="+Math.floor(1e3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+t),n.setAttribute("sandbox","allow-scripts allow-same-origin allow-popups"),i.appendChild(n),q.addClass("freeUser"),setInterval(function(){n.setAttribute("src",o.getPartnerURL(LPProxy.getBaseURL()+"ads.php?v=4.0&nobr=1&noga=1&rand="+Math.floor(1e3*Math.random())+"&v="+LPProxy.getVersion())+"&g_lpImprove="+t)},3e5)},q.bind("click",function(){Ye()}),$("#vault").bind("click",function(){qe(),Ye()}),$(x,_).bind("click",function(e){d.closeFaaB(e)}),$(_).bind("click",function(e){d.closeFaaB(e)}),$("#loginButton").bind("click",function(){bg.open_login()}),$("#skip-to-search").keydown(function(e){13!==e.keyCode&&32!==e.keyCode||($("#vaultSearch").focus(),e.preventDefault(),e.stopPropagation())}),$("#skip-to-vault").keydown(function(e){13!==e.keyCode&&32!==e.keyCode||($("#vaultContent").focus(),e.preventDefault(),e.stopPropagation())}),$("#skip-to-add-item").keydown(function(e){13!==e.keyCode&&32!==e.keyCode||($("#addMenuButtonDefault").focus(),e.preventDefault(),e.stopPropagation())}),q.bind("keydown",function(e){if(0===Dialog.prototype.getDialogCount()||"introTourDialog"===Dialog.prototype.getCurrentDialog().element.id){var t=e.keyCode||e.which,i=document.activeElement;117===t?(e.preventDefault(),jt(i)):9===t&&i&&"header"===i.id&&$("#search").children(".searchWrapper")[0].focus()}}),LPPlatform.addEventListener(window,"unload",function(){Topics.get(Topics.CLEAR_DATA).publish()}),J.LP_addSearchHandlers("inputLight",function(e){d.search(e)}),J.bind("keydown",function(e){var t;if(40===(e.keyCode||e.which)){var i=ye.getContainer();if(i){var n=i.getAllChildrenOrdered();0<n.length&&(n[0].focus(),e.preventDefault(),e.stopPropagation())}}}),$("#orderOption").bind("click",Ut),$("#actions").bind("click",Vt),$(".sharingMenuItem").bind("click",function(){var e;bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():(bg.sendLpImprove("sharing_center_vault_click"),!LPProxy.isLegacyPremium()&&kt()&&LPFeatures.allowTryFamilies()&&!Ot()&&!Bt()&&LPProxy.isFamiliesTrialStarted()&&d.openTryFamiliesDialog(!1,"sharing_menu_item"),d.openSharingCenter())}),j.bind("click",d.toggleAdvancedMenu),K.bind("click",d.toggleHelpMenu),L.bind("click",Ze),L.bind("click",Qe),H.bind("click",d.toggleLeftMenu),LPPlatform.addEventListener(r.getElementById("settingsMenuItem"),"click",function(){Topics.get(Topics.EDIT_SETTINGS).publish({source:"sidebar"})}),$("#linkAccountMenuItem").bind("click",function(){d.openLinkAccountDialog()}),$("#verifyLinkedAccountMenuItem").bind("click",function(){d.openVerifyLinkedAccountDialog()}),I.on("click",".toolsMenuItem",Ze),F.on("click",".toolsMenuItem",Qe),bg.get("g_is_restricted")||(A.bind("mouseenter",it),A.bind("mouseleave",ot),A.bind("touchstart",function(e){A.unbind("mousenter"),A.unbind("mouseleave"),A.hasClass("open")||(it(),e.preventDefault())})),se.bind("focus",nt),se.bind("blur",rt);var Kt=bg.get("g_has_credit_monitoring_premium");if(LPPlatform.addEventListener(r.getElementById("collapseAllToggle"),"click",function(){d.toggleCollapseAll()}),LPPlatform.addEventListener(r.getElementById("sizeToggle"),"click",function(){LPProxy.setPreferences("compactView",!LPProxy.getPreference("compactView")),d.toggleSize()}),LPPlatform.addEventListener(r.getElementById("gridButton"),"click",function(){d.displayAsGrid(),LPProxy.setPreferences("gridView",!0)}),LPPlatform.addEventListener(r.getElementById("listButton"),"click",function(){d.displayAsList(),LPProxy.setPreferences("gridView",!1)}),LPPlatform.addEventListener(r.getElementById("userMenuContainer"),"click",Nt),LPPlatform.addEventListener(r.getElementById("manageIdentitiesMenuItem"),"click",function(){d.openManageIdentities()}),LPPlatform.addEventListener(r.getElementById("creditMonitoringMenuItem"),"click",function(){bg.get("g_is_restricted")&&!Kt?d.openVaultDeviceLimitDialog():d.openCreditMonitoring()}),!LPProxy.isFreeUser()&&!LPProxy.isExpiredUser()&&-1==navigator.userAgent.indexOf(" Edge/")||Kt||$("#creditMonitoringMenuItem").remove(),LPPlatform.addEventListener(r.getElementById("openTourMenuItem"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():LPPlatform.openTour(!0)}),$(".toolsMenuItem").click(function(){var e=$(this).attr("tracking-event");e&&bg.sendLpImprove("vaultnav"+e.toLowerCase(),{source:"Vault"})}),LPPlatform.addEventListener(r.getElementById("toolsImport"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():LPFeatures.importPasswordsInVaultEnabled()?d.openImportPasswords():LPProxy.import("advanced_options")}),LPPlatform.addEventListener(r.getElementById("toolsExport"),"click",function(){LPProxy.export()}),LPPlatform.addEventListener(r.getElementById("toolsOpenFavorites"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():LPProxy.openAllFavorites("vault")}),LPPlatform.addEventListener(r.getElementById("otpMenuItem"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():$(this).attr("href",bg.get("base_url")+"otp.php")}),LPPlatform.addEventListener(r.getElementById("historyMenuItem"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():LPProxy.openHistory()}),LPPlatform.addEventListener(r.getElementById("deletedMenuItem"),"click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():d.openDeletedItems()}),LPPlatform.addEventListener(r.getElementById("generateSharingKeys"),"click",function(){bg.lpevent("v_gsk"),dialogs.sharingKey.open()}),$("#generateSharingKeys").hide(),LPPlatform.addEventListener(r.getElementById("featureManager"),"click",function(){bg.openURL(window.location.origin+"/lastpass/index.html#/feature-manager")}),LPPlatform.addEventListener(r.getElementById("generatePasswordMenuItem"),"click",function(){var e;bg.lpevent("v_gpw"),(bg.get("LPContentScriptFeatures").better_generate_password_enabled?dialogs.betterGeneratePassword:dialogs.generatePassword).open({fillGenerated:!1,saveOptions:{source:"vault"}})}),$("#removedLinkedAccountMenuItem").bind("click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():d.unlinkAccount()}),$("#tryEnterprise").bind("click",function(){dialogs.enterpriseTrial.open()}),$("#emergencyAccessMenuItem").bind("click",function(){if(reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser())reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Emergency Access");else if(bg.get("g_is_restricted"))d.openVaultDeviceLimitDialog();else{var e=0<bg.get("g_emer_sharers").length||0<bg.get("g_emer_sharees").length;LPFeatures.isVaultPremiumPopupsEnabled()&&LPProxy.getAccountClass()===Constants.USER_FAMILY_ADMIN&&LPProxy.isExpiredUser()?d.showVaultUpgradeToPremiumDialog("emergency_access_families"):LPFeatures.isVaultPremiumPopupsEnabled()&&(LPProxy.isFreeUser()||LPProxy.isExpiredUser())&&!e?d.showVaultUpgradeToPremiumDialog("emergency_access"):!LPProxy.isFreeUser()&&!LPProxy.isExpiredUser()||e?(bg.sendLpImprove("emergency_access_vault_click"),d.openEmergencyAccess()):(bg.sendLpImprove("restricted_emergency_access_lightbox_shown"),d.openRestrictedEmergencyAccess())}}),$(".securityMenuItem").bind("click",function(){bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():(bg.lpevent("v_sec"),bg.openseccheck())}),$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("v_oec"),bg.openentconsole()}),$("#more-options-refer-a-friend").bind("click",function(){bg.sendLpImprove("refer_a_friend_more_options_click")}),$("#advanced-options-go-premium").bind("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Vault Menu Upgrade"):(bg.sendLpImprove("go_premium_more_options_vault_click"),LPPlatform.purchasePremium())}),oe.bind("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Manage Family Menu Item"):(bg.lpevent("v_ofc"),bg.openFamilyConsole(),bg.sendLpImprove("families_manage_families_click"))}),$("#lp-try-families").bind("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Try Family Menu Item"):kt()&&LPFeatures.allowTryFamilies()&&d.openTryFamiliesDialog(!1,"try_families_submenu_item")}),LPFeatures.isPromotionVaultSidebarG2aEnabled()||LPFeatures.isPromotionVaultSidebarG2wEnabled()||LPFeatures.isPromotionVaultSidebarG2mVariantAEnabled()||LPFeatures.isPromotionVaultSidebarG2mVariantBEnabled()){var Xt=LPFeatures.isPromotionVaultSidebarG2mVariantAEnabled()?"g2ma":LPFeatures.isPromotionVaultSidebarG2mVariantBEnabled()?"g2mb":LPFeatures.isPromotionVaultSidebarG2aEnabled()?"g2a":"g2w",Jt=AuroraAccount.products[Xt],Zt=$("#promotionMenuItem");bg.sendLpImprove("promotion_vault_menu_item_shown",{recommendedProduct:Jt.productId,promotionText:Jt.promotionText}),$(".freeTrialTag").css("display",Jt.freeTrialTagDisplay),$(".menuIcon").addClass(Jt.icon),Zt.LP_show().prop("title",Jt.tooltip).on("click",function(){bg.BackgroundServer.aurora.getOneClickSignupUrls({success:function(e){if(e&&e[Xt]){var t=bg.localStorage_getItem("promotion_"+Jt.productId+"_clicked_"+bg.get("g_username_hash"));bg.sendLpImprove("promotion_vault_menu_item_clicked",{recommendedProduct:Jt.productId,promotionText:Jt.promotionText,promotionLink:t?"login":"signup"});var i=t?e[Xt].login:e[Xt].signup,n=function(){bg.localStorage_setItem("promotion_"+Jt.productId+"_clicked_"+bg.get("g_username_hash"),1),t||(new Account).addFromDialog({name:Jt.name,url:e[Xt].login},null,{success:function(){return null}}),bg.openURL(i)};"g2m"===Jt.productId&&LPFeatures.isPromotionPromptEmailVerifyEnabled()?Qt(n,Xt):n()}}})}).find(".menuText").text(Jt.promotionText)}var Qt=function(t,i){bg.LPServer.jsonRequest({url:"lmiapi/users/me/shouldverifyemail",type:"GET",success:function(e){e.shouldVerifyEmail?(bg.sendLpImprove("promotion_email_verification_required"),dialogs.confirmation.open({title:Strings.translateString("Verify Email"),text:Strings.translateString("Please verify your email before signing up for your GoToMeeting trial."),nextButtonText:Strings.translateString("Send Verification Email"),backButtonText:Strings.Vault.CANCEL,handler:function(){bg.LPServer.jsonRequest({url:"/settings.php",type:"POST",data:{testemail:1,email:bg.get("g_username"),extra:"verifypromotion",product:i},success:function(){bg.sendLpImprove("promotion_email_verification_email_sent"),dialogs.alert.open({title:Strings.translateString("Success!"),text:Strings.translateString("Please check your email for the verification message (it may have gone to your spam folder).")})},error:function(){dialogs.alert.open({title:Strings.translateString("ERROR"),text:Strings.translateString("There was an error sending your verification email.")})}})}})):t()},error:function(){dialogs.alert.open({title:Strings.translateString("ERROR"),text:Strings.translateString("There was an error connecting with the verification service.")})}})},ei;if(Topics.get(Topics.ITEMS_DESELECTED).subscribe(function(){d.hideMoreOptionsMenu()}),Topics.get(Topics.ITEMS_SELECTED).subscribe(function(){d.showMoreOptionsMenu()}),Topics.get(Topics.SELECT_COUNT_CHANGE).subscribe(function(e){Je(e)}),Topics.get(Topics.CONTEXT_MENU).subscribe(function(e,t){t.parentElement!==r.body&&r.body.appendChild(t),fe=LPTools.displayContextMenu(e,t)}),Topics.get(Topics.CONTEXT_CLOSE).subscribe(function(){ze()}),Topics.get(Topics.ITEM_SHARE).subscribe(function(e){d.openShareDialog(e)}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){d.enableIdentity(e),ai(me)}),Topics.get(Topics.CLEAR_DATA).subscribe(function(){d.clear(),Dialog.prototype.closeAllDialogs(!0),bg.closeSettingsIframe()}),Topics.get(Topics.LOGIN).subscribe(function(e){li(),d.initialize(e),Dialog.prototype.closeAllDialogs(!0),d.initializeWelcomeDialogs(),d.initializeCategoryBackground()}),Topics.get(Topics.REQUEST_SUCCESS).subscribe(function(e){LPTools.getOption(e,"incrementAccountsVersion",!1)&&qe()}),ei=function(e,t,i){je(),me.addChild(e.newDisplayObject(),t,i),ai(me)},Topics.get(Topics.SITE_ADDED).subscribe(ei),Topics.get(Topics.NOTE_ADDED).subscribe(ei),Topics.get(Topics.FORM_FILL_ADDED).subscribe(ei),Topics.get(Topics.APPLICATION_ADDED).subscribe(ei),Topics.get(Topics.ITEM_REMOVED).subscribe(function(){ai(me)}),Topics.get(Topics.EDIT_SHARED_FOLDER_ACCESS).subscribe(function(e){d.openSharedFolderAccessDialog(e)}),Topics.get(Topics.EDIT_SITE).subscribe(function(e){d.openSiteDialog(e)}),Topics.get(Topics.EDIT_NOTE).subscribe(function(e){d.openNoteDialog(e)}),Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(e){d.openFormFillDialog(e)}),Topics.get(Topics.EDIT_APPLICATION).subscribe(function(e){dialogs.application.open(e)}),Topics.get(Topics.EDIT_SETTINGS).subscribe(function(e){bg.sendLpImprove("viewvaultsettings",{source:e&&e.source?e.source:""}),params={},bg.get("gRecovery")&&(params.recovery=bg.get("gRecovery")),e&&e.defaulttab&&(params.defaulttab=e.defaulttab),LPProxy.callAcctsIFrameCommand("settings",null,params)}),Topics.get(Topics.EDIT_IDENTITY).subscribe(function(e){d.openIdentityDialog(e)}),Topics.get(Topics.ACCEPT_SHARE).subscribe(function(e){d.openAcceptShareDialog(e)}),Topics.get(Topics.RENAME_FOLDER).subscribe(function(e){d.openFolderDialog(e)}),Topics.get(Topics.CREATE_SUB_FOLDER).subscribe(function(e){d.openFolderDialog(null,e)}),Topics.get(Topics.GROUP_ADDED).subscribe(function(e,t){if(je(),me.addChild(e.newDisplayObject(),t),e instanceof SharedGroup){var i=Re.getContainer();if(null!==i){var n=new SharedFolderItem(e);i.addChild(n)}}}),Topics.get(Topics.ESCAPE).subscribe(function(e){var t=Dialog.prototype.getCurrentDialog();t&&t.close(),qe(),Ye()}),Topics.get(Topics.EDIT_SHARED_FOLDER).subscribe(function(e,t){d.openSharedFolderDialog(e,t)}),Topics.get(Topics.IDENTITY_ADDED).subscribe(function(e){Le.getContainer().addChild(e.newDisplayObject())}),d.refreshVault=function(){if(null!==S&&S._accountClass!==LPProxy.getAccountClass()&&void 0!==bg.makeLoginCheck){bg.makeLoginCheck();var e=Strings.translateString("Subscription updated. Thanks for choosing LastPass!");localStorage.setItem(bg.get("g_username_hash")+"LPNotificationSuccessMessage",e),LPFeatures.secondaryOnboardingEnabled()||location.reload()}LPProxy.initializeModel(),Dt(),(S=LPProxy.getUser()).initialize(z,$("#userMenuText")),LPTools.parseUserSpecificMenu(r.getElementById("tools"),S._accountClass),LPTools.parseUserSpecificMenu(r.getElementById("leftMenu"),S._accountClass),wt(LPProxy.getAccountClass(),LPProxy.isPremiumAsAPerk(),LPProxy.isLegacyPremium()),VaultState.setIdentities(S._identities),LPProxy.enableCurrentIdentity(S._identities),S.isFreeOrTrial()&&!LPFeatures.secondaryOnboardingEnabled()?d.showAdPane():q.removeClass("freeUser"),LPProxy.getSecurityChallengeScore(Ct),Dialog.prototype.closeInProcessDialogs(),VaultItemDialog.prototype.refreshOpenDialogs(),Topics.get(Topics.REFRESH_PREFERENCES).publish(),ze()},Topics.get(Topics.REFRESH_DATA).subscribe(d.refreshVault),Topics.get(Topics.UPDATE_NOTIFICATION_COUNT).subscribe(function(e){ye&&ye.updateNotificationCount("number"==typeof e?e:1)}),Topics.get(Topics.ACCOUNT_LINKED).subscribe(function(e){LPFeatures.isFamiliesAsABenefitEnabled()||($("#linkAccountMenuItem").LP_hide(),$("#verifyLinkedAccountMenuItem").LP_hide(),$("#removedLinkedAccountMenuItem").LP_show())}),Topics.get(Topics.ACCOUNT_LINKED_NEEDS_VERIFICATION).subscribe(function(e){$("#linkAccountMenuItem").LP_hide(),$("#verifyLinkedAccountMenuItem").LP_show(),$("#removedLinkedAccountMenuItem").LP_hide()}),Topics.get(Topics.ACCOUNT_UNLINKED).subscribe(function(e){LPFeatures.isFamiliesAsABenefitEnabled()||($("#linkAccountMenuItem").LP_show(),$("#verifyLinkedAccountMenuItem").LP_hide(),$("#removedLinkedAccountMenuItem").LP_hide())}),Topics.get(Topics.CREATE_SHARED_FOLDER).subscribe(function(e,t){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType()):d.openCreateSharedFolderDialog(e,t)}),Topics.get(Topics.REPROMPT).subscribe(function(e){dialogs.reprompt.open({successCallback:e})}),Topics.get(Topics.CONFIRM).subscribe(function(e){dialogs.confirmation.open(e)}),Topics.get(Topics.EMERGENCY_RECIPIENT_ADDED).subscribe(function(e){Ie.getContainer().addChild(e.newDisplayObject())}),Topics.get(Topics.EDIT_EMERGENCY_RECIPIENT).subscribe(function(e){dialogs.addEmergencyAccess.open({vaultItem:e})}),Topics.get(Topics.REAPPLY_SEARCH).subscribe(function(e,t){var i=J.val();i&&e.applySearch(i,t)}),Topics.get(Topics.ENROLLED_CREDIT_MONITORING).subscribe(function(){Ee.refresh()}),Topics.get(Topics.ITEM_SHARED).subscribe(function(e){Oe.refresh()}),Topics.get(Topics.REFRESH_PREFERENCES).subscribe(function(){switch(LPFeatures.updateFeatures({import:!0,noexport:!1,share:!0,share_onlyfolders:!1,show_notes:!0,show_two_factor_code:!0,bookmarklets:!0,hideidentities:!1,link_personal:!0,show_formfills:!0}),LPProxy.hasReceivedShares()?q.removeClass("noReceivedShares"):q.addClass("noReceivedShares"),ye){case Oe:LPFeatures.allowIndividualSharing()||(Ne.clear(),ri.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),text:Strings.translateString("Your enterprise has prohibited individual sharing.")}));break;case Re:LPFeatures.allowSharedFolders()||(ri.all.show(),dialogs.alert.open({title:Strings.translateString("Policy Update"),text:Strings.translateString("Your enterprise has prohibited sharing.")}))}}),Strings.translate(r.body),$("input,textarea").prop("spellcheck",!1),LPFeatures.allowNewSettings()){var ti=document.getElementById("new-settings-iframe");ti.src=LPProxy.getBaseURL()+"newvault/lp-vault/settings.html",ti.addEventListener("load",function(){ti.contentWindow.postMessage({localkey:parent.g_local_key},LPProxy.getBaseURL())})}Topics.get(Topics.INTRO_TOURS_LOADED).subscribe(function(e){var t=LPProxy.seenVaultPostFamilies(),i=LPProxy.predatesFamilies(),n=LPFeatures.allowTryFamilies(),o=LPProxy.isFamiliesTrialStarted();!n||!i||t||Ot()||Bt()||!kt()||o||d.openTryFamiliesDialog(!1,"first_vault_entry")}),Notifications.initialize();var ii=function(e,t,i){var n=LPTools.createElement("div",$.extend(i,{class:"leftMenuItem space-clickable",id:i.id,tabindex:1}));return n.appendChild(t),n.appendChild(LPTools.createElement("span",{class:"menuText"},e)),$(n)},ni=function(e,t){return e instanceof GroupDisplay||e._model.getRecordType()===t.recordType},oi=function(t,e){if(t.types){var i=e.filter(function(e){return-1<t.types.indexOf(e.id)});return function(e){for(var t=0;t<i.length;++t)if(ni(e,i[t]))return!0;return!1}}return function(e){return!(e instanceof FormFillDisplay)}},ri={},ai=function(l){if(LPFeatures.allowOmarIA()){var i=document.getElementById("leftMenuItemsContainer");LPTools.removeDOMChildren(i);var c=LPProxy.getRecordConfig(),u=!1,d=!1,p=function(e){u&&(i.appendChild(LPTools.createElement("div","leftMenuItemsDivider")),u=!1);var t=ri[e.id].getElement();i.appendChild(t),null!=e.user&&t.setAttribute("user",e.user)},g=function(e,t){if(Array.isArray(e))u=0<t,e.forEach(g);else{var i=LPProxy.getConfigViewObject(e);if(i.default){if(i.types){var n=LPProxy.getConfigTypeObject(i.types[0]),o=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[],r;if(!(-1!==LPProxy.getAllModelTypes().indexOf(n.recordType))&&"Account"!==n.recordType&&(-1!==o.indexOf("0")||-1!==o.indexOf(n.enterprisePolicyId)))return}p(i)}else{var a=oi(i,c.types),s=l._filter;l.applyFilter({func:a},{checkForStateChange:!1}),0<l.getItemChildren().length?p(i):ri[i.id]===ye&&(d=!0),l.applyFilter(s,{checkForStateChange:!1})}}};u=!0,c.viewConfig.forEach(g),LPTools.parseUserSpecificMenu(r.getElementById("leftMenu"),LPProxy.getAccountClass()),d&&ri.all.show(),LPFeatures.hide_cloud_apps_policy_enabled()&&$("#cloud-apps").LP_hide(),LPFeatures.allowSecurityDashboard()?$(".securityMenuItem").LP_hide():$(".securityDashboardMenuItem").LP_hide(),J.val()&&l.applySearch(J.val(),{forceSearch:!0})}void 0===bg.get_method&&bg.get("LPContentScriptFeatures").omaria||$("#toolsMigrate").LP_hide()},si=function(e){var t,i=LPProxy.getRecordConfig();return t=e.types&&0<e.types.length?i.icons[e.types[0]]:i.icons.all,LPTools.createElement("i",{class:["menuIcon",t]})},li=function(){if(LPFeatures.allowOmarIA()){var o=LPProxy.getRecordConfig();o.views.forEach(function(n){ri[n.id]=new ve({filter:{showEmptyGroups:!0,func:oi(n,o.types)},sortOptions:e,menuElement:ii(Strings.translateString(n.name),si(n),{id:n.id}),bodyState:"vaultContent "+n.id,scrollParent:C,title:Strings.translateString(n.name),addMenu:[new P({text:"ADD_ITEM",autoId:"vaultAddItemButton",func:function(){var t,i=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];bg.get("g_is_restricted")?d.openVaultDeviceLimitDialog():n.types&&-1===i.indexOf("0")?o.types.forEach(function(e){if(e.id===n.types[0])switch(t=e.recordType){case o.TYPE.Password:dialogs.site.open();break;case o.TYPE.Custom:dialogs.addItem.open({isExpanded:!0});break;default:-1!==i.indexOf(e.enterprisePolicyId)?dialogs.addItem.open():dialogs.note.open({defaultData:{notetype:t,language:Note.prototype.isValidLanguage(navigator.language)?navigator.language:"en-US"}})}}):dialogs.addItem.open()}}),b.Folder]})})}else ri.all=new ve({filter:{showEmptyGroups:!0,func:function(e){return e instanceof AccountBaseDisplay||e instanceof ApplicationDisplay||e instanceof GroupDisplay}},sortOptions:e,menuElement:$("#vaultMenuItem"),bodyState:"vaultContent site",scrollParent:C,title:Strings.translateString("Sites"),addMenu:[b.Site,b.Note,b.ShareItems,b.Folder]}),ri.notes=new ve({filter:{showEmptyGroups:!1,func:function(e){return e instanceof NoteDisplay||e instanceof GroupDisplay}},sortOptions:e,menuElement:$("#notesMenuItem"),bodyState:"vaultContent note",scrollParent:C,title:Strings.translateString("Secure Notes"),addMenu:[b.Note,b.ShareItems,b.Folder]}),ri.formFills=new ve({filter:{showEmptyGroups:!1,multiSelect:!1,hasFolderView:!1,func:function(e){return e instanceof FormFillDisplay}},sortOptions:t,menuElement:$("#formFillMenuItem"),bodyState:"vaultContent formFill",scrollParent:C,title:Strings.translateString("Form Fills"),addMenu:[b.FormFill]});LPFeatures.isDogfood()||$("#featureManager").LP_hide(),LPFeatures.hide_cloud_apps_policy_enabled()?ee.LP_hide():ee.LP_show().bind("click",function(){bg.sendLpImprove("vault_cloud_apps_clicked"),bg.openOnNewTab("saml/launch/nopassword?RelayState=/")}),LPFeatures.hide_cloud_apps_policy_enabled()?$("#cloud-apps").LP_hide():$("#cloud-apps").LP_show().bind("click",function(){bg.sendLpImproveCallback("vault_cloud_apps_clicked",function(){window.location.href="/saml/launch/nopassword?RelayState=/"})}),LPFeatures.allowSecurityDashboard()?te.LP_hide():ie.LP_hide()},ci=getCookie("session_valid_until");if(ci){ci=new Date(1e3*parseInt(ci));var ui=!1,di=setInterval(function(){!ui&&ci.getTime()-Date.now()<12e4&&(ui=!0,dialogs.alert.open({title:Strings.translateString("Your session will expire soon"),text:Strings.translateString("For your protection, your session will expire in 2 minutes. This is required by your organization's security policy.")})),ci.getTime()-Date.now()<-1e4&&(clearInterval(di),window.top.location.reload())},1e4)}d.initializePremiumFeatureIndicator=function(){var t=LPProxy.getAccountClass(),i=$("#trialCounter"),n=$("#trialCounterBody"),e=bg.get("g_premium_trial_exp_days"),o=$('<span class="trial-counter__text"></span>'),r=$('<button class="trial-counter__button"></button>'),a=document.querySelectorAll(".premium-indicator"),s=document.getElementById("emergencyAccessPremiumTooltip"),l=document.getElementById("securityDashboardPremiumTooltip"),c=document.getElementById("familyAdminConsolePremiumTooltip");function u(){x.addClass("trial-counter-is-visible"),i.addClass("is-visible");for(var e=0;e<a.length;e++)a[e].classList.add("is-visible")}n.empty(),s.innerText="",l.innerText="",c.innerText="",ie.addClass("premium-feature"),ne.addClass("premium-feature"),ne.addClass("premium-feature"),oe.addClass("premium-feature"),r.text(Strings.translateString("Upgrade")),n.append(o),t===Constants.USER_FAMILY_ADMIN?bg.BackgroundServer.licensing.getCompanyLicensing(function(e){!1===e.success?(i.addClass("clickable"),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?o.html(Strings.translateString("Upgrade to Families")):o.html(Strings.translateString("Go Families for %s$4.00/month.%s","<b>","</b>")),i.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Premium Feature Indicator"):(bg.openURL(LPProxy.getBaseURL()+"families/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Families",source:"Vault Banner"}))}),l.innerText=Strings.translateString("Go Families to continue monitoring your security."),s.innerText=Strings.translateString("Go Families to keep your digital life alive in an emergency."),c.innerText=Strings.translateString("Go Families to continue managing your family’s online security."),oe.unbind("click"),oe.on("click",function(){"undefined"!=typeof Proxy&&reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Manage Family Menu Item"):d.showVaultUpgradeToPremiumDialog("families")}),u()):e.hasOwnProperty("trialdaysleft")&&(_companyTrialDays=e.trialdaysleft,1<e.trialdaysleft?(n.append(r),o.html(Strings.translateString("%s%d days%s left in trial.","<b>",e.trialdaysleft,"</b>")),r.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Premium Feature Indicator"):(bg.openURL(LPProxy.getBaseURL()+"families/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Families",source:"Vault Banner"}))}),l.innerHTML=Strings.translateString("Go Families to continue monitoring your security.")+"</br>"+Strings.translateString("%d days left in trial.",e.trialdaysleft),s.innerHTML=Strings.translateString("Go Families to keep your digital life alive in an emergency.")+"</br>"+Strings.translateString("%d days left in trial.",e.trialdaysleft),c.innerHTML=Strings.translateString("Go Families to continue managing your family’s online security.")+" "+Strings.translateString("%d days left in trial.",e.trialdaysleft)):1===e.trialdaysleft?(n.append(r),o.html(Strings.translateString("1 day left in trial.","<b>","</b>")),r.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Premium Feature Indicator"):(bg.openURL(LPProxy.getBaseURL()+"families/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Families",source:"Vault Banner"}))}),l.innerHTML=Strings.translateString("Go Families to continue monitoring your security.")+"</br>"+Strings.translateString("1 day left in trial."),s.innerHTML=Strings.translateString("Go Families to keep your digital life alive in an emergency.")+"</br>"+Strings.translateString("1 day left in trial."),c.innerHTML=Strings.translateString("Go Families to continue managing your family’s online security.")+" "+Strings.translateString("1 day left in trial.")):0===e.trialdaysleft?(n.append(r),o.html(Strings.translateString("Your trial will expire today","<b>","</b>")),r.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Premium Feature Indicator"):(bg.openURL(LPProxy.getBaseURL()+"families/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Families",source:"Vault Banner"}))}),l.innerHTML=Strings.translateString("Go Families to continue monitoring your security.")+"</br>"+Strings.translateString("Your trial will expire today"),s.innerHTML=Strings.translateString("Go Families to keep your digital life alive in an emergency.")+"</br>"+Strings.translateString("Your trial will expire today"),c.innerHTML=Strings.translateString("Go Families to continue managing your family’s online security.")+" "+Strings.translateString("Your trial will expire today")):(i.addClass("clickable"),reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?o.html(Strings.translateString("Upgrade to Families")):o.html(Strings.translateString("Go Families for %s$4.00/month.%s","<b>","</b>")),i.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Premium Feature Indicator"):(bg.openURL(LPProxy.getBaseURL()+"families/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Families",source:"Vault Banner"}))}),l.innerText=Strings.translateString("Go Families to continue monitoring your security."),s.innerText=Strings.translateString("Go Families to keep your digital life alive in an emergency."),c.innerText=Strings.translateString("Go Families to continue managing your family’s online security."),oe.unbind("click"),oe.on("click",function(){reduxApp&&LPProxy.isExpiredFamiliesPurchaseFlowEnabled()&&LPProxy.isExpiredFamilyUser()?reduxApp.setExpiredFamiliesPurchaseFlowType(LPProxy.getFamilyMemberType(),"Manage Family Menu Item"):d.showVaultUpgradeToPremiumDialog("families")})),u())}):(1<e?(n.append(r),o.html(Strings.translateString("%s%d days%s left in trial.","<b>",e,"</b>")),r.on("click",function(){bg.openURL(LPProxy.getBaseURL()+"premium/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Premium",source:"Vault Banner"})}),l.innerHTML=Strings.translateString("Go Premium to continue monitoring your security.")+"</br>"+Strings.translateString("%d days left in trial.",e),s.innerHTML=Strings.translateString("Go Premium to keep your digital life alive in an emergency.")+"</br>"+Strings.translateString("%d days left in trial.",e)):1===e?(n.append(r),o.html(Strings.translateString("1 day left in trial.","<b>","</b>")),r.on("click",function(){bg.openURL(LPProxy.getBaseURL()+"premium/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Premium",source:"Vault Banner"})}),l.innerHTML=Strings.translateString("Go Premium to continue monitoring your security.")+"</br>"+Strings.translateString("1 day left in trial."),s.innerHTML=Strings.translateString("Go Premium to keep your digital life alive in an emergency.")+"</br>"+Strings.translateString("1 day left in trial.")):(o.html(Strings.translateString("Go Premium for %s$3.00/month.%s","<b>","</b>")),i.addClass("clickable"),i.on("click",function(){bg.openURL(LPProxy.getBaseURL()+"premium/payment"),bg.sendLpImprove("upgrade_prompt_action",{feature:"None",action:"Purchase",userType:t,product:"Premium",source:"Vault Banner"})}),l.innerText=Strings.translateString("Go Premium to continue monitoring your security."),s.innerText=Strings.translateString("Go Premium to keep your digital life alive in an emergency.")),u())},d.showVaultUpgradeToPremiumDialog=function(e){dialogs.vaultUpgradeToPremiumDialog.open({dialogType:e})},d.closeFaaB=function(e){if(LPFeatures.isFamiliesAsABenefitEnabled()){var t=$("#familyAsABenefitDrawer div")[0],i=$("#accountBenefitsMenuItem div")[0];e.target!==t&&e.target!==i&&e.target.parentElement!==i&&reduxApp.getState().familiesAsABenefit.drawerOpen&&($("#accountBenefitsMenuItem").removeClass("selected"),reduxApp.toggleFamiliesAsABenefitDrawer())}},d.removeFaaBMenuItemSelection=function(){var e=$("#accountBenefitsMenuItem");void 0!==e&&$(e).removeClass("selected")}};function getCookie(e){for(var t=e+"=",i=document.cookie.split(";"),n=0;n<i.length;n++){for(var o=i[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return o.substring(t.length,o.length)}return""}function deleteCookie(e){document.cookie=e+"=; expires=Thu, 01 Jan 1970 00:00:01 GMT;path=/"}Topics.get(Topics.INITIALIZED).subscribe(function(){initialize(document,LPVault,BuildVariables)}),Topics.get(Topics.INITIALIZED).subscribe(function(){try{var e=bg.get("g_username_hash")+"LPNotificationSuccessMessage",t=localStorage.getItem(e);t&&(Notifications.displaySuccessMessage(t),localStorage.removeItem(e))}catch(e){}}),Topics.get(Topics.REFRESH_PREFERENCES).subscribe(function(){try{var e=bg.get("g_username_hash")+"LPUserHasMetVaultDeviceLimitRestriction",t=localStorage.getItem(e),i=!bg.get("g_is_restricted"),n=JSON.stringify(reduxApp.getState().vaultData.passwords)===JSON.stringify({});t&&i&&n&&(LPProxy.refreshSites(),localStorage.removeItem(e),setTimeout(function(){location.reload()},1e3))}catch(e){}});