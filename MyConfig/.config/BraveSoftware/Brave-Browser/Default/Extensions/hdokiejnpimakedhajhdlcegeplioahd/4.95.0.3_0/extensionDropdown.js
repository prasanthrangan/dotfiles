function segmentService(e,t){top.reduxApp&&top.reduxApp.segmentService&&top.reduxApp.segmentService(e,t)}function trackMenuItem(e,t){document.getElementById(e).addEventListener("click",function(){segmentService("Extension Toolbar Menu Clicked",{Action:t})},!0)}trackMenuItem("vaultMenuItem","OpenVault"),trackMenuItem("favoriteSitesMenuItem","Favorites"),trackMenuItem("recentSitesMenuItem","RecentlyUsed"),trackMenuItem("allItemsMenuItem","AllItems"),trackMenuItem("addItem","AddItem"),trackMenuItem("generateMenuItem","GeneratePassword"),trackMenuItem("securityDashboardMenuItem","SecurityDashboard"),trackMenuItem("optionsMenuItem","AccountOptions"),trackMenuItem("optionsMenuItemEnt","AccountOptions"),trackMenuItem("adminConsoleMenuItem","AdminConsole"),trackMenuItem("logoutMenuItem","Logout"),trackMenuItem("omarIdentitiesMenuItem","Identities"),trackMenuItem("advancedMenuItem","Advanced"),trackMenuItem("omarFavoritesMenuItem","OpenFavorites"),trackMenuItem("omarPrefMenuItem","Preferences"),trackMenuItem("siteFeedbackMenuItem","ImproveLastPass"),trackMenuItem("omarSupportMenuItem","SupportCenter"),trackMenuItem("omarAboutMenuItem","AboutLastPass"),trackMenuItem("optionsViewLogoutMenuItem","Logout"),trackMenuItem("omarRefreshMenuItem","RefreshSites"),trackMenuItem("omarClearCachMenuItem","ClearLocalCache"),trackMenuItem("omarSessionsMenuItem","OtherSessions"),trackMenuItem("omarImportMenuItemMain","Import"),trackMenuItem("exportMenuItemMain","Export"),trackMenuItem("printMenuItem","Print"),ExtensionDropdown=function(a){var s=$(a.body),l=$("html"),n=a.getElementById("items"),r=a.getElementById("searchResults"),c=a.getElementById("recentSites"),o=a.getElementById("favoriteSites"),u=a.getElementById("identitiesMenuItem"),i=a.getElementById("matchingSitesTopLevel"),t=a.getElementById("matchingSites"),m=a.getElementById("addCustomItems"),d=$("#panelContainer"),e=$("#restrictionOverlay"),p=$("#topLevelContainer"),g=$("#allMatchingSitesMenuItem"),f=a.getElementById("allMatchingSitesItems"),b=$("#vaultMenuItem"),v=$("#addOmariaItems"),h=$("#allItems"),_=$("#groupLabel"),I=$("#backButton"),P=$("#debugconsole"),y=$("#wifiExportMenuItem"),x=$("#matchingSitesMenuItem"),E=$("#recentSitesMenuItem"),L=$("#favoriteSitesMenuItem"),S=$(".new"),w=$("#container"),k=$("#innerWrapper"),C=$("#searchInput"),M=$("#applicationsMenuItem"),T=$("#logoContainer"),D=$("#logoPartner"),A=null,F=!1,B=null,O=null,N=null,U=null,R=null,K=365,z=457,G,V=function(){var e="en-US";if(window.location&&window.location.search)for(var t=window.location.search.replace("?","").split("&"),n=0;n<t.length;n++){var o=t[n];-1!==o.indexOf("htmllanguage=")&&(e=o.split("=")[1])}return e},H=function(){var e=bg.get("lploggedin")?K:z,t=d.is(":visible")&&d.outerHeight()>k.outerHeight()?d.outerHeight():k.outerHeight()<e?e:k.outerHeight(),n=d.is(":visible")?d.outerWidth()+k.outerWidth():k.outerWidth();LPPlatform.setDropdownPopoverSize(t,n)},W=null,Y=null,j=null,q=null,Z=null,X=null,Q=null,J=null,ee=null,te=null,ne=null,oe=null,ie=null,ae=!1,re=!1,se=!1,le=!1,ce=!1,ue={},me=null,de={},pe=[],ge={},fe=function(e){if(_.empty(),e){var t=e.getName(),n=(t=t.replace(/\\/g," \\ ")).indexOf("\\",t.length/2);if(-1===n&&(n=t.lastIndexOf("\\")),0<n){var o=LPTools.createElement("div","textOverflowContainer groupLabel");o.appendChild(LPTools.createElement("span",null,t.substring(0,n))),_.append(LPTools.createElement("span","textTail","Â "+t.substring(n))),_.append(o),LPTools.setupMiddleEllipsis(_)}else _.append(LPTools.createElement("span","groupLabel",t));_.find(".groupLabel").attr("title",e.toString())}},be,ve;ge.GroupState=function(t){var n=LPTools.getNavIndex();this.pop=function(e){t.rebuildItems(null,e),e&&LPTools.setNavIndex(n),fe(t._model)}},ge.SearchState=function(){var e=new ge.CSSState("searchItem",{restoreKeyboardNav:!1});this.pop=function(){Ue(),e.pop()}},ge.TopLevelMatchingSitesState=function(e){var t=new ge.CSSState("matchingSites"),n=new ge.GroupState(e);this.pop=function(){n.pop(),t.pop()}},ge.CSSState=(be=s.attr("class"),ve=function(e){s.removeClass(be),s.addClass(e),be=e},function(e,t){var n=be;if(ve(e),LPTools.getOption(t,"applyKeyboardNav",!0)){var o=LPTools.getOption(t,"selectFirst",!1);LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{selectFirst:o})}this.pop=function(){fe(null),ve(n),LPTools.getOption(t,"restoreKeyboardNav",!0)&&LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:0===pe.length&&ie?ie.getItems():null}),t&&"function"==typeof t.onPop&&t.onPop()}});var he=function(){LPTools.parseUserSpecificMenu(a.getElementById("mainMenu"),LPProxy.getAccountClass()),$("#username, #optionsMenuUserName, #optionsViewUserName").text(bg.get("g_username"))},_e=function(){$("#container").LP_show();var e=V();l.attr("lang",e),xe();var t=bg.get("LPContentScriptFeatures").ziggy,n=bg.get("LPContentScriptFeatures").omaria,o=bg.get("LPContentScriptFeatures").site_feedback&&!(bg.get("g_isedge")||bg.get("g_issafari_appext")),i=bg.get("LPContentScriptFeatures").site_feedback_new_badge&&o;R=LPProxy.getAccountClass(),bg.get("LPContentScriptFeatures").new_native_extension_ads_enabled||"Free User"===R||"Premium Trial User"===R||"Family Admin"===R||ExtensionLicenseExpiration.initialize(),ExtensionBillingAddressNotification.initialize(),"Enterprise Admin"!==R&&"Teams Admin"!==R||s.addClass("admin"),B=bg.get("g_premium_trial_exp_days"),O=bg.get("g_company_trial_exp_days"),N=bg.get("g_company_license_exp_days"),U=bg.get("g_company_renewalstatus"),bg.get("LPContentScriptFeatures").show_device_limit_notification&&LPProxy.isExpiredFamilyUser()&&parent.reduxApp.getState().settings.features.expiredFamiliesPurchaseFlow&&(bg.setDeviceLimitNotification(!0),ExtensionDeviceLimitNotification.initialize()),(bg.get("LPContentScriptFeatures").new_native_extension_ads_enabled&&"Free User"===R||"Premium Trial User"===R||"Family Admin"===R)&&$("#securityDashboardMenuItem span").replaceWith('<img src="images/dropdownIconset/diamond-icon-small.svg" class="premium-feature">'),A={isZiggySet:t,isOmarSet:n,showHelpText:t};var a=function(){bg.get_method_async(function(e){G=e}),Ie(),De(),n||E.detach().insertBefore("#toolsMenuItem"),Be(A),he(t),setTimeout(function(){Ee()}),at(),o?i&&!bg.Preferences.get("hasClickedSiteFeedback")&&(S.css("display","flex"),S.append(LPTools.createElement("div",{class:"badge newBadge"},Strings.translateString("NEW")))):$("#siteFeedbackMenuItem").detach(),t||($("#mainMenu").addClass("showIcons"),Ge("postSetup",Pe)()),bg.sendLpImprove("openicondropdown",{show_sites_in_folders:bg.Preferences.get("showAcctsInGroups",!0)?"on":"off"}),segmentService("Extension Toolbar Menu Opened")},r=LPPlatform.getExtensionDropdownDelay();0<=r?setTimeout(a,r):a()},Ie=function(){w.addClass("loading")},Pe=function(){if(bg.get("g_is_restricted"))return s.addClass("restricted"),$("#recentSitesMenuItem").unbind("click"),$("#allItemsMenuItem").unbind("click"),$("#addItem").unbind("click"),$("#securityDashboardMenuItem").unbind("click"),$("#searchInput").attr("disabled",!0),$("#omarIdentitiesMenuItem").unbind("click"),$("#omarRefreshMenuItem").unbind("click"),$("#omarClearCachMenuItem").unbind("click"),$("#omarImportMenuItemMain").unbind("click"),$("#printMenuItem").unbind("click"),void ye();if(parent&&parent.reduxApp&&bg.get("LPContentScriptFeatures").new_native_extension_ads_enabled)return!bg.get("g_isedge")&&bg.get("g_show_device_limit_notification")?d.load("extensionDropdownDeviceLimitNotification.html",function(){ExtensionDeviceLimitNotification.setupUI(),ye()}):bg.get("g_isedge")&&chrome.runtime.getBackgroundPage(function(e){e.g_show_device_limit_notification&&d.load("extensionDropdownDeviceLimitNotification.html",function(){ExtensionDeviceLimitNotification.setupUI(),ye()}),ye()}),void ye();var t=AuroraAccount.prototype.createGoToAssistData.call(),n=AuroraAccount.prototype.createGoToWebinarData.call();bg.get("g_show_device_limit_notification")?d.load("extensionDropdownDeviceLimitNotification.html",function(){ExtensionDeviceLimitNotification.setupUI(),ye()}):bg.get("g_show_billing_address_notification")?d.load("extensionBillingAddressNotification.html",function(){ExtensionBillingAddressNotification.showBillingAddressNotification(),ye()}):bg.MigrationBackground.shouldShowMigrationNotification()?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({openEvent:"migration_formfill_notification_shown",headerText:"Welcome to the new LastPass Experience!",openEventProps:{version:"welcome",vault_version:"omar"},subHeaderText:"Your vault has been upgraded!",linkText:"Learn more about these changes.",linkUrl:"https://link.lastpass.com/help-new-form-fills",text1:"The final step is to migrate your form fill profiles to their new homes - this process should only take a minute.",text2:"Your form fill information will be unavailable until you complete this step.",buttonText:"Finish the Update",buttonEvent:"migration_formfill_notification_clicked",buttonEventProps:{version:"welcome",vault_version:"omar",action:"migrate"},dialogClasses:"boldText tall",buttonAction:function(){"cr"===G||"ff"===G||"edgecr"===G?(bg.MigrationBackground.setShouldStartMigration(!0),bg.openvault()):(bg.openURL("https://lastpass.com/experience-update"),bg.lpevent("m_lo"),bg.loggedOut(!1,"menu"))}}),ye()}):LPFeatures.isPromotionDialogG2aEnabled()&&!localStorage.getItem(t.storageKey)?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:t.storageKey,class:"promotion",openEvent:"promotion_extension_dialog_shown",openEventProps:{recommendedProduct:t.auroraId},imageTop:"vault_4.0/promotion/logo-gotoassist-lmi.png",imageCenter:"vault_4.0/promotion/gotoassist-promo.png",text1:"Radically refreshing remote support",text2:"Keep your employees on-the-move and resolve issues quickly, without frustration.",buttonText:"Start your free trial",buttonAction:function(){var e;yt({name:t.name,urlConfigKey:t.auroraId,storageKey:t.storageKey,segmentEvent:"promotion_extension_dialog_button_clicked",segmentEventProperties:{recommendedProduct:t.auroraId,action:"clicked"}})},closePanelButton:!0,closePanelButtonAction:function(){bg.sendLpImprove("promotion_extension_dialog_button_clicked",{recommendedProduct:t.auroraId,action:"dismiss"})}}),ye()}):LPFeatures.isPromotionDialogG2wEnabled()&&!localStorage.getItem(n.storageKey)?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:n.storageKey,class:"promotion",openEvent:"promotion_extension_dialog_shown",openEventProps:{recommendedProduct:n.auroraId},imageTop:"vault_4.0/promotion/logo-gotowebinar-lmi.png",imageCenter:"vault_4.0/promotion/gotowebinar-promo.png",text1:"Your next webinar is on us",text2:"Go from preparing a webinar to presenting in fewer steps - and have fun along the way.",buttonText:"Start your free trial",buttonAction:function(){var e;yt({name:n.name,urlConfigKey:n.auroraId,storageKey:n.storageKey,segmentEvent:"promotion_extension_dialog_button_clicked",segmentEventProperties:{recommendedProduct:n.auroraId,action:"clicked"}})},closePanelButton:!0,closePanelButtonAction:function(){bg.sendLpImprove("promotion_extension_dialog_button_clicked",{recommendedProduct:n.auroraId,action:"dismiss"})}}),ye()}):bg.get("LPContentScriptFeatures").premium_trial_upgrade_test_emergency_access&&!localStorage.getItem("dropdown_emergency_upsell")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_emergency_upsell",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:2},imageTop:"icon-secure.png",headerText:"Prepare for the Unexpected",text1:"Make your LastPass account safely available to a trusted family member or friend with emergency access, available in LastPass Premium.",text2:"Buy Premium to get emergency access.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/set-up-and-manage-emergency-access-lp030013",linkEventProps:{version:2,action:3},buttonText:"Buy Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:2,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:2,action:2}}),ye()}):bg.get("LPContentScriptFeatures").premium_trial_upgrade_test_sharing&&!localStorage.getItem("dropdown_sharing_upsell")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_sharing_upsell",class:"sharingUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:3},headerText:"Sharing Made Easy",text1:"Never get asked for a password again. Store & share unlimited items with friends and family members as you need to with LastPass Premium.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/use-the-sharing-center-lp020007",linkEventProps:{version:3,action:3},centerImages:["icon-media","icon-bill-accounts","icon-medical"],centerLabels:["Streaming Media","Bill Payments","Medical ID Numbers"],buttonText:"Buy Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:3,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:3,action:2}}),ye()}):bg.get("LPContentScriptFeatures").premium_trial_to_families_test_generic&&!localStorage.getItem("dropdown_premium_trial_families")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_premium_trial_families",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:4},imageTop:"icon-family.png",headerText:"LastPass for the Entire Family",text1:"All your family's information -- organized, secure and at your fingertips.",text2:"Simple access to shared accounts",text3:"Secure storage for SSN, medical IDs and more",text4:"Six LastPass accounts, all for one low price",linkText:"Learn more.",linkUrl:"https://www.lastpass.com/family-password-manager",linkEventProps:{version:4,action:3},buttonText:"Try Families",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:4,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/families/trial")},closePanelButton:!0,closePanelEventProps:{version:4,action:2}}),ye()}):bg.get("LPContentScriptFeatures").premium_to_families_test_generic&&!localStorage.getItem("dropdown_premium_families")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_premium_families",class:"emergencyUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:4},imageTop:"icon-family.png",headerText:"LastPass for the Entire Family",text1:"All your family's information -- organized, secure and at your fingertips.",text2:"Simple access to shared accounts",text3:"Secure storage for SSN, medical IDs and more",text4:"Six LastPass accounts, all for $48 per year",linkText:"Learn more.",linkUrl:"https://www.lastpass.com/family-password-manager",linkEventProps:{version:4,action:3},buttonText:"Try Families",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:4,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/families/trial")},closePanelButton:!0,closePanelEventProps:{version:4,action:2}}),ye()}):bg.get("LPContentScriptFeatures").free_to_premium_ad_test_generic&&!localStorage.getItem("dropdown_free_premium_generic_upsell")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_free_premium_generic_upsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:1},imageCenter:"premium.svg",headerText:"Control Your Digital Life",subHeaderText:"Take your online security to the next level with LastPass Premium",text2:"Designate an emergency access contact & digital heir",text3:"Share vital passwords with family and friends",text4:"Fast-track yourself to priority tech support",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/lastpass-premium-faqs-lp010085",linkEventProps:{version:1,action:3},buttonText:"Upgrade To Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:1,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:1,action:2}}),ye()}):bg.get("LPContentScriptFeatures").free_to_premium_ad_test_sharing&&!localStorage.getItem("dropdown_free_premium_sharing_upsell")?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({key:"dropdown_free_premium_sharing_upsell",class:"sharingUpsell",openEvent:"consumer_test_ad_shown",openEventProps:{version:3},headerText:"Enjoy No Limits on Sharing",text1:"Store & share unlimited items with trusted friends and family with LastPass Premium.",linkText:"Learn more.",linkUrl:"https://support.logmeininc.com/lastpass/help/use-the-sharing-center-lp020007",linkEventProps:{version:3,action:3},centerImages:["icon-bill-accounts","icon-media","icon-medical"],centerLabels:["Cable & Household Bill Accounts","Streaming Media","Medical ID Numbers"],buttonText:"Upgrade to Premium",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:3,action:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")},closePanelButton:!0,closePanelEventProps:{version:3,action:2}}),ye()}):ExtensionLicenseExpiration.expiredCompanyStatusCheckerForPanelSize()||ExtensionLicenseExpiration.expiredPremiumStatusCheckerForPanelSize()?ye():bg.get("g_show_original_language_changed_notification")?d.load("extensionLanguageUpdate.html",function(){ExtensionLanguageUpdate.initialize(),ye()}):LPProxy.isPremiumTrialUser()?d.load("extensionDropdownMessagingDialog.html",function(){ExtensionDropdownMessagingDialog.initialize({openEvent:"consumer_test_ad_shown",openEventProps:{version:1},headerText:"Control Your Digital Life",subHeaderText:"Stay secure with LastPass Premium",text1:"Designate an emergency access contact & digital heir",text2:"Share vital passwords with family and friends",text3:"Fast-track yourself to priority tech support",buttonText:"Upgrade To Premium",imageCenter:"premium.svg",buttonEvent:"consumer_test_ad_clicked",buttonEventProps:{version:1},buttonAction:function(){bg.openURL("https://lastpass.com/premium/payment")}}),ye()}):ye()},ye=function(){w.addClass("initialized"),bg.get("LPContentScriptFeatures").new_native_extension_ads_enabled&&s.addClass("extension-ads"),LPTools.addKeyBoardNavigation($(".extensionMenuItem:visible"),{displayItems:ie?ie.getItems():null}),C.focus(),H()},xe=function(){LPFeatures.updateFeatures({import:!0,noexport:!1,show_notes:!0,hideidentities:!1,show_formfills:!0})},Ee=function(){if(LPProxy.initializeModel(),Ae(A),Se(A),!re&&-1<bg.get("g_local_accts_version")){for(var e in re=!0,w.removeClass("loading"),de)de[e]();var t=C.val();t&&Re(t)}else setTimeout(Ee,15)},Le=function(e,t){var t=t||{};return LPProxy.getPreference("showAcctsInGroups",!0)&&(e=LPProxy.assignItemsToGroups(e,!1),t.separateFavorites=!0),new Container(e,t)},Se=function(e){var t=!1;e.isOmarSet?((j=new Container(LPProxy.getAllItems(),$.extend({},e,{omarItems:!0,trackAction:!0,source:"AllItems"}))).setElement(n),ne=new Container(LPProxy.getCustomNoteTemplates().map(function(e){return new AddCustomItemDisplay(e)}),$.extend({},e,{additionalItemClasses:"addOmariaItem",autoExpandSingleItem:!1,value:"Custom"})),Ce(ne.getItemCount()),t=Me()):((q=Le(LPProxy.getSites(),e)).setElement(n),(X=Le(LPProxy.getNotes(),e)).setElement(n),(Q=new Container(LPProxy.getFormFills(),e)).setElement(n),(J=new Container(LPProxy.getApplications(),e)).setElement(n)),rt({hasFavorites:t}),ExtensionLicenseExpiration.showExpiredSubscriptionMessaging()||(ExtensionLicenseExpiration.premiumTrialExpiringStatusChecker()||ExtensionLicenseExpiration.premiumTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(R,"trial",B):ExtensionLicenseExpiration.companyTrialExpiringStatusChecker()||ExtensionLicenseExpiration.companyTrialExpiredStatusChecker()?ExtensionLicenseExpiration.showExpiration(R,"trial",O):(ExtensionLicenseExpiration.companyLicenseExpiredStatusChecker()||ExtensionLicenseExpiration.companyLicenseExpiringStatusChecker())&&ExtensionLicenseExpiration.showExpiration(R,"normal",N,U)),te=new Container(LPProxy.getAllItems(),$.extend({},e,{moreOptionsState:ge.SearchState,moreOptionsCallback:H})),"Enterprise Admin"===R||"Enterprise Role User"===R||"Teams Admin"===R||"Teams Role User"===R?($(".feature-omaria #optionsViewLogoutMenuItem, .feature-omaria #optionsMenuItemEnt").show(),$(".feature-omaria #logoutMenuItem, .feature-omaria #optionsMenuItem").hide()):($(".feature-omaria #optionsViewLogoutMenuItem, .feature-omaria #optionsMenuItemEnt").hide(),$(".feature-omaria #logoutMenuItem, .feature-omaria #optionsMenuItem").show())},we=function(e){var t=["extensionMenuItem","omariaMenuItem"];e&&e.attrs&&e.attrs.class&&(t=t.concat(e.attrs.class));var n=$.extend({},e.attrs,{class:t}),o=LPTools.createElement("li",n);return o.appendChild(LPTools.createElement("i",e.icon+" menuIcon")),o.appendChild(LPTools.createElement("span","name",e.name)),e.addMoreButton&&o.appendChild(LPTools.createElement("div","more")),n.childView&&$(o).bind("click",Lt),e.onClick&&$(o).bind("click",e.onClick),o},ke=function(e,t){switch(t&&j.applyFilter({showEmptyGroups:!1,func:function(e){return e instanceof GroupDisplay||e.getRecordType()===t}}),j.rebuildItems(n,!e.originalEvent.isTrusted),t){case"Account":ot(j,"Empty_Site_Omaria",Strings.translateString("You can save and fill usernames and passwords for any website or app."),Strings.translateString("Add a password"),t);break;case"Generic":ot(j,"Empty_Note_Omaria",Strings.translateString("Use a secure note to save important documents in your LastPass vault."),Strings.translateString("Add a secure note"),t);break;case"Address":ot(j,"Empty_Address_Omaria",Strings.translateString("Add an address to auto-fill your email, phone number, and other contact info."),Strings.translateString("Add an address"),t);break;case"Credit Card":ot(j,"Empty_Credit_Card_Omaria",Strings.translateString("Next time you go shopping, they'll be waiting!"),Strings.translateString("Add a payment card"),t);break;case"Bank Account":ot(j,"Empty_Bank_Account_Omaria",Strings.translateString("Save and fill your bank accounts securely on any device with LastPass."),Strings.translateString("Add a bank account"),t)}},Ce=function(r){var s=LPProxy.getRecordConfig(),l=LPProxy.getAllModelTypes();v.empty(),$("#addItem").addClass("divider"),h.empty(),s.viewConfig.forEach(function(e){if(e.forEach(function(e){if("all"!==e){var a=LPProxy.getConfigViewObject(e);a.types.forEach(function(e){var t=LPProxy.getConfigTypeObject(e),n=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[],o=LPProxy.getAllModelTypes().includes(t.recordType);if("cloud-apps"!==e&&"CloudApps"!==e&&(o||"Password"===e||!n.includes("0")&&!n.includes(t.enterprisePolicyId))){(a.default||l.includes(t.recordType))&&h.append(we({attrs:{class:"omariaItem",childView:"omariaItems"},name:Strings.translateString(a.name),icon:s.icons[t.id],addMoreButton:!0,onClick:function(e){ke(e,t.recordType)}}));var n=bg.get("g_prefoverrides").noformfill?bg.get("g_prefoverrides").noformfill:[];if("Password"===t.id||!n.includes("0")&&!n.includes(t.enterprisePolicyId)){var i=null;t.recordType===s.TYPE.Custom?0<r&&(i=we({attrs:{class:"addOmariaItem",childView:"addCustomItems"},name:Strings.translateString(t.name),icon:s.icons[t.id],addMoreButton:!0,onClick:function(e){ne.rebuildItems(m,!e.originalEvent.isTrusted)}})):i=we({attrs:{class:"addOmariaItem"},name:Strings.translateString(t.name),icon:s.icons[t.id],onClick:function(){Te(t.recordType)}}),i&&v.append(i)}}})}}),e!==s.viewConfig[0]){if(!h[0].lastChild.classList.contains("omarSpacer")){var t=LPTools.createElement("li","omarSpacer");h.append(t)}var n=LPTools.createElement("li","omarSpacer");v.children().last().hasClass("omarSpacer")||v.append(n)}});var e=LPTools.createElement("li",{class:"extensionMenuItem addOmariaItem",value:"saveAll"},Strings.translateString("Save All Entered Data"));v.append(e),$('.addOmariaItem[value="saveAll"]').bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data",{domain:bg.lp_gettld_url(e.url)})}),bg.saveall()})},Me=function(){var e=j.getItemChildren(),t=[];return e.forEach(function(e){e._model.isFavorite()&&t.push(e._model.newDisplayObject())}),0<t.length?(L.show(),$("#omarFavoritesMenuItem").show(),s.removeClass("noFavorites"),!0):($("#omarFavoritesMenuItem").hide(),s.addClass("noFavorites"),L.hide(),!1)},Te=function(e){bg.lpevent("m_add"),"Account"===e?bg.get_selected_tab_data_no_extension(null,function(e){Ye({defaultData:{url:e?e.url:""}})}):je({defaultData:{notetype:e}})},De=function(){P.LP_removeAttr("style"),y.LP_removeAttr("style"),M.LP_removeAttr("style"),bg.is_user_debug_enabled()&&P.show(),bg.have_binary()&&bg.LPPlatform.isWin()&&y.show(),LPTools.hasProperties(bg.get("g_applications"))&&M.show(),LPFeatures.allowNotes()?$("#notesMenuItem").show():$("#notesMenuItem").hide()},Ae=function(e){if(e.isOmarSet&&(u=a.getElementById("omarIdentitiesMenuItem")),Y=LPProxy.getIdentities(),LPProxy.enableCurrentIdentity(Y),0<Y.length){ze(W);for(var t=[],n=0,o=Y.length;n<o;++n)t.push(Y[n].newDisplayObject());var i;new IdentityContainer(t,e).initialize(a.getElementById("identities"))}else $(u).hide()},$e=function(e){return!0===ue[e]},Fe=function(e,t){var n=function(e){var t=bg.lpmdec(e.extra,!0),n=/Language:(.+)/.exec(t);return n&&1<n.length?n[1].substr(0,2):"en"},o=[],i=[],a,r;for(a=0,r=me.length;a<r;++a){var s=LPProxy.getNoteModel(me[a].aid);if(s){var l=n(s._data);-1===i.indexOf(l)&&i.push(l)}}for(a=0,r=me.length;a<r;++a){var c=me[a].aid;if("account"===me[a].type)o.push(new MatchingAccountDisplay(LPProxy.getSiteModel(c)));else if("note"===me[a].type){var u=LPProxy.getNoteModel(c);o.push(new MatchingNoteDisplay(u,1<i.length?n(u._data):null))}}(ie=new Container(o,t)).setElement(e),ie.rebuildItems()},Be=function(e){for(var t=0,n=(me=bg.getmatchingsites(!1,!0,!1)).length;t<n;++t)ue[me[t].aid]=!0;var o;e.isZiggySet||LPProxy.getPreference("toplevelmatchingsites",!1)?(void 0!==parent.reduxApp&&parent.reduxApp.saveSettingsState("dropdownMatchingSites",me.length),s.addClass("matchingSitesIsVisible"),b.addClass("divider"),p.removeClass("hidden"),2<me.length?(s.addClass("matchingSitesOverTwo"),b.addClass("topLevelMatchesShadow"),$("#allMatchingSiteCounter").text(me.length),g.removeClass("hidden")):(b.removeClass("topLevelMatchesShadow"),0===me.length&&(b.removeClass("divider"),s.removeClass("matchingSitesIsVisible"),p.addClass("hidden"),g.addClass("hidden"))),Ge("topLevelMatchingSites",function(){Fe(i,$.extend({},e,{autoExpandSingleItem:!1,moreOptionsElement:a.getElementById("matchingSites"),moreOptionsState:ge.TopLevelMatchingSitesState,addLastClass:!1,trackAction:!0,source:"Suggestion",sortFunction:!!bg.get("LPContentScriptFeatures").web_client_fill||VaultItemBaseDisplay.prototype.sortOmarMatchingItems})),Pe()})()):(0===me.length?x.LP_removeAttr("style"):(x.show(),$("#matchingSiteCounter").text(me.length)),b.removeClass("divider"),b.removeClass("topLevelMatchesShadow"),s.removeClass("matchingSitesIsVisible"),p.addClass("hidden"))},Oe=function(){var e=bg.getClearRecentTime(),t=bg.Preferences.get("recentUsedCount"),n=null;(n=bg.get("LPContentScriptFeatures").omaria?j.getItemChildren():q.getItemChildren().concat(X.getItemChildren())).sort(VaultItemBaseDisplay.prototype.sortByMostRecent);for(var o=[],i=0,a=n.length;i<a&&i<t;++i){var r=n[i];r.getLastTouchValue()>=e&&o.push(r._model.newDisplayObject())}0<o.length?(oe=new Container(o,$.extend({},A,{sortFunction:VaultItemBaseDisplay.prototype.sortByMostRecent,separateFavorites:!1}))).initialize(c):Ze(c)},Ne=function(){var e=j.getItemChildren(),t;t=[],e.forEach(function(e){e._model.isFavorite()&&t.push(e._model.newDisplayObject())}),0<t.length?(Z=new Container(t,A,{sortFunction:VaultItemBaseDisplay.prototype.sortByNameAsc})).initialize(o):Ze(o)},Ue=function(){LPTools.removeDOMChildren(r);for(var e=Object.assign({},A,{source:"Search"}),t=0,n=ee.length;t<n;++t){var o=ee[t],i=o.build(e);o.postBuild(i,e),r.appendChild(i)}if(0===ee.length){var a=LPTools.buildEmptyPlaceholder(Strings.translateString("No Matching Results"),"extensionSearchPlaceholder",r);r.appendChild(a)}LPTools.addKeyBoardNavigation(r.children,{rightArrowSelector:".moreItem",selectFirst:!0,displayItems:ee}),H()},Re=(Ke=null,function(e){0<e.length?(re&&(ee&&ee.forEach(function(e){e.hideInContextOptions()}),ee=te.getSearchResultItems(e),Ue()),ae||(Xe("search",{applyKeyboardNav:!1,onPop:function(){C.val("")}}),ae=!0,bg.sendLpImprove("search",{source:"icon"}),segmentService("Extension Toolbar Menu Clicked",{Action:"Search"}))):Ke&&0<Ke.length&&(Qe(),ae=!1),Ke=e,H()}),Ke,ze=function(e){var t=Strings.translateString("Identities")+" ("+e.getName()+")",n=u.firstChild;3!==n.nodeType?(n=a.createTextNode(t),u.insertBefore(n,u.firstChild)):n.textContent=t},Ge=function(o,i){return function(){var e=this,t=arguments,n=function(){i.apply(e,t)};re?n():de[o]=n}},Ve=function(e){e&&(e.stopPropagation(),e.preventDefault())},He=function(e){for(var t=null;null!==e&&null===(t=e.getAttribute("childview"));)e=e.parentElement;return t},We=function(e){return(e=e||{}).saveOptions={source:"icon"},e},Ye=function(e){bg.LPPlatform.openTabDialog("site",We(e))},je=function(e){bg.LPPlatform.openTabDialog("note",We(e))},qe=function(e){bg.LPPlatform.openTabDialog("formFill",We(e))},Ze=function(e){e.appendChild(LPTools.createElement("li","extensionMenuItem none",bg.gs("None Available")))},Xe=function(e,t){pe.push(new ge.CSSState(e,t)),H()},Qe=function(e){var t=pe.pop();t&&t.pop(e),H()},Je=dialogs.generatePassword,et=function(){Je.getDialog().close(),I.unbind("click",et)},tt=null,nt=function(){!0===bg.get("LPContentScriptFeatures").better_generate_password_enabled&&(Je=dialogs.betterGeneratePassword),Je.open({preSetup:function(e){if(null===tt){var t=Je.parentElementID,n=e.options.hideHeader,o=e.dynamicHeight;tt=function(){Je.parentElementID=t,e.options.hideHeader=n,e.useDynamicHeignt(o)}}Je.parentElementID="extensionDropdownGeneratePassword",e.options.hideHeader=!0,e.useDynamicHeignt(!1)},postSetup:function(){H()},onClose:function(){Qe()},onCopy:function(){LPPlatform.closePopup(!0)},saveOptions:{source:"icon"}}),I.unbind("click",et),I.bind("click",et)},ot=function(e,t,n,o,i){if(i=i||"Generic",e.isEmpty()){var a=LPTools.createElement("div","emptyView");a.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t+".png",class:"emptyViewIcon"})),a.appendChild(LPTools.createElement("h1","emptyViewText",n));var r=LPTools.createElement("input",{class:"addItem rbtn",type:"button",value:o,tabindex:-1});r.appendChild(LPTools.createElement("i","fa fa-trash")),a.appendChild(r),r.addEventListener("click",function(e){Te(i)}),LPTools.addKeyBoardNavigation($(r),{selectFirst:!0}),document.getElementById("items").appendChild(a)}},it=function(e,t,n){if(e.isEmpty()){var o=LPTools.createElement("div","emptyView");o.appendChild(LPTools.createElement("img",{src:"images/vault_4.0/"+t,class:"emptyViewIcon"})),o.appendChild(LPTools.createElement("h1","emptyViewText",n)),document.getElementById("items").appendChild(o)}},at=function(){bg.LPPartner&&bg.LPPartner.getPartnerInfo&&bg.LPPartner.getPartnerInfo(function(e){e&&($(r).addClass("partner-logo"),D.attr("src",e.logoUrl).removeClass(e.class).addClass(e.class),T.show(),s.addClass("partner"),H())})},rt=function(e){var t=bg.getmatchingsites(!1,!0,!1),n=2;e.hasFavorites&&--n;var o=!t||t.length<=n;if(LPFeatures.isPromotionMenuItemG2mEnabled())mt(o);else if(LPFeatures.isPromotionMenuItemG2aEnabled())dt(o);else if(LPFeatures.isPromotionMenuItemG2wEnabled())pt(o);else if(LPFeatures.allowGift()&&!LPProxy.isEnterpriseUser()&&o){var i=$("#specialOfferMenuItem");i.show(),i.unbind("click.ad_event").bind("click.ad_event",function(){bg.sendLpImprove("lpgift_ad_clicked"),bg.openURL(LPProxy.getBaseURL()+"gift.php")})}},st=dialogs.siteFeedback,lt=function(){st.getDialog().resetPage(),st.getDialog().close(),I.unbind("click",lt),I.bind("click",Qe)},ct=function(){st.open({preSetup:function(e){st.parentElementID="siteFeedback",e.options.hideHeader=!0,e.useDynamicHeignt(!1)},postSetup:function(){H()},onClose:function(){Qe()}}),I.unbind("click",Qe),I.bind("click",lt)};function ut(){return[Object.assign({},AuroraAccount.prototype.createGoToAssistData.call()),Object.assign({},AuroraAccount.prototype.createGoToWebinarData.call())]}function mt(e){var t=AuroraAccount.products.g2ma;gt({name:t.name,urlConfigKey:"g2ma",storageKey:"promotion_"+t.productId+"_clicked_"+bg.get("g_username_hash"),trackingProductId:t.productId,backgroundImage:"images/vault_4.0/promotion/logo-gotomeeting-lmi.png"},e)}function dt(e){var t=AuroraAccount.products.g2a,n=AuroraAccount.prototype.createGoToAssistData.call();gt({name:t.name,urlConfigKey:"g2a",storageKey:n.storageKey,trackingProductId:t.productId,backgroundImage:"images/vault_4.0/promotion/logo-gotoassist-lmi.png"},e)}function pt(e){var t=AuroraAccount.products.g2w,n=AuroraAccount.prototype.createGoToWebinarData.call();gt({name:t.name,urlConfigKey:"g2w",storageKey:n.storageKey,trackingProductId:t.productId,backgroundImage:"images/vault_4.0/promotion/logo-gotowebinar-lmi.png"},e)}function gt(e,t){if(t){var n=$("#promotionMenuItem");bg.sendLpImprove("promotion_extension_menu_item_shown",{recommendedProduct:e.trackingProductId}),n.css("background-image","url("+e.backgroundImage+")"),n.unbind("click"),n.bind("click",function(){ft(e)}),n.show()}else bg.sendLpImprove("promotion_extension_menu_item_not_shown",{recommendedProduct:e.trackingProductId})}function ft(e){var t={name:e.name,urlConfigKey:e.urlConfigKey,storageKey:e.storageKey,segmentEvent:"promotion_extension_menu_item_clicked",segmentEventProperties:{recommendedProduct:e.trackingProductId}};localStorage.getItem(e.storageKey)?Pt(t):yt(t)}function bt(t){var n=null,e;return{recommendation:ut().find(function(e){return!!e.competitorProductNames.find(function(e){return!!e.toLowerCase().includes(t.toLowerCase())&&(n=e.toLowerCase(),!0)})}),matchSource:"search_text",searchToken:n}}function vt(){var n=null,e;return{recommendation:ut().find(function(e){return!!e.searchResultKeywords.find(function(t){return!!ee.find(function(e){return!!e.getDisplayName().toLowerCase().includes(t.toLowerCase())&&(n=t.toLowerCase(),!0)})})}),matchSource:"search_result",searchToken:n}}function ht(e){return ee.length?vt():3<e.length?bt(e):void 0}function _t(t){t&&t.recommendation&&($('<li class="extensionMenuItem item promotionSearch" title="Launch '+t.recommendation.name+'" aria-label="Site: '+t.recommendation.name+'"><div class="text">From the makers of LastPass. Try it for free.</div><div class="image"><img src="'+t.recommendation.imageUrl+'" /></div></li>').hover(function(){$(this).addClass("hover")},function(){$(this).removeClass("hover")}).click(function(){var e={name:t.recommendation.name,urlConfigKey:t.recommendation.auroraId,storageKey:t.recommendation.storageKey,segmentEvent:"promotion_extension_search_clicked",segmentEventProperties:{product:t.recommendation.auroraId,searchToken:t.searchToken,matchSource:t.matchSource}};localStorage.getItem(t.recommendation.storageKey)?Pt(e):yt(e)}).appendTo("#searchResults"),bg.sendLpImprove("promotion_extension_search_shown",{product:t.recommendation.auroraId,searchToken:t.searchToken,matchSource:t.matchSource}))}function It(e){var t;_t(ht(e))}function Pt(t){bg.BackgroundServer.aurora.getOneClickSignupUrls({success:function(e){e&&e[t.urlConfigKey]&&(bg.openURL(e[t.urlConfigKey].login),bg.sendLpImprove(t.segmentEvent,t.segmentEventProperties))}})}function yt(t){bg.BackgroundServer.aurora.getOneClickSignupUrls({success:function(e){e&&e[t.urlConfigKey]&&(Et(e[t.urlConfigKey].signup),xt(e[t.urlConfigKey].login,t.name),bg.localStorage_setItem(t.storageKey,1),bg.sendLpImprove(t.segmentEvent,t.segmentEventProperties))}})}function xt(e,t){e&&(new Account).addFromDialog({name:t,url:e},null,{success:function(){return null}})}function Et(e){e&&bg.openURL(e)}C.LP_addSearchHandlers("inputDialog",function(e){Re(e),LPFeatures.isPromotionExtensionSearchEnabled()&&It(e)}),I.bind("click",Qe);var Lt=function(e){Xe(He(e.target),{selectFirst:!e.originalEvent.isTrusted}),Ve(e)};$("[childview]").bind("click",Lt),$("#addSite").bind("click",function(e){bg.get_selected_tab_data_no_extension(null,function(e){bg.lpevent("m_add"),Ye({defaultData:{url:e?e.url:""}}),LPPlatform.closePopup()}),e.stopPropagation()}),$("#saveAllEnteredData").bind("click",function(){bg.lpevent("m_saed"),bg.get_selected_tab_data(null,function(e){bg.sendLpImprove("save_all_entered_data")}),bg.saveall()}),$("#addNote").bind("click",function(){bg.lpevent("m_addn"),je()}),$("#addFormFill").bind("click",function(){bg.lpevent("m_af"),qe()}),$("#addCreditCard").bind("click",function(){bg.lpevent("m_af"),qe({defaultData:{profiletype:FormFill.prototype.FORM_FILL_TYPE_CREDIT_CARD}})}),$("#clearForms").bind("click",function(){bg.lpevent("m_clrf"),bg.clearforms("icon")}),$("#siteFeedbackMenuItem").bind("click",function(){bg.Preferences.set("hasClickedSiteFeedback",!0);var e={Item:"Site Feedback"};bg.LPModule.callService("Segment","sendTypedEvent",["ExtensionMenuItemClicked",e],function(e){e&&console.error(e)})});var St=function(){var e={Item:"Account Options"};bg.LPModule.callService("Segment","sendTypedEvent",["ExtensionMenuItemClicked",e],function(e){e&&console.error(e)})};$("#optionsMenuItem").bind("click",function(){St()}),$("#optionsMenuItemEnt").bind("click",function(){St()});var wt=null,kt,Ct,Mt,Tt;$("#chooseProfile").bind("click",function(){dialogs.chooseProfile.open({preSetup:function(e){if(null===wt){var t=dialogs.chooseProfile.parentElementID,n=e.options.hideHeader;wt=function(){dialogs.chooseProfile.parentElementID=t,e.options.hideHeader=n,e.$element.css("min-height","")}}e.$element.css("min-height",0),dialogs.chooseProfile.parentElementID="chooseProfileCreditCard",e.options.hideHeader=!0},onClose:function(){Qe()},saveOptions:{source:"icon"}})}),$("#vaultMenuItem").bind("click",function(){bg.lpevent("m_ov"),bg.openvault()}),$("#sitesMenuItem").bind("click",Ge("sites",function(e){q.rebuildItems(n,!e.originalEvent.isTrusted),it(q,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#formFillsMenuItem").bind("click",Ge("formFills",function(e){Q.rebuildItems(n,!e.originalEvent.isTrusted),it(Q,"Empty_Form.png",Strings.translateString("Fill Every Form"))})),$("#applicationsMenuItem").bind("click",Ge("applications",function(e){J.rebuildItems(n,!e.originalEvent.isTrusted),it(J,"Empty_Site.png",Strings.translateString("Remember every password"))})),$("#generateMenuItem").bind("click",nt),$("#securityDashboardMenuItem").bind("click",function(){bg.lpevent("m_sd"),bg.openvault(!1,"opendashboard")}),$("#notesMenuItem").bind("click",Ge("notes",function(e){X.rebuildItems(n,!e.originalEvent.isTrusted),it(X,"Empty_Note.png",Strings.translateString("Store Every Note"))})),$("#clearMostRecent").bind("click",function(){bg.clearrecent(),LPTools.removeDOMChildren(c),Ze(c)}),$("#siteFeedbackMenuItem").bind("click",ct);var Dt=Ge("mostRecent",function(e){se||(Oe(),se=!0),LPTools.addKeyBoardNavigation(c.children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted,displayItems:oe?oe.getItems():null})});E.bind("click",Dt);var At=Ge("sites",function(e){bg.get("LPContentScriptFeatures").omaria&&!ce&&(Ne(),ce=!0,LPTools.addKeyBoardNavigation(o.children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted,displayItems:Z?Z.getItems():null}))});L.bind("click",At);var $t=Ge("matchingSites",function(e){le||(Fe(t,A),le=!0),LPTools.addKeyBoardNavigation(a.getElementById("matchingSites").children,{rightArrowSelector:".moreItem",selectFirst:!e.originalEvent.isTrusted})});x.bind("click",$t),g.bind("click",$t),$("#prefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#helpMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#adminConsoleMenuItem").bind("click",function(){bg.lpevent("m_oec"),bg.openentconsole()}),$("#logoutMenuItem, #optionsViewLogoutMenuItem").bind("click",function(e){bg.sendLpImprove("logout_clicked",{source:"icon"}),bg.lpevent("m_lo"),bg.get("g_issafari_appext")&&($("#extensionDropdown").removeClass("panelIsActive"),$("#extensionDropdown").removeClass("expirationSet"),$("#notificationContainer").empty(),$("#panelContainer").empty()),e.stopPropagation(),setTimeout(function(){bg.loggedOut(!1,"menu"),LPPlatform.closePopup()})}),$("#favoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#aboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),P.bind("click",function(){bg.lpevent("m_dbgcon"),bg.opendebugtab()}),$("#csvExportMenuItem").bind("click",function(){bg.lpevent("m_e"),bg.sendLpImprove("Export",{source:"Dropdown"}),bg.openexport()}),$("#formFillExportMenuItem").bind("click",function(){bg.lpevent("m_eff"),bg.sendLpImprove("Export",{source:"Dropdown"}),bg.formfillexport()}),$("#encryptedExportMenuItem").bind("click",function(){bg.lpevent("m_elp"),bg.sendLpImprove("Export",{source:"Dropdown"}),bg.openlastpassexport()}),y.bind("click",function(){bg.lpevent("m_ewlan"),bg.wlanexport()}),$("#printSitesMenuItem").bind("click",function(){bg.lpevent("m_p"),bg.openprint(!1)}),$("#printNotesMenuItem").bind("click",function(){bg.lpevent("m_pn"),bg.openprint(!0)}),$("#refreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#clearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#myAccountMenuItem").bind("click",function(){bg.lpevent("m_mya"),bg.openmyaccount()}),$("#sessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),$(".extensionMenuItem").bind("click",function(){H()}),LPPlatform.addEventListener(window,"unload",function(){Ot()}),s.on("click",".extensionMenuItem, .footer, .contextOptionsDropdown",function(){LPPlatform.closePopup()}),$("#omarFavoritesMenuItem").bind("click",function(){bg.lpevent("m_of"),bg.openfavorites(!1,"icon")}),$("#omarPrefMenuItem").bind("click",function(){bg.lpevent("m_op"),bg.openprefs()}),$("#omarSupportMenuItem").bind("click",function(){bg.lpevent("m_oh"),bg.openhelp()}),$("#omarAboutMenuItem").bind("click",function(){bg.lpevent("m_abt"),bg.openabout()}),$("#omarRefreshMenuItem").bind("click",function(){bg.lpevent("m_ref"),LPProxy.refreshSites()}),$("#omarClearCachMenuItem").bind("click",function(){bg.lpevent("m_cl"),bg.clearCache(!1,!0,!1)}),$("#omarSessionsMenuItem").bind("click",function(){bg.lpevent("m_ses"),bg.opensessions()}),$("#safariMessageButton").bind("click",function(){bg.openURL("https://lastpass.com/safariAppExtension.php?source=dropdown"),LPPlatform.closePopup()}),Topics.get(Topics.REFRESH_DATA).subscribe(function(){Ee()}),Topics.get(Topics.PUSH_STATE).subscribe(function(e){pe.push(e)}),Topics.get(Topics.EDIT_SITE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),Ye(e)}),Topics.get(Topics.EDIT_NOTE).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),je(e)}),Topics.get(Topics.EDIT_FORM_FILL).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),qe(e)}),Topics.get(Topics.EDIT_APPLICATION).subscribe(function(e){e.vaultItem=e.vaultItem.getID(),bg.LPPlatform.openTabDialog("application",e)}),Topics.get(Topics.IDENTITY_ENABLE).subscribe(function(e){LPProxy.enableIdentity(e),W=e}),Topics.get(Topics.CONFIRM).subscribe(function(e){Ft("confirmation",e)}),Topics.get(Topics.ERROR).subscribe(function(e){e&&Ft("alert",{title:Strings.Vault.ERROR,text:e})}),Topics.get(Topics.REPROMPT).subscribe(function(e){Ft("reprompt",{successCallback:e})}),Topics.get(Topics.LEFT_ARROW).subscribe(function(){LPTools.disableMouse(),Qe(!0)}),Topics.get(Topics.CLEAR_DATA).subscribe(function(){for(var e=pe.length-1;-1<e;--e)pe[e].pop();pe=[],LPTools.setNavIndex(0),C.val(""),ce=le=se=re=ae=!1,ue={},de={},me=null,tt&&tt(),wt&&wt(),w.removeClass("initialized"),bg.get("g_issafari_appext")&&($("#extensionDropdown").removeClass("panelIsActive"),$("#extensionDropdown").removeClass("expirationSet"),$("#notificationContainer").empty(),$("#panelContainer").empty()),h.empty(),v.empty(),Dialog.prototype.closeAllDialogs(!0)}),Topics.get(Topics.INITIALIZED).subscribe(function(){Strings.translate(a.body),LPPlatform.setupDropdownImportMenu(w)});var Ft=function(e,t){$("#container").LP_hide(),LPTools.removeKeyBoardNavigation(),t=$.extend(t,{onResize:function(e,t){LPPlatform.setDropdownPopoverSize(e,t)},onClose:function(){LPPlatform.closePopup()}}),LPDialog.openDialog(e,t)},Bt,Ot=function(){Topics.get(Topics.CLEAR_DATA).publish()},Nt,Ut=(Rt=function(){bg.getData({context:"extensionDropdown",callback:function(){_e()}})},Kt={},zt=function(e){LPPlatform.move(screenY-(e.screenY-Kt.y),e.screenX-Kt.x)},function(){F=!0,document.body.classList.add("quickSearch"),window.addEventListener("mousedown",function(e){e.target===document.getElementById("searchContainer")&&(Kt.x=e.clientX,Kt.y=e.clientY,window.addEventListener("mousemove",zt),e.preventDefault())}),window.addEventListener("mouseup",function(){window.removeEventListener("mousemove",zt)}),Topics.get(Topics.ESCAPE).subscribe(function(){LPPlatform.doClosePopup()}),Account.prototype.getDisplayClass=function(){return MatchingAccountDisplay},"undefined"!=typeof bg?Rt():LPPlatform.initialize({context:"extensionDropdown",callback:Rt})}),Rt,Kt,zt;return{setup:_e,State:ge,isMatchingSite:$e,setGroupLabel:fe,open:function(){var e=bg.get("g_badgedata");if(e&&"notification"===e.cmd){switch(e.type){case"error":Ft("notification",{notification:bg.get("g_notification_data")});break;case"mpwchange":Ft("securityNotice",{notification:bg.get("g_notification_data")});break;case"lpalert":Ft("breachAlert",{notification:bg.get("g_notification_data")})}bg.clear_badge()}else e&&"migration"===e.cmd?(Ft("migration",{notification:e}),bg.clear_badge()):_e()},openDialog:Ft,reset:Ot,setBigIcons:function(e){bg.set("g_bigicons",e)},openQuickSearch:Ut,setSize:H}}(document);