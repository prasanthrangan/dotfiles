!function(){var e={659:function(e){"use strict";var s=Object.prototype.hasOwnProperty,r="~";function t(){}function n(e,s,r){this.fn=e,this.context=s,this.once=r||!1}function a(e,s,t,a,i){if("function"!=typeof t)throw new TypeError("The listener must be a function");var o=new n(t,a||e,i),g=r?r+s:s;return e._events[g]?e._events[g].fn?e._events[g]=[e._events[g],o]:e._events[g].push(o):(e._events[g]=o,e._eventsCount++),e}function i(e,s){0==--e._eventsCount?e._events=new t:delete e._events[s]}function o(){this._events=new t,this._eventsCount=0}Object.create&&(t.prototype=Object.create(null),(new t).__proto__||(r=!1)),o.prototype.eventNames=function(){var e,t,n=[];if(0===this._eventsCount)return n;for(t in e=this._events)s.call(e,t)&&n.push(r?t.slice(1):t);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(e)):n},o.prototype.listeners=function(e){var s=r?r+e:e,t=this._events[s];if(!t)return[];if(t.fn)return[t.fn];for(var n=0,a=t.length,i=new Array(a);n<a;n++)i[n]=t[n].fn;return i},o.prototype.listenerCount=function(e){var s=r?r+e:e,t=this._events[s];return t?t.fn?1:t.length:0},o.prototype.emit=function(e,s,t,n,a,i){var o=r?r+e:e;if(!this._events[o])return!1;var g,m,l=this._events[o],A=arguments.length;if(l.fn){switch(l.once&&this.removeListener(e,l.fn,void 0,!0),A){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,s),!0;case 3:return l.fn.call(l.context,s,t),!0;case 4:return l.fn.call(l.context,s,t,n),!0;case 5:return l.fn.call(l.context,s,t,n,a),!0;case 6:return l.fn.call(l.context,s,t,n,a,i),!0}for(m=1,g=new Array(A-1);m<A;m++)g[m-1]=arguments[m];l.fn.apply(l.context,g)}else{var c,u=l.length;for(m=0;m<u;m++)switch(l[m].once&&this.removeListener(e,l[m].fn,void 0,!0),A){case 1:l[m].fn.call(l[m].context);break;case 2:l[m].fn.call(l[m].context,s);break;case 3:l[m].fn.call(l[m].context,s,t);break;case 4:l[m].fn.call(l[m].context,s,t,n);break;default:if(!g)for(c=1,g=new Array(A-1);c<A;c++)g[c-1]=arguments[c];l[m].fn.apply(l[m].context,g)}}return!0},o.prototype.on=function(e,s,r){return a(this,e,s,r,!1)},o.prototype.once=function(e,s,r){return a(this,e,s,r,!0)},o.prototype.removeListener=function(e,s,t,n){var a=r?r+e:e;if(!this._events[a])return this;if(!s)return i(this,a),this;var o=this._events[a];if(o.fn)o.fn!==s||n&&!o.once||t&&o.context!==t||i(this,a);else{for(var g=0,m=[],l=o.length;g<l;g++)(o[g].fn!==s||n&&!o[g].once||t&&o[g].context!==t)&&m.push(o[g]);m.length?this._events[a]=1===m.length?m[0]:m:i(this,a)}return this},o.prototype.removeAllListeners=function(e){var s;return e?(s=r?r+e:e,this._events[s]&&i(this,s)):(this._events=new t,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=r,o.EventEmitter=o,e.exports=o},412:function(e,s){var r,t;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,r=function(e){"use strict";if("object"!=typeof globalThis||"object"!=typeof chrome||!chrome||!chrome.runtime||!chrome.runtime.id)throw new Error("This script should only be loaded in a browser extension.");if(void 0===globalThis.browser||Object.getPrototypeOf(globalThis.browser)!==Object.prototype){const s="The message port closed before a response was received.",r="Returning a Promise is the preferred way to send a reply from an onMessage/onMessageExternal listener, as the sendResponse will be removed from the specs (See https://developer.mozilla.org/docs/Mozilla/Add-ons/WebExtensions/API/runtime/onMessage)",t=e=>{const t={alarms:{clear:{minArgs:0,maxArgs:1},clearAll:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getAll:{minArgs:0,maxArgs:0}},bookmarks:{create:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},getChildren:{minArgs:1,maxArgs:1},getRecent:{minArgs:1,maxArgs:1},getSubTree:{minArgs:1,maxArgs:1},getTree:{minArgs:0,maxArgs:0},move:{minArgs:2,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeTree:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}},browserAction:{disable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},enable:{minArgs:0,maxArgs:1,fallbackToNoCallback:!0},getBadgeBackgroundColor:{minArgs:1,maxArgs:1},getBadgeText:{minArgs:1,maxArgs:1},getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},openPopup:{minArgs:0,maxArgs:0},setBadgeBackgroundColor:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setBadgeText:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},browsingData:{remove:{minArgs:2,maxArgs:2},removeCache:{minArgs:1,maxArgs:1},removeCookies:{minArgs:1,maxArgs:1},removeDownloads:{minArgs:1,maxArgs:1},removeFormData:{minArgs:1,maxArgs:1},removeHistory:{minArgs:1,maxArgs:1},removeLocalStorage:{minArgs:1,maxArgs:1},removePasswords:{minArgs:1,maxArgs:1},removePluginData:{minArgs:1,maxArgs:1},settings:{minArgs:0,maxArgs:0}},commands:{getAll:{minArgs:0,maxArgs:0}},contextMenus:{remove:{minArgs:1,maxArgs:1},removeAll:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},cookies:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:1,maxArgs:1},getAllCookieStores:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},devtools:{inspectedWindow:{eval:{minArgs:1,maxArgs:2,singleCallbackArg:!1}},panels:{create:{minArgs:3,maxArgs:3,singleCallbackArg:!0},elements:{createSidebarPane:{minArgs:1,maxArgs:1}}}},downloads:{cancel:{minArgs:1,maxArgs:1},download:{minArgs:1,maxArgs:1},erase:{minArgs:1,maxArgs:1},getFileIcon:{minArgs:1,maxArgs:2},open:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},pause:{minArgs:1,maxArgs:1},removeFile:{minArgs:1,maxArgs:1},resume:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},extension:{isAllowedFileSchemeAccess:{minArgs:0,maxArgs:0},isAllowedIncognitoAccess:{minArgs:0,maxArgs:0}},history:{addUrl:{minArgs:1,maxArgs:1},deleteAll:{minArgs:0,maxArgs:0},deleteRange:{minArgs:1,maxArgs:1},deleteUrl:{minArgs:1,maxArgs:1},getVisits:{minArgs:1,maxArgs:1},search:{minArgs:1,maxArgs:1}},i18n:{detectLanguage:{minArgs:1,maxArgs:1},getAcceptLanguages:{minArgs:0,maxArgs:0}},identity:{launchWebAuthFlow:{minArgs:1,maxArgs:1}},idle:{queryState:{minArgs:1,maxArgs:1}},management:{get:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},getSelf:{minArgs:0,maxArgs:0},setEnabled:{minArgs:2,maxArgs:2},uninstallSelf:{minArgs:0,maxArgs:1}},notifications:{clear:{minArgs:1,maxArgs:1},create:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:0},getPermissionLevel:{minArgs:0,maxArgs:0},update:{minArgs:2,maxArgs:2}},pageAction:{getPopup:{minArgs:1,maxArgs:1},getTitle:{minArgs:1,maxArgs:1},hide:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setIcon:{minArgs:1,maxArgs:1},setPopup:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},setTitle:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0},show:{minArgs:1,maxArgs:1,fallbackToNoCallback:!0}},permissions:{contains:{minArgs:1,maxArgs:1},getAll:{minArgs:0,maxArgs:0},remove:{minArgs:1,maxArgs:1},request:{minArgs:1,maxArgs:1}},runtime:{getBackgroundPage:{minArgs:0,maxArgs:0},getPlatformInfo:{minArgs:0,maxArgs:0},openOptionsPage:{minArgs:0,maxArgs:0},requestUpdateCheck:{minArgs:0,maxArgs:0},sendMessage:{minArgs:1,maxArgs:3},sendNativeMessage:{minArgs:2,maxArgs:2},setUninstallURL:{minArgs:1,maxArgs:1}},sessions:{getDevices:{minArgs:0,maxArgs:1},getRecentlyClosed:{minArgs:0,maxArgs:1},restore:{minArgs:0,maxArgs:1}},storage:{local:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}},managed:{get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1}},sync:{clear:{minArgs:0,maxArgs:0},get:{minArgs:0,maxArgs:1},getBytesInUse:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}}},tabs:{captureVisibleTab:{minArgs:0,maxArgs:2},create:{minArgs:1,maxArgs:1},detectLanguage:{minArgs:0,maxArgs:1},discard:{minArgs:0,maxArgs:1},duplicate:{minArgs:1,maxArgs:1},executeScript:{minArgs:1,maxArgs:2},get:{minArgs:1,maxArgs:1},getCurrent:{minArgs:0,maxArgs:0},getZoom:{minArgs:0,maxArgs:1},getZoomSettings:{minArgs:0,maxArgs:1},goBack:{minArgs:0,maxArgs:1},goForward:{minArgs:0,maxArgs:1},highlight:{minArgs:1,maxArgs:1},insertCSS:{minArgs:1,maxArgs:2},move:{minArgs:2,maxArgs:2},query:{minArgs:1,maxArgs:1},reload:{minArgs:0,maxArgs:2},remove:{minArgs:1,maxArgs:1},removeCSS:{minArgs:1,maxArgs:2},sendMessage:{minArgs:2,maxArgs:3},setZoom:{minArgs:1,maxArgs:2},setZoomSettings:{minArgs:1,maxArgs:2},update:{minArgs:1,maxArgs:2}},topSites:{get:{minArgs:0,maxArgs:0}},webNavigation:{getAllFrames:{minArgs:1,maxArgs:1},getFrame:{minArgs:1,maxArgs:1}},webRequest:{handlerBehaviorChanged:{minArgs:0,maxArgs:0}},windows:{create:{minArgs:0,maxArgs:1},get:{minArgs:1,maxArgs:2},getAll:{minArgs:0,maxArgs:1},getCurrent:{minArgs:0,maxArgs:1},getLastFocused:{minArgs:0,maxArgs:1},remove:{minArgs:1,maxArgs:1},update:{minArgs:2,maxArgs:2}}};if(0===Object.keys(t).length)throw new Error("api-metadata.json has not been included in browser-polyfill");class n extends WeakMap{constructor(e,s){super(s),this.createItem=e}get(e){return this.has(e)||this.set(e,this.createItem(e)),super.get(e)}}const a=(s,r)=>(...t)=>{e.runtime.lastError?s.reject(new Error(e.runtime.lastError.message)):r.singleCallbackArg||t.length<=1&&!1!==r.singleCallbackArg?s.resolve(t[0]):s.resolve(t)},i=e=>1==e?"argument":"arguments",o=(e,s,r)=>new Proxy(s,{apply:(s,t,n)=>r.call(t,e,...n)});let g=Function.call.bind(Object.prototype.hasOwnProperty);const m=(e,s={},r={})=>{let t=Object.create(null),n={has:(s,r)=>r in e||r in t,get(n,l,A){if(l in t)return t[l];if(!(l in e))return;let c=e[l];if("function"==typeof c)if("function"==typeof s[l])c=o(e,e[l],s[l]);else if(g(r,l)){let s=((e,s)=>function(r,...t){if(t.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${i(s.minArgs)} for ${e}(), got ${t.length}`);if(t.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${i(s.maxArgs)} for ${e}(), got ${t.length}`);return new Promise(((n,i)=>{if(s.fallbackToNoCallback)try{r[e](...t,a({resolve:n,reject:i},s))}catch(a){console.warn(`${e} API method doesn't seem to support the callback parameter, falling back to call it without a callback: `,a),r[e](...t),s.fallbackToNoCallback=!1,s.noCallback=!0,n()}else s.noCallback?(r[e](...t),n()):r[e](...t,a({resolve:n,reject:i},s))}))})(l,r[l]);c=o(e,e[l],s)}else c=c.bind(e);else if("object"==typeof c&&null!==c&&(g(s,l)||g(r,l)))c=m(c,s[l],r[l]);else{if(!g(r,"*"))return Object.defineProperty(t,l,{configurable:!0,enumerable:!0,get:()=>e[l],set(s){e[l]=s}}),c;c=m(c,s[l],r["*"])}return t[l]=c,c},set:(s,r,n,a)=>(r in t?t[r]=n:e[r]=n,!0),defineProperty:(e,s,r)=>Reflect.defineProperty(t,s,r),deleteProperty:(e,s)=>Reflect.deleteProperty(t,s)},l=Object.create(e);return new Proxy(l,n)},l=e=>({addListener(s,r,...t){s.addListener(e.get(r),...t)},hasListener:(s,r)=>s.hasListener(e.get(r)),removeListener(s,r){s.removeListener(e.get(r))}}),A=new n((e=>"function"!=typeof e?e:function(s){const r=m(s,{},{getContent:{minArgs:0,maxArgs:0}});e(r)}));let c=!1;const u=new n((e=>"function"!=typeof e?e:function(s,t,n){let a,i,o=!1,g=new Promise((e=>{a=function(s){c||(console.warn(r,(new Error).stack),c=!0),o=!0,e(s)}}));try{i=e(s,t,a)}catch(e){i=Promise.reject(e)}const m=!0!==i&&((l=i)&&"object"==typeof l&&"function"==typeof l.then);var l;if(!0!==i&&!m&&!o)return!1;return(m?i:g).then((e=>{n(e)}),(e=>{let s;s=e&&(e instanceof Error||"string"==typeof e.message)?e.message:"An unexpected error occurred",n({__mozWebExtensionPolyfillReject__:!0,message:s})})).catch((e=>{console.error("Failed to send onMessage rejected reply",e)})),!0})),h=({reject:r,resolve:t},n)=>{e.runtime.lastError?e.runtime.lastError.message===s?t():r(new Error(e.runtime.lastError.message)):n&&n.__mozWebExtensionPolyfillReject__?r(new Error(n.message)):t(n)},x=(e,s,r,...t)=>{if(t.length<s.minArgs)throw new Error(`Expected at least ${s.minArgs} ${i(s.minArgs)} for ${e}(), got ${t.length}`);if(t.length>s.maxArgs)throw new Error(`Expected at most ${s.maxArgs} ${i(s.maxArgs)} for ${e}(), got ${t.length}`);return new Promise(((e,s)=>{const n=h.bind(null,{resolve:e,reject:s});t.push(n),r.sendMessage(...t)}))},d={devtools:{network:{onRequestFinished:l(A)}},runtime:{onMessage:l(u),onMessageExternal:l(u),sendMessage:x.bind(null,"sendMessage",{minArgs:1,maxArgs:3})},tabs:{sendMessage:x.bind(null,"sendMessage",{minArgs:2,maxArgs:3})}},f={clear:{minArgs:1,maxArgs:1},get:{minArgs:1,maxArgs:1},set:{minArgs:1,maxArgs:1}};return t.privacy={network:{"*":f},services:{"*":f},websites:{"*":f}},m(e,d,t)};e.exports=t(chrome)}else e.exports=globalThis.browser},void 0===(t=r.apply(s,[e]))||(e.exports=t)}},s={};function r(t){var n=s[t];if(void 0!==n)return n.exports;var a=s[t]={exports:{}};return e[t].call(a.exports,a,a.exports,r),a.exports}r.n=function(e){var s=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(s,{a:s}),s},r.d=function(e,s){for(var t in s)r.o(s,t)&&!r.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},r.o=function(e,s){return Object.prototype.hasOwnProperty.call(e,s)},function(){"use strict";var e=r(412),s=r.n(e);const t=Object.keys({pause:!1,mode:"upscale",toggle_pause:"Control+Shift+X",toggle_mode:"Control+Shift+Z"});Object.keys({normal:"uwv-normal",upscale:"uwv-upscale",stretch:"uwv-stretch"});var n=r(659),a=r.n(n);class i extends(a()){constructor(e=document,s=3){super(),this.element=e,this.lastKey=null,this.keys=[],this.limit=s,this.onKeyDown=this.onKeyPress.bind(this),this.onKeyUp=this.onKeyRelease.bind(this)}onKeyPress(e){e.defaultPrevented||e.repeat||e.metaKey||(this.keys.includes(e.key)||this.keys.push(e.key),this.keys.sort(),this.keys.length===this.limit&&(this.lastKey=e.key,this.emit("fulfilled",this.keys.join("+"))))}onKeyRelease(e){this.keys.splice(this.keys.indexOf(e.key),1),this.lastKey===e.key&&(this.lastKey=null)}startRecording(){this.element.addEventListener("keydown",this.onKeyDown,!0),this.element.addEventListener("keyup",this.onKeyUp,!0)}stopRecording(){this.keys=[],this.lastKey=null,this.element.removeEventListener("keydown",this.onKeyDown,!0),this.element.removeEventListener("keyup",this.onKeyUp,!0)}}var o=i;const g=new class extends class{constructor(e="local"){this.storage=s().storage[e],this._data={}}set(e){this.storage.set(e)}get(e){return this.storage.get(e)}onChange(e){s().storage.onChanged.addListener(e)}async syncData(){return this._data=await this.get(t),Promise.resolve(this._data)}set data(e){this._data=e}get data(){return this._data}}{constructor(){super(),this.elements=document.querySelectorAll("input"),this.shortcutElements=this.filterShortcutElements()}filterShortcutElements(){return Array.from(this.elements).filter((e=>e.id.includes("toggle")))}async syncElementsWithStorage(){this.elements.forEach((e=>{switch(e.dataset.category){case"master":e.checked=this.data.pause;break;case"modes":e.checked=e.id===this.data.mode;break;case"shortcuts":e.value=this.data[e.id]}}))}registerChangeEvent(){document.addEventListener("change",this.updateStorage.bind(this),!1)}handleShortcutElementsInteractivity(){this.shortcutElements.forEach((e=>{const s=new o(e),r=new Event("change",{bubbles:!0});e.addEventListener("focus",(()=>{s.startRecording(),e.value=""})),s.on("fulfilled",(t=>{this.set({[e.id]:t}),s.stopRecording(),e.value=t,e.blur(),e.dispatchEvent(r)}))}))}updateStorage({target:e}){switch(e.dataset.category){case"master":this.set({pause:e.checked});break;case"modes":this.set({mode:e.id});break;case"shortcuts":this.set({[e.id]:e.value})}}};g.syncData().then((()=>{g.syncElementsWithStorage(),g.registerChangeEvent(),g.handleShortcutElementsInteractivity()}))}()}();